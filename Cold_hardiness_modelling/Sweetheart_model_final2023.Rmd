---
title: "Modelling Cold Hardiness in 'Sweetheart' Sweet Cherries 2022"
author: "Elizabeth Houghton"
output:
  html_document:
    
    toc: true
    toc_float: true
    theme: cerulean
    highlight: kate
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(echo = TRUE)
```

This page was last updated on `r format(Sys.time(), '%B %d, %Y')`.

* * *
# 1.0 Initial set up and calculations

```{r, results="hide", message=FALSE, warning = FALSE}
# import required packages
library(plyr)
library(zoo)
library(lubridate)
library(tidyverse)
library(MuMIn)
library(nlme)
library(report)
library(nlstools)
library(Metrics)
library(geosphere)
library(chillR)
library(ChillModels)
library(ggplot2)
library(DT)
library(hydroGOF)
```

```{R}
cite_packages()
```

* * *
## 1.1 Example code for chill unit calculations

```{R, eval=F}
# # Chill units (CU) were calculated using hourly air temperatures and the temperature effectiveness curve for chilling from Neilsen et al. 2015 as shown in the following function. 
# 
# Temp.df <- Temp.df %>% mutate(cherry_model_raw = case_when(Temp < -2 ~ 0, 
#                                Temp >= 18 ~ -1, 
#                                Temp >= 16 & Temp < 18 ~ -0.5,
#                                Temp < 16 & Temp >= -2 ~
#                                  1-((46.8012*exp(-exp(-(Temp-9.8275)/2.1401)))/42.80757)))
# 
# # Make a new column (Sweetheart_cherry_model) that is the accumulation of all the calculated chill units
# #   
# Temp.df <- data.frame(Temp.df, accumulated_cherry_model=cumsum(Temp.df$cherry_model_raw))
# 
# # Chill inception was found by determining when the accumulated chill units are reach a minimum, and at this time chill accumulation is set to zero, start accumulating chill the day after the minimum value is reached
#       # Anything after the minimum Sweetheart_cherry_model value (accumulated chill units), assign the accumulated chill units (Sweetheart_cherry_model),   everything before assign 0
#       # If the length of the data frame when selecting for values after the minimum Sweetheart_cherry_model value is greater than 0, assign      Sweetheart_cherry_model_final to be the cumulative sum of CU, if it is shorter than 1, assign Sweetheart_cherry_model_final a value of zero
# 
# if (nrow(Temp.df[(which.min(Temp.df$cherry_model) + 1 ):nrow(Temp.df), ]) > 1){ # + 1 must be removed in the Shiny app to account for data that                                                                                       is imported for the day of
#     Temp.df_2 <- Temp.df[(which.min(Temp.df$cherry_model) + 1 ):nrow(Temp.df), ]
#     Temp.df_2 <-  data.frame(Temp.df_2, cherry_model_final=cumsum(Temp.df_2$cherry_model_raw))
#     Temp.df <- merge(Temp.df, Temp.df_2, by = c("Date", "Year", "Month", "Day", "Time","Temp", "cherry_model_raw", "cherry_model", "Site"), all = TRUE) # these columns need to be exactly the columns in your data fame in order to run properly (no extras, no less)
#   } else {
#   Temp.df <- Temp.df %>% dplyr::mutate(cherry_model_final = 0)
#   }
# 
# # Neilsen et al. 2015 determined that approximately 1119 accumulated chilling units are optimal for Sweetheart
# 
# # Add column for sweetheart chill accumulation completion
# 
# # if chill units have not yet started accumulating, assign value of zero
# Temp.df$cherry_model_final[is.na(Temp.df$cherry_model_final)] <- 0
# 
# # create new column to indicate optimal forcing units, column Sweetheart_cherry_model (FU < 1119, assign 0, FU >= 1119, assign 1)
# Temp.df <- Temp.df %>% dplyr::mutate(Sweetheart_cherry_model = case_when(cherry_model_final < 1119 ~ 0, cherry_model_final >= 1119 ~ 1))
# 
# # We will assign any accumulated forcing unit over 1119 the value of 1119 as optimal chill has been accumulated by this point and forcing accumulation begins
# Temp.df$cherry_model_final[Temp.df$cherry_model_final >= 1119] <- 1119
```

* * *
## 1.2 Example code for forcing unit calculations

```{R, eval=F}
# 'Forcing units' were calculated using hourly air temperatures and the temperature effectiveness curve for forcing from Neilsen et al. 2015 with the bud break coefficients
# 
# Temp.df <- Temp.df %>% dplyr::mutate(Sweetheart_cherry_forcingBB = case_when(Temp < 5 ~ 0, 
#                                                                   Temp >= 5 ~ 1.5/(1+exp(-(Temp-22.8)/5.7))))
#
# FU at temperatures below 5 C were assigned zero otherwise this equation would accumulated some degree of FU even at very negative temperatures (which conceptually doesnt make sense). 5 C was chosen due to greenhouse temperatures usein in Neilsen et al. 2015 to develop the FU equation.
#
# # If Sweetheart_cherry_model = 0 (FU < 1119) assign all Sweetheart_cherry_forcingBB to zero
# Temp.df$Sweetheart_cherry_forcingBB[Temp.df$Sweetheart_cherry_model == '0'] <- 0
# 
# # determine the accumulated values for the forcing units
# Temp.df <-  data.frame(Temp.df, Sweetheart_cherry_forcingBB_final=cumsum(Temp.df$Sweetheart_cherry_forcingBB))
# 
# # We will also be working with log transform chilling units
# Temp.df$Sweetheart_cherry_forcingBB_final_log <- log(Temp.df$Sweetheart_cherry_forcingBB_final + 10)
# 
# # Neilsen et al. 2015 determined that once approximately 68 forcing units (calculated using bud break coefficients) were accumulated, bud break will occur
# 
# # create column for forcing units not yet accumulating (CU < 1119, assign 0), forcing units accumulating (CU >=1119, assign 1), and forcing units complete (FU >=68, assign 2)
# 
# Temp.df <- Temp.df %>% dplyr::mutate(Sweetheart_cherry_model_forcingBB = case_when(cherry_model_final < 1119 ~ 0, cherry_model_final >= 1119 ~ 1, Sweetheart_cherry_forcingBB_final >= 68 ~ 2))
```

* * *
## 1.3 Example code for temperature and temperature lag calculations

```{R, eval=F}
# # calculate max, min, and mean temperature from Temp.df that has hourly_temp, Year, Month, and Day columns
# 
# Temp_max <- aggregate(hourly_temp ~ Year + Month + Day, Temp.df, max)
# Temp_min <- aggregate(hourly_temp ~ Year + Month + Day, Temp.df, min)
# Temp_mean <- aggregate(hourly_temp ~ Year + Month + Day, Temp.df, mean)
# 
# # add column for temperature lags for 1, 2, and 3 days prior
# 
# Temp_max.lag1.df <- data.frame(Temp.df, Temp_max.lag1 = dplyr::lag(Temp.df$Temp_max))
# Temp_max.lag2.df <- data.frame(Temp.df, Temp_max.lag2 = dplyr::lag(Temp.df$Temp_max,2))
# Temp_max.lag3.df <- data.frame(Temp.df, Temp_max.lag3 = dplyr::lag(Temp.df$Temp_max,3))
# 
# Temp_min.lag1.df <- data.frame(Temp.df, Temp_min.lag1 = dplyr::lag(Temp.df$Temp_min))
# Temp_min.lag2.df <- data.frame(Temp.df, Temp_min.lag2 = dplyr::lag(Temp.df$Temp_min,2))
# Temp_min.lag3.df <- data.frame(Temp.df, Temp_min.lag3 = dplyr::lag(Temp.df$Temp_min,3))
# 
# Temp_mean.lag1.df <- data.frame(Temp.df, Temp_mean.lag1 = dplyr::lag(Temp.df$Temp_mean))
# Temp_mean.lag2.df <- data.frame(Temp.df, Temp_mean.lag2 = dplyr::lag(Temp.df$Temp_mean,2))
# Temp_mean.lag3.df <- data.frame(Temp.df, Temp_mean.lag3 = dplyr::lag(Temp.df$Temp_mean,3))
```

* * *
## 1.4 Example code for photoperiod calculations

```{R, eval=F}
# # Example latitude = 49.6
# # Jday is the Julian day
# Photoperiod.df <- as.data.frame(daylength(49.6, Temp.df$Jday))
# Temp.df$Photoperiod <- Photoperiod.df$Daylength
```

* * *
# 2.0 Import required data

```{R}
# This dataframe includes six seasons of 'Sweetheart' sweet cherry lethal temperature data (LT10, LT50, LT90) collected in Summerland, BC Canada from 2014-15, 2015-16, 2016-17, 2017-18, 2019-20, 2020-21
# This dataframe also includes the calculates chill unit accumulation, forcing unit calculation, daily temperatures and lag temperatures, as well as Photoperiod as demonstrated above yearly form Sept 15 to April 30.
# dates with sample sizes less than n=10 were omitted

SweetheartNEW <- read.csv(file='Summerland_Sweetheart_final_CUFU_LT_2023.csv')
SweetheartNEW$Date <- as.Date(SweetheartNEW$Date)

# drop LT_n and LT_stdev so it doesn't cause na.omit issues later on
SweetheartNEW = subset(SweetheartNEW, select = -c(LT_n, LT_stdev, Temp))

SweetheartNEW <- SweetheartNEW %>% mutate_if(is.numeric, ~round(., 2))

# remove dates with 6, 7, 8 stages because we dont have enough data for this (only a few points in full bloom or bloom and these data were very off so will remove)
# Dates:2015-04-13, 2015-04-23, 2016-04-07, 2016-04-11
SweetheartNEW <- SweetheartNEW %>% mutate(LT10 = ifelse(Date == "2015-04-13", NA, SweetheartNEW$LT10))
SweetheartNEW <- SweetheartNEW %>% mutate(LT50 = ifelse(Date == "2015-04-13", NA, SweetheartNEW$LT50))
SweetheartNEW <- SweetheartNEW %>% mutate(LT90 = ifelse(Date == "2015-04-13", NA, SweetheartNEW$LT90))
# 
SweetheartNEW <- SweetheartNEW %>% mutate(LT10 = ifelse(Date == "2015-04-23", NA, SweetheartNEW$LT10))
SweetheartNEW <- SweetheartNEW %>% mutate(LT50 = ifelse(Date == "2015-04-23", NA, SweetheartNEW$LT50))
SweetheartNEW <- SweetheartNEW %>% mutate(LT90 = ifelse(Date == "2015-04-23", NA, SweetheartNEW$LT90))
# 
SweetheartNEW <- SweetheartNEW %>% mutate(LT10 = ifelse(Date == "2016-04-07", NA, SweetheartNEW$LT10))
SweetheartNEW <- SweetheartNEW %>% mutate(LT50 = ifelse(Date == "2016-04-07", NA, SweetheartNEW$LT50))
SweetheartNEW <- SweetheartNEW %>% mutate(LT90 = ifelse(Date == "2016-04-07", NA, SweetheartNEW$LT90))
# 
SweetheartNEW <- SweetheartNEW %>% mutate(LT10 = ifelse(Date == "2016-04-11", NA, SweetheartNEW$LT10))
SweetheartNEW <- SweetheartNEW %>% mutate(LT50 = ifelse(Date == "2016-04-11", NA, SweetheartNEW$LT50))
SweetheartNEW <- SweetheartNEW %>% mutate(LT90 = ifelse(Date == "2016-04-11", NA, SweetheartNEW$LT90))

SweetheartNEW$Site <- "AAFC"

#needed to add the 2 extra seasons of Martens data that will be included in model development
Martens <- read.csv(file='Martens_final_CUFU_LT_2023.csv')
Martens$Date <- as.Date(Martens$Date)

# drop LT_n and LT_stdev so it doesn't cause na.omit issues later on
Martens$Date <- as.Date(Martens$Date)

Martens <- Martens %>% mutate_if(is.numeric, ~round(., 2))

Martens1 <- subset(Martens, Date >= '2019-08-01' & Date <= '2019-12-31')
Martens1$Jday <- (215:365)
Martens2 <- subset(Martens, Date >= '2020-01-01' & Date <= '2020-04-30')
Martens2$Jday <- (1:121)
Martens3 <- subset(Martens, Date >= '2021-08-01' & Date <= '2021-12-31')
Martens3$Jday <- (213:365)
Martens4 <- subset(Martens, Date >= '2022-01-01' & Date <= '2022-04-30')
Martens4$Jday <- (1:120)

Martens <- rbind(Martens1, Martens2, Martens3, Martens4)
Photoperiod.df <- as.data.frame(daylength(49.6, Martens$Jday))
Martens$Photoperiod <- Photoperiod.df$Daylength

SweetheartNEW <- rbind(SweetheartNEW, Martens)
SweetheartNEW  <- SweetheartNEW  %>% mutate_if(is.numeric, ~round(., 2))
```

## Seperate dataframe by forcing unit accumulation

Looking at the forcing units accumulated (>0) after chill is complete (CU >= 1119), a significant loss in hardiness is observed after approximately 30 forcing units have been accumulated.

```{r, echo=FALSE, out.width="30%"}
# Based on your observations you are going to split the models after approximately 30 accumulated FU (this is when you're starting to see significant looses in hardiness)
forcing_test <- subset(SweetheartNEW, Sweetheart_cherry_forcingBB_final > 0 & cherry_model_final >= 1119)

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT10,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT10 (˚C)",
     xlim=c(0,150),
     ylim=c(-20, 0),
     cex.main=1.5, 
     cex.lab=1)
axis(1, at = seq(0, 150, 10), labels = NA, lwd.ticks = 0.5)
abline(v=30, col="red", lty=2)


plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT50,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT50 (˚C)",
     xlim=c(0,150),
     ylim=c(-20, 0),
     cex.main=1.5, 
     cex.lab=1)
axis(1, at = seq(0, 150, 10), labels = NA, lwd.ticks = 0.5)
abline(v=30, col="red", lty=2)

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT90,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT90 (˚C)",
     xlim=c(0,150),     
     ylim=c(-20, 0),
     cex.main=1.5, 
     cex.lab=1)
axis(1, at = seq(0, 150, 10), labels = NA, lwd.ticks = 0.5)
abline(v=30, col="red", lty=2)

```

Looking at the forcing units accumulated (>0) after chill is complete, deacclimation appears to occur between approximately 2000 and 2500 chilling units have accumulated. Therefore, forcing units accumulated before 2000 chill units are accumulated will be considered insignificant and set to a value of zero. significant loss in hardiness is observed after approximately 30 forcing units have been accumulated.

```{r, echo=FALSE, out.width="30%"}
plot(forcing_test$cherry_model_accumulated,forcing_test$LT10,
     main="",
     pch=20,
     ylab="LT10 (˚C)", 
     xlab="Chilling accumulation",
     # xlim=c(1119,2000),
     # ylim=c(0,30),
     cex.main=1.5, 
     cex.lab=1)
abline(v=2000, col="red", lty=2)
abline(v=2500, col="red", lty=2)

plot(forcing_test$cherry_model_accumulated,forcing_test$LT50,
     main="",
     pch=20,
     ylab="LT50 (˚C)", 
     xlab="Chilling accumulation",
     # xlim=c(1119,2000),
     # ylim=c(0,30),
     cex.main=1.5, 
     cex.lab=1)
abline(v=2000, col="red", lty=2)
abline(v=2500, col="red", lty=2)

plot(forcing_test$cherry_model_accumulated,forcing_test$LT90,
     main="",
     pch=20,
     ylab="LT90 (˚C)", 
     xlab="Chilling accumulation",
     # xlim=c(1119,2000),
     # ylim=c(0,30),
     cex.main=1.5, 
     cex.lab=1)
abline(v=2000, col="red", lty=2)
abline(v=2500, col="red", lty=2)

# plot(forcing_test$Sweetheart_cherry_forcingBB_final,forcing_test$cherry_model_accumulated,
#      main="",
#      pch=20,
#      xlab="cherry_model_accumulated", 
#      ylab="Sweetheart_cherry_forcingBB_final",
#      # xlim=c(1119,2000),
#      # ylim=c(0,30),
#      cex.main=1.5, 
#      cex.lab=1)
# abline(h=2000, col="red", lty=2)
# abline(h=2500, col="red", lty=2)
# abline(v=30, col="red", lty=2)
```

Compare chilling and focing accumulation
Looking for patterns of when we are still seeing rapid chill accumulation and minimal forcing accumulation (FU=10 is approximately when we see less rapid forcing accumulation)
```{r, echo=FALSE, out.width="30%"}
plot(SweetheartNEW$cherry_model_accumulated, SweetheartNEW$Sweetheart_cherry_forcingBB_final,
     main="",
     pch=20,
     ylab="Forcing accumulation", 
     xlab="Chilling accumulation",
     # xlim=c(0,4000),
     # ylim=c(0,60),
     cex.main=1.5, 
     cex.lab=1)
abline(v=2000, col="red", lty=2)
abline(v=2500, col="red", lty=2)
abline(h=10, col="red", lty=2)
abline(h=15, col="red", lty=2)


plot(SweetheartNEW$cherry_model_accumulated, SweetheartNEW$Sweetheart_cherry_forcingBB_final,
     main="",
     pch=20,
     ylab="Forcing accumulation", 
     xlab="Chilling accumulation",
     xlim=c(1000,3000),
     ylim=c(0,60),
     cex.main=1.5, 
     cex.lab=1)
abline(v=2000, col="red", lty=2)
abline(v=2500, col="red", lty=2)
abline(h=10, col="red", lty=2)
abline(h=15, col="red", lty=2)


```
```{r, echo = FALSE}
# assign forcing a value of zero below below FU=10 to nullify early affects of warm snaps

SweetheartNEW$Sweetheart_cherry_forcingBB_final.05 <- 0

SweetheartNEW$Sweetheart_cherry_forcingBB_final <- ifelse(SweetheartNEW$cherry_model_accumulated <= 2000, # if CU less than or equal to 2000
                                                          SweetheartNEW$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to 0
                                                          SweetheartNEW$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values


# calculate log values again based off this

SweetheartNEW$Sweetheart_cherry_forcingBB_final_log <- log(SweetheartNEW$Sweetheart_cherry_forcingBB_final + 10)


# add rows for lag 4, 5, 6, and 7 for mean daily air temperatures to calculate autocorrelation

SweetheartNEW <- data.frame(SweetheartNEW, Temp_mean.lag4 = dplyr::lag(SweetheartNEW$Temp_mean,4))
SweetheartNEW <- data.frame(SweetheartNEW, Temp_mean.lag5 = dplyr::lag(SweetheartNEW$Temp_mean,5))
SweetheartNEW <- data.frame(SweetheartNEW, Temp_mean.lag6 = dplyr::lag(SweetheartNEW$Temp_mean,6))
SweetheartNEW <- data.frame(SweetheartNEW, Temp_mean.lag7 = dplyr::lag(SweetheartNEW$Temp_mean,7))

#omit NA values
SweetheartNEWNA <- na.omit(SweetheartNEW)


# split dataframe based on this
SweetheartNEW1 <- subset(SweetheartNEW, Sweetheart_cherry_forcingBB_final < 30)
SweetheartNEWNA1 <- subset(SweetheartNEWNA, Sweetheart_cherry_forcingBB_final < 30)

SweetheartNEW2 <- subset(SweetheartNEW, Sweetheart_cherry_forcingBB_final >= 30)
SweetheartNEWNA2 <- subset(SweetheartNEWNA, Sweetheart_cherry_forcingBB_final >= 30)

```

```{r, echo=FALSE, results='hide', fig.show = 'hide'}
# add approximate bud stages to SweetheartNEWNA2 coded as numeric:

# 1 = side green
# 2 = green tip
# 3 = tight cluster
# 4 = open cluster
# 5 = first white
# 6 = first bloom
# 7 = full bloom
# 8 = petal fall

# "2015-03-16" 1
# "2015-03-19" 2
# "2015-03-26" 3
# "2015-03-31" 4
# "2015-04-09" 5
#### "2015-04-13" 7
#### "2015-04-23" 8
# 2016-03-08 1
# "2016-03-21" 2
# "2016-04-04" 5
#### "2016-04-07" 6
#### "2016-04-11" 7
# "2017-04-03" 1
# "2017-04-06" 2
# "2017-04-12" 3
# "2017-04-20" 4
# "2017-04-25" 5
# "2022-03-24" 1 #Martens season

# remove dates with 6, 7, 8 stages because we dont have enough data for this
# Dates:2015-04-13, 2015-04-23, 2016-04-07, 2016-04-11

SweetheartNEWNA2$Date
stages <- c(1,2,3,4,5, 1,2,5, 1,2,3,4,5, 1)
stages <- as.data.frame(stages)

SweetheartNEWNA2 <- cbind(SweetheartNEWNA2, stages)

sum_lm <- summary(lm(LT50~stages, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$stages,
     SweetheartNEWNA2$LT50,
     xlab="stages",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$stages) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)
```

* * *
# 3.0 Temperature lag correlations: FU < 30

```{R, fig.show='hide', echo=FALSE}
# LT10 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_max, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max,
     SweetheartNEWNA1$LT10,
     xlab="Temp_max",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared <- sum_lm$r.squared
LT10_r.squared <- as.data.frame(LT10_r.squared)
LT10_r.squared$Temp <- 'Temp_max'
LT10_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_max.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag1,
     SweetheartNEWNA1$LT10,
     xlab="Temp_max.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared1 <- LT10_r.squared1 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared1$Temp <- 'Temp_max.lag1'
LT10_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT10~Temp_max.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag2,
     SweetheartNEWNA1$LT10,
     xlab="Temp_max.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared2 <- LT10_r.squared2 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared2$Temp <- 'Temp_max.lag2'
LT10_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_max.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag3,
     SweetheartNEWNA1$LT10,
     xlab="Temp_max.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared3 <- LT10_r.squared3 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared3$Temp <- 'Temp_max.lag3'
LT10_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_min, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min,
     SweetheartNEWNA1$LT10,
     xlab="Temp_min",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared4 <- LT10_r.squared4 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared4$Temp <- 'Temp_min'
LT10_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_min.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag1,
     SweetheartNEWNA1$LT10,
     xlab="Temp_min.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared5 <- LT10_r.squared5 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared5$Temp <- 'Temp_min.lag1'
LT10_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_min.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag2,
     SweetheartNEWNA1$LT10,
     xlab="Temp_min.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared6 <- LT10_r.squared6 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared6$Temp <- 'Temp_min.lag2'
LT10_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_min.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag3,
     SweetheartNEWNA1$LT10,
     xlab="Temp_min.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared7 <- LT10_r.squared7 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared7$Temp <- 'Temp_min.lag3'
LT10_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_mean, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared8 <- LT10_r.squared8 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared8$Temp <- 'Temp_mean'
LT10_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_mean.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag1,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared9 <- LT10_r.squared9 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared9$Temp <- 'Temp_mean.lag1'
LT10_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_mean.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag2,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared10 <- LT10_r.squared10 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared10$Temp <- 'Temp_mean.lag2'
LT10_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_mean.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag3,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared11 <- LT10_r.squared11 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared11$Temp <- 'Temp_mean.lag3'
LT10_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT10~Temp_mean.lag4, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag4,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag4",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag4) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared12 <- LT10_r.squared12 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared12$Temp <- 'Temp_mean.lag4'
LT10_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT10~Temp_mean.lag5, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag5,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag5",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag5) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared13 <- LT10_r.squared13 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared13$Temp <- 'Temp_mean.lag5'
LT10_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT10~Temp_mean.lag6, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag6,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag6",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag6) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared14 <- LT10_r.squared14 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared14$Temp <- 'Temp_mean.lag6'
LT10_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT10~Temp_mean.lag7, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag7,
     SweetheartNEWNA1$LT10,
     xlab="Temp_mean.lag7",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag7) - 7, 
     y = min(SweetheartNEWNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared15 <- LT10_r.squared15 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared15$Temp <- 'Temp_mean.lag7'
LT10_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT10_r.squared <- rbind(LT10_r.squared, LT10_r.squared1, LT10_r.squared2, LT10_r.squared3, LT10_r.squared4, LT10_r.squared5, LT10_r.squared6,
                        LT10_r.squared7, LT10_r.squared8, LT10_r.squared9, LT10_r.squared10, LT10_r.squared11, LT10_r.squared12, LT10_r.squared13, LT10_r.squared14, LT10_r.squared15)
LT10_r.squared$LT10_r.squared <- as.numeric(LT10_r.squared$LT10_r.squared)
LT10_r.squared$p <- as.character(LT10_r.squared$p)
LT10_r.squared <- LT10_r.squared %>% mutate_if(is.numeric, ~round(., 2))
LT10_r.squared
```

```{R, fig.show='hide', echo=FALSE}
#LT50

# LT50 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_max, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max,
     SweetheartNEWNA1$LT50,
     xlab="Temp_max",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared <- sum_lm$r.squared
LT50_r.squared <- as.data.frame(LT50_r.squared)
LT50_r.squared$Temp <- 'Temp_max'
LT50_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_max.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag1,
     SweetheartNEWNA1$LT50,
     xlab="Temp_max.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared1 <- LT50_r.squared1 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared1$Temp <- 'Temp_max.lag1'
LT50_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT50~Temp_max.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag2,
     SweetheartNEWNA1$LT50,
     xlab="Temp_max.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared2 <- LT50_r.squared2 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared2$Temp <- 'Temp_max.lag2'
LT50_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_max.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag3,
     SweetheartNEWNA1$LT50,
     xlab="Temp_max.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared3 <- LT50_r.squared3 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared3$Temp <- 'Temp_max.lag3'
LT50_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_min, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min,
     SweetheartNEWNA1$LT50,
     xlab="Temp_min",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared4 <- LT50_r.squared4 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared4$Temp <- 'Temp_min'
LT50_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_min.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag1,
     SweetheartNEWNA1$LT50,
     xlab="Temp_min.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared5 <- LT50_r.squared5 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared5$Temp <- 'Temp_min.lag1'
LT50_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_min.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag2,
     SweetheartNEWNA1$LT50,
     xlab="Temp_min.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared6 <- LT50_r.squared6 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared6$Temp <- 'Temp_min.lag2'
LT50_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_min.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag3,
     SweetheartNEWNA1$LT50,
     xlab="Temp_min.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared7 <- LT50_r.squared7 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared7$Temp <- 'Temp_min.lag3'
LT50_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_mean, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared8 <- LT50_r.squared8 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared8$Temp <- 'Temp_mean'
LT50_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_mean.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag1,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared9 <- LT50_r.squared9 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared9$Temp <- 'Temp_mean.lag1'
LT50_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_mean.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag2,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared10 <- LT50_r.squared10 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared10$Temp <- 'Temp_mean.lag2'
LT50_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_mean.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag3,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared11 <- LT50_r.squared11 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared11$Temp <- 'Temp_mean.lag3'
LT50_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT50~Temp_mean.lag4, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag4,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag4",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag4) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared12 <- LT50_r.squared12 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared12$Temp <- 'Temp_mean.lag4'
LT50_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT50~Temp_mean.lag5, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag5,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag5",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag5) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared13 <- LT50_r.squared13 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared13$Temp <- 'Temp_mean.lag5'
LT50_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT50~Temp_mean.lag6, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag6,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag6",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag6) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared14 <- LT50_r.squared14 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared14$Temp <- 'Temp_mean.lag6'
LT50_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT50~Temp_mean.lag7, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag7,
     SweetheartNEWNA1$LT50,
     xlab="Temp_mean.lag7",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag7) - 7, 
     y = min(SweetheartNEWNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared15 <- LT50_r.squared15 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared15$Temp <- 'Temp_mean.lag7'
LT50_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT50_r.squared <- rbind(LT50_r.squared, LT50_r.squared1, LT50_r.squared2, LT50_r.squared3, LT50_r.squared4, LT50_r.squared5, LT50_r.squared6,
                        LT50_r.squared7, LT50_r.squared8, LT50_r.squared9, LT50_r.squared10, LT50_r.squared11, LT50_r.squared12, LT50_r.squared13, LT50_r.squared14, LT50_r.squared15)
LT50_r.squared$LT50_r.squared <- as.numeric(LT50_r.squared$LT50_r.squared)
LT50_r.squared$p <- as.character(LT50_r.squared$p)
LT50_r.squared <- LT50_r.squared %>% mutate_if(is.numeric, ~round(., 2))

LT50_r.squared
```

```{R, fig.show='hide', echo=FALSE}
#LT90

# LT90 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_max, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max,
     SweetheartNEWNA1$LT90,
     xlab="Temp_max",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared <- sum_lm$r.squared
LT90_r.squared <- as.data.frame(LT90_r.squared)
LT90_r.squared$Temp <- 'Temp_max'
LT90_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_max.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag1,
     SweetheartNEWNA1$LT90,
     xlab="Temp_max.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared1 <- LT90_r.squared1 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared1$Temp <- 'Temp_max.lag1'
LT90_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT90~Temp_max.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag2,
     SweetheartNEWNA1$LT90,
     xlab="Temp_max.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared2 <- LT90_r.squared2 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared2$Temp <- 'Temp_max.lag2'
LT90_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_max.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_max.lag3,
     SweetheartNEWNA1$LT90,
     xlab="Temp_max.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_max.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared3 <- LT90_r.squared3 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared3$Temp <- 'Temp_max.lag3'
LT90_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_min, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min,
     SweetheartNEWNA1$LT90,
     xlab="Temp_min",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared4 <- LT90_r.squared4 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared4$Temp <- 'Temp_min'
LT90_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_min.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag1,
     SweetheartNEWNA1$LT90,
     xlab="Temp_min.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared5 <- LT90_r.squared5 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared5$Temp <- 'Temp_min.lag1'
LT90_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_min.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag2,
     SweetheartNEWNA1$LT90,
     xlab="Temp_min.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared6 <- LT90_r.squared6 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared6$Temp <- 'Temp_min.lag2'
LT90_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_min.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_min.lag3,
     SweetheartNEWNA1$LT90,
     xlab="Temp_min.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_min.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared7 <- LT90_r.squared7 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared7$Temp <- 'Temp_min.lag3'
LT90_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_mean, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared8 <- LT90_r.squared8 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared8$Temp <- 'Temp_mean'
LT90_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_mean.lag1, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag1,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag1) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared9 <- LT90_r.squared9 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared9$Temp <- 'Temp_mean.lag1'
LT90_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_mean.lag2, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag2,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag2) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared10 <- LT90_r.squared10 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared10$Temp <- 'Temp_mean.lag2'
LT90_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_mean.lag3, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag3,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag3) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared11 <- LT90_r.squared11 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared11$Temp <- 'Temp_mean.lag3'
LT90_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT90~Temp_mean.lag4, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag4,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag4",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag4) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared12 <- LT90_r.squared12 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared12$Temp <- 'Temp_mean.lag4'
LT90_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT90~Temp_mean.lag5, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag5,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag5",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag5) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared13 <- LT90_r.squared13 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared13$Temp <- 'Temp_mean.lag5'
LT90_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT90~Temp_mean.lag6, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag6,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag6",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag6) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared14 <- LT90_r.squared14 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared14$Temp <- 'Temp_mean.lag6'
LT90_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT90~Temp_mean.lag7, data = SweetheartNEWNA1))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA1$Temp_mean.lag7,
     SweetheartNEWNA1$LT90,
     xlab="Temp_mean.lag7",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA1$Temp_mean.lag7) - 7, 
     y = min(SweetheartNEWNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared15 <- LT90_r.squared15 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared15$Temp <- 'Temp_mean.lag7'
LT90_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT90_r.squared <- rbind(LT90_r.squared, LT90_r.squared1, LT90_r.squared2, LT90_r.squared3, LT90_r.squared4, LT90_r.squared5, LT90_r.squared6,
                        LT90_r.squared7, LT90_r.squared8, LT90_r.squared9, LT90_r.squared10, LT90_r.squared11, LT90_r.squared12, LT90_r.squared13, LT90_r.squared14, LT90_r.squared15)
LT90_r.squared$LT90_r.squared <- as.numeric(LT90_r.squared$LT90_r.squared)
LT90_r.squared$p <- as.character(LT90_r.squared$p)
LT90_r.squared <- LT90_r.squared %>% mutate_if(is.numeric, ~round(., 2))
LT90_r.squared

```

```{R, echo=FALSE}

LT10_r.squared<- LT10_r.squared %>% 
  dplyr::rename(LT10_p = "p")
LT50_r.squared<- LT50_r.squared %>% 
  dplyr::rename(LT50_p = "p")
LT90_r.squared<- LT90_r.squared %>% 
  dplyr::rename(LT90_p = "p")

Temp_r.squared <- merge(LT10_r.squared, LT50_r.squared, by= c("Temp"), all = TRUE)
Temp_r.squared <- merge(Temp_r.squared, LT90_r.squared, by= c("Temp"), all = TRUE)

Temp_r.squared

write.csv(Temp_r.squared, file = "./outputs/Temp.Lag.T1.Sweetheart_r.squared.csv", row.names = FALSE)
```

* * *
# 4.0 Temperature lag correlations: FU  >= 30
```{R, fig.show='hide', echo=FALSE}
#LT10

# LT10 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_max, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max,
     SweetheartNEWNA2$LT10,
     xlab="Temp_max",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared <- sum_lm$r.squared
LT10_r.squared <- as.data.frame(LT10_r.squared)
LT10_r.squared$Temp <- 'Temp_max'
LT10_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_max.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag1,
     SweetheartNEWNA2$LT10,
     xlab="Temp_max.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared1 <- LT10_r.squared1 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared1$Temp <- 'Temp_max.lag1'
LT10_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT10~Temp_max.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag2,
     SweetheartNEWNA2$LT10,
     xlab="Temp_max.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared2 <- LT10_r.squared2 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared2$Temp <- 'Temp_max.lag2'
LT10_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_max.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag3,
     SweetheartNEWNA2$LT10,
     xlab="Temp_max.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared3 <- LT10_r.squared3 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared3$Temp <- 'Temp_max.lag3'
LT10_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_min, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min,
     SweetheartNEWNA2$LT10,
     xlab="Temp_min",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared4 <- LT10_r.squared4 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared4$Temp <- 'Temp_min'
LT10_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_min.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag1,
     SweetheartNEWNA2$LT10,
     xlab="Temp_min.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared5 <- LT10_r.squared5 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared5$Temp <- 'Temp_min.lag1'
LT10_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_min.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag2,
     SweetheartNEWNA2$LT10,
     xlab="Temp_min.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared6 <- LT10_r.squared6 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared6$Temp <- 'Temp_min.lag2'
LT10_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_min.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag3,
     SweetheartNEWNA2$LT10,
     xlab="Temp_min.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared7 <- LT10_r.squared7 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared7$Temp <- 'Temp_min.lag3'
LT10_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_mean, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared8 <- LT10_r.squared8 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared8$Temp <- 'Temp_mean'
LT10_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_mean.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag1,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared9 <- LT10_r.squared9 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared9$Temp <- 'Temp_mean.lag1'
LT10_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_mean.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag2,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared10 <- LT10_r.squared10 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared10$Temp <- 'Temp_mean.lag2'
LT10_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_mean.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag3,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared11 <- LT10_r.squared11 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared11$Temp <- 'Temp_mean.lag3'
LT10_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT10~Temp_mean.lag4, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag4,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag4",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag4) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared12 <- LT10_r.squared12 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared12$Temp <- 'Temp_mean.lag4'
LT10_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT10~Temp_mean.lag5, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag5,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag5",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag5) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared13 <- LT10_r.squared13 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared13$Temp <- 'Temp_mean.lag5'
LT10_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT10~Temp_mean.lag6, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag6,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag6",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag6) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared14 <- LT10_r.squared14 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared14$Temp <- 'Temp_mean.lag6'
LT10_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT10~Temp_mean.lag7, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag7,
     SweetheartNEWNA2$LT10,
     xlab="Temp_mean.lag7",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag7) - 7, 
     y = min(SweetheartNEWNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared15 <- LT10_r.squared15 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared15$Temp <- 'Temp_mean.lag7'
LT10_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT10_r.squared <- rbind(LT10_r.squared, LT10_r.squared1, LT10_r.squared2, LT10_r.squared3, LT10_r.squared4, LT10_r.squared5, LT10_r.squared6,
                        LT10_r.squared7, LT10_r.squared8, LT10_r.squared9, LT10_r.squared10, LT10_r.squared11, LT10_r.squared12, LT10_r.squared13, LT10_r.squared14, LT10_r.squared15)
LT10_r.squared$LT10_r.squared <- as.numeric(LT10_r.squared$LT10_r.squared)
LT10_r.squared$p <- as.character(LT10_r.squared$p)
LT10_r.squared <- LT10_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

```{R, fig.show='hide', echo=FALSE}
#LT50

# LT50 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_max, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max,
     SweetheartNEWNA2$LT50,
     xlab="Temp_max",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared <- sum_lm$r.squared
LT50_r.squared <- as.data.frame(LT50_r.squared)
LT50_r.squared$Temp <- 'Temp_max'
LT50_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_max.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag1,
     SweetheartNEWNA2$LT50,
     xlab="Temp_max.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared1 <- LT50_r.squared1 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared1$Temp <- 'Temp_max.lag1'
LT50_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT50~Temp_max.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag2,
     SweetheartNEWNA2$LT50,
     xlab="Temp_max.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared2 <- LT50_r.squared2 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared2$Temp <- 'Temp_max.lag2'
LT50_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_max.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag3,
     SweetheartNEWNA2$LT50,
     xlab="Temp_max.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared3 <- LT50_r.squared3 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared3$Temp <- 'Temp_max.lag3'
LT50_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_min, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min,
     SweetheartNEWNA2$LT50,
     xlab="Temp_min",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared4 <- LT50_r.squared4 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared4$Temp <- 'Temp_min'
LT50_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_min.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag1,
     SweetheartNEWNA2$LT50,
     xlab="Temp_min.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared5 <- LT50_r.squared5 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared5$Temp <- 'Temp_min.lag1'
LT50_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_min.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag2,
     SweetheartNEWNA2$LT50,
     xlab="Temp_min.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared6 <- LT50_r.squared6 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared6$Temp <- 'Temp_min.lag2'
LT50_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_min.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag3,
     SweetheartNEWNA2$LT50,
     xlab="Temp_min.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared7 <- LT50_r.squared7 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared7$Temp <- 'Temp_min.lag3'
LT50_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_mean, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared8 <- LT50_r.squared8 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared8$Temp <- 'Temp_mean'
LT50_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_mean.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag1,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared9 <- LT50_r.squared9 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared9$Temp <- 'Temp_mean.lag1'
LT50_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_mean.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag2,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared10 <- LT50_r.squared10 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared10$Temp <- 'Temp_mean.lag2'
LT50_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_mean.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag3,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared11 <- LT50_r.squared11 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared11$Temp <- 'Temp_mean.lag3'
LT50_r.squared11$p <- sum_lm$coefficients[1,4] 


# lag 4
sum_lm <- summary(lm(LT50~Temp_mean.lag4, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag4,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag4",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag4) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared12 <- LT50_r.squared12 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared12$Temp <- 'Temp_mean.lag4'
LT50_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT50~Temp_mean.lag5, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag5,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag5",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag5) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared13 <- LT50_r.squared13 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared13$Temp <- 'Temp_mean.lag5'
LT50_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT50~Temp_mean.lag6, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag6,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag6",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag6) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared14 <- LT50_r.squared14 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared14$Temp <- 'Temp_mean.lag6'
LT50_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT50~Temp_mean.lag7, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag7,
     SweetheartNEWNA2$LT50,
     xlab="Temp_mean.lag7",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag7) - 7, 
     y = min(SweetheartNEWNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared15 <- LT50_r.squared15 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared15$Temp <- 'Temp_mean.lag7'
LT50_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT50_r.squared <- rbind(LT50_r.squared, LT50_r.squared1, LT50_r.squared2, LT50_r.squared3, LT50_r.squared4, LT50_r.squared5, LT50_r.squared6,
                        LT50_r.squared7, LT50_r.squared8, LT50_r.squared9, LT50_r.squared10, LT50_r.squared11, LT50_r.squared12, LT50_r.squared13, LT50_r.squared14, LT50_r.squared15)
LT50_r.squared$LT50_r.squared <- as.numeric(LT50_r.squared$LT50_r.squared)
LT50_r.squared$p <- as.character(LT50_r.squared$p)
LT50_r.squared <- LT50_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

```{R, fig.show='hide', echo=FALSE}
#LT90

# LT90 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_max, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max,
     SweetheartNEWNA2$LT90,
     xlab="Temp_max",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared <- sum_lm$r.squared
LT90_r.squared <- as.data.frame(LT90_r.squared)
LT90_r.squared$Temp <- 'Temp_max'
LT90_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_max.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag1,
     SweetheartNEWNA2$LT90,
     xlab="Temp_max.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared1 <- LT90_r.squared1 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared1$Temp <- 'Temp_max.lag1'
LT90_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT90~Temp_max.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag2,
     SweetheartNEWNA2$LT90,
     xlab="Temp_max.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared2 <- LT90_r.squared2 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared2$Temp <- 'Temp_max.lag2'
LT90_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_max.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_max.lag3,
     SweetheartNEWNA2$LT90,
     xlab="Temp_max.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_max.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared3 <- LT90_r.squared3 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared3$Temp <- 'Temp_max.lag3'
LT90_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_min, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min,
     SweetheartNEWNA2$LT90,
     xlab="Temp_min",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared4 <- LT90_r.squared4 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared4$Temp <- 'Temp_min'
LT90_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_min.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag1,
     SweetheartNEWNA2$LT90,
     xlab="Temp_min.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared5 <- LT90_r.squared5 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared5$Temp <- 'Temp_min.lag1'
LT90_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_min.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag2,
     SweetheartNEWNA2$LT90,
     xlab="Temp_min.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared6 <- LT90_r.squared6 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared6$Temp <- 'Temp_min.lag2'
LT90_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_min.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_min.lag3,
     SweetheartNEWNA2$LT90,
     xlab="Temp_min.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_min.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared7 <- LT90_r.squared7 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared7$Temp <- 'Temp_min.lag3'
LT90_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_mean, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared8 <- LT90_r.squared8 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared8$Temp <- 'Temp_mean'
LT90_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_mean.lag1, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag1,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag1) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared9 <- LT90_r.squared9 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared9$Temp <- 'Temp_mean.lag1'
LT90_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_mean.lag2, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag2,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag2) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared10 <- LT90_r.squared10 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared10$Temp <- 'Temp_mean.lag2'
LT90_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_mean.lag3, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag3,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag3) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared11 <- LT90_r.squared11 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared11$Temp <- 'Temp_mean.lag3'
LT90_r.squared11$p <- sum_lm$coefficients[1,4] 


# lag 4
sum_lm <- summary(lm(LT90~Temp_mean.lag4, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag4,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag4",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag4) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared12 <- LT90_r.squared12 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared12$Temp <- 'Temp_mean.lag4'
LT90_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT90~Temp_mean.lag5, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag5,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag5",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag5) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared13 <- LT90_r.squared13 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared13$Temp <- 'Temp_mean.lag5'
LT90_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT90~Temp_mean.lag6, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag6,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag6",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag6) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared14 <- LT90_r.squared14 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared14$Temp <- 'Temp_mean.lag6'
LT90_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT90~Temp_mean.lag7, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Temp_mean.lag7,
     SweetheartNEWNA2$LT90,
     xlab="Temp_mean.lag7",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Temp_mean.lag7) - 7, 
     y = min(SweetheartNEWNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared15 <- LT90_r.squared15 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared15$Temp <- 'Temp_mean.lag7'
LT90_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT90_r.squared <- rbind(LT90_r.squared, LT90_r.squared1, LT90_r.squared2, LT90_r.squared3, LT90_r.squared4, LT90_r.squared5, LT90_r.squared6,
                        LT90_r.squared7, LT90_r.squared8, LT90_r.squared9, LT90_r.squared10, LT90_r.squared11, LT90_r.squared12, LT90_r.squared13, LT90_r.squared14, LT90_r.squared15)
LT90_r.squared$LT90_r.squared <- as.numeric(LT90_r.squared$LT90_r.squared)
LT90_r.squared$p <- as.character(LT90_r.squared$p)
LT90_r.squared <- LT90_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

There is no correlation between LT10, LT50, LT90 or any ambient temperature measurement or lag.

```{R, echo=FALSE}

LT10_r.squared<- LT10_r.squared %>% 
  dplyr::rename(LT10_p = "p")
LT50_r.squared<- LT50_r.squared %>% 
  dplyr::rename(LT50_p = "p")
LT90_r.squared<- LT90_r.squared %>% 
  dplyr::rename(LT90_p = "p")

Temp_r.squared <- merge(LT10_r.squared, LT50_r.squared, by= c("Temp"), all = TRUE)
Temp_r.squared <- merge(Temp_r.squared, LT90_r.squared, by= c("Temp"), all = TRUE)

Temp_r.squared

write.csv(Temp_r.squared, file = "./outputs/Temp.Lag.T2.Sweetheart_r.squared.csv", row.names = FALSE)

# Remove extra columns that we've added mean temp lag 4, 5, 6, and 7:

SweetheartNEW <- subset(SweetheartNEW, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
SweetheartNEW1 <- subset(SweetheartNEW1, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
SweetheartNEW2 <- subset(SweetheartNEW2, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
SweetheartNEWNA1 <- subset(SweetheartNEWNA1, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
SweetheartNEWNA2 <- subset(SweetheartNEWNA2, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
```

```{R, echo=FALSE, fig.show = 'hide'}
sum_lm <- summary(lm(LT10~Sweetheart_cherry_forcingBB_final, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final,
     SweetheartNEWNA2$LT10,
     xlab="Sweetheart_cherry_forcingBB_final",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final) - 15, 
     y = min(SweetheartNEWNA2$LT10) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT50~Sweetheart_cherry_forcingBB_final, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final,
     SweetheartNEWNA2$LT50,
     xlab="Sweetheart_cherry_forcingBB_final",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final) - 15, 
     y = min(SweetheartNEWNA2$LT50) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT90~Sweetheart_cherry_forcingBB_final, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final,
     SweetheartNEWNA2$LT90,
     xlab="Sweetheart_cherry_forcingBB_final",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final) - 15, 
     y = min(SweetheartNEWNA2$LT90) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

# try log transformed
sum_lm <- summary(lm(LT10~Sweetheart_cherry_forcingBB_final_log, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final_log,
     SweetheartNEWNA2$LT10,
     xlab="Sweetheart_cherry_forcingBB_final_log",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final_log) - 1, 
     y = min(SweetheartNEWNA2$LT10) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT50~Sweetheart_cherry_forcingBB_final_log, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final_log,
     SweetheartNEWNA2$LT50,
     xlab="Sweetheart_cherry_forcingBB_final_log",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final_log) - 1, 
     y = min(SweetheartNEWNA2$LT50) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT90~Sweetheart_cherry_forcingBB_final_log, data = SweetheartNEWNA2))
coef_lm<-sum_lm$coefficients
plot(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final_log,
     SweetheartNEWNA2$LT90,
     xlab="Sweetheart_cherry_forcingBB_final_log",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(SweetheartNEWNA2$Sweetheart_cherry_forcingBB_final_log) - 1, 
     y = min(SweetheartNEWNA2$LT90) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)
```
# Looking at solar position and Photoperiod
```{R, echo=FALSE}
library('solarPos')

Solar <- as.data.frame(solarPosition(SweetheartNEWNA1$Jday, -119.7, 49.6, delta_t = 32.184, elev = 500, temp = SweetheartNEWNA1$Temp_mean, pres = 1013.25))
SweetheartNEWNA1$solar <- Solar$azimuth

plot(SweetheartNEWNA1$Photoperiod,
     SweetheartNEWNA1$LT10,
     xlab="Photoperiod",
     ylab="LT90",
     main= "",
     pch=20)

plot(SweetheartNEWNA1$solar,
     SweetheartNEWNA1$LT10,
     xlab="solar",
     ylab="LT90",
     main= "",
     pch=20)

```
* * *
# 5.0 Initial Modelling: FU  < 30

```{r, }
# Initial model fit with Photoperiod
Model10.corCAR1 <- gls(LT10 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final # accumulated chill up to 1119
                                  + Sweetheart_cherry_forcingBB_final_log # + Photoperiod log transformed forcing units
                                  + Photoperiod,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="ML")



Model50.corCAR1 <- gls(LT50 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log  # log transformed forcing units
                                  + Photoperiod,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="ML")

Model90.corCAR1 <- gls(LT90 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log  # log transformed forcing units
                                  + Photoperiod,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="ML")
```

```{r, echo = FALSE, out.width="75%"}
dredgeLT10 <- dredge(Model10.corCAR1)
dredgeLT50 <- dredge(Model50.corCAR1)
dredgeLT90 <- dredge(Model90.corCAR1)

dredgeLT10
dredgeLT50
dredgeLT90

```

```{r, }
# Initial model fit without photoperiod because it is not in the top models and we do not want terms associated with date included in these models
Model10.corCAR1 <- gls(LT10 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final # accumulated chill up to 1119
                                  + Sweetheart_cherry_forcingBB_final_log, # + Photoperiod log transformed forcing units
                                  # + Photoperiod,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="ML")



Model50.corCAR1 <- gls(LT50 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                                  # + Photoperiod,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="ML")

Model90.corCAR1 <- gls(LT90 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                                  # + Photoperiod,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="ML")
```

```{r, echo = FALSE, out.width="75%"}
dredgeLT10 <- dredge(Model10.corCAR1)
dredgeLT50 <- dredge(Model50.corCAR1)
dredgeLT90 <- dredge(Model90.corCAR1)

dredgeLT10
dredgeLT50 
dredgeLT90

```


Model selection: LT10

```{r, echo = FALSE, out.width="75%"}
DT::datatable(dredgeLT10, options = list(pageLength = 5)) %>%
    DT::formatRound(columns=c('(Intercept)', 'Sweetheart_cherry_forcingBB_final_log', 'Temp_mean.lag1', 'Temp_mean.lag2', 'Temp_mean.lag3', 'df', 'logLik', 'AICc', 'delta', 'weight'), digits=2) %>%
    DT::formatRound(columns=c('cherry_model_final'), digits=4)
```

Model selection: LT50

```{r, echo = FALSE, out.width="75%"}
DT::datatable(dredgeLT50, options = list(pageLength = 5)) %>%
    DT::formatRound(columns=c('(Intercept)', 'Sweetheart_cherry_forcingBB_final_log', 'Temp_mean.lag1', 'Temp_mean.lag2', 'Temp_mean.lag3', 'df', 'logLik', 'AICc', 'delta', 'weight'), digits=2) %>%
    DT::formatRound(columns=c('cherry_model_final'), digits=4)
```

Model selection: LT90

```{r, echo = FALSE, out.width="75%"}
DT::datatable(dredgeLT90, options = list(pageLength = 5)) %>%
    DT::formatRound(columns=c('(Intercept)', 'Sweetheart_cherry_forcingBB_final_log', 'Temp_mean.lag1', 'Temp_mean.lag2', 'Temp_mean.lag3', 'df', 'logLik', 'AICc', 'delta', 'weight'), digits=2) %>%
    DT::formatRound(columns=c('cherry_model_final'), digits=4)
```


```{r}
# Refit top reduced model with REML
S_Model10_cherry_forcingBB <- gls(LT10 ~ Temp_mean.lag1 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="REML")

S_Model50_cherry_forcingBB <- gls(LT50 ~ Temp_mean.lag1 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="REML")

# will not include photoperiod. This is the second best model with a delta AICc of 1.55 from the top model, which includes the same variables in addition to photoperiod
S_Model90_cherry_forcingBB <- gls(LT90 ~ Temp_mean.lag1 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="REML")

# Check to see if these variables are significant
  
Model10_p <- as.data.frame(summary(S_Model10_cherry_forcingBB)$tTable[,4])
colnames(Model10_p)[1] = "p"

Model50_p <- as.data.frame(summary(S_Model50_cherry_forcingBB)$tTable[,4])
colnames(Model50_p)[1] = "p"

Model90_p <- as.data.frame(summary(S_Model90_cherry_forcingBB)$tTable[,4])
colnames(Model90_p)[1] = "p"

Model10_p
Model50_p
Model90_p
# all variables are significant

summary(S_Model10_cherry_forcingBB)
summary(S_Model50_cherry_forcingBB)
summary(S_Model90_cherry_forcingBB)
```

Plot coefficients and their confidence intervals

```{R, echo=FALSE, out.width="30%"}
# Check coefficients and their confidence intervals 
Model10_coef <- as.data.frame(coef(S_Model10_cherry_forcingBB))
colnames(Model10_coef)[1] = "coef"
Model10_coef  <- Model10_coef %>% mutate_if(is.numeric, ~round(., 3))
Model50_coef <- as.data.frame(coef(S_Model50_cherry_forcingBB))
colnames(Model50_coef)[1] = "coef"
Model50_coef  <- Model50_coef %>% mutate_if(is.numeric, ~round(., 3))
Model90_coef <- as.data.frame(coef(S_Model90_cherry_forcingBB))
colnames(Model90_coef)[1] = "coef"
Model90_coef  <- Model90_coef %>% mutate_if(is.numeric, ~round(., 3))

Model10_confint <- as.data.frame(confint(S_Model10_cherry_forcingBB))
Model10_confint  <- Model10_confint %>% mutate_if(is.numeric, ~round(., 3))
Model50_confint <- as.data.frame(confint(S_Model50_cherry_forcingBB))
Model50_confint  <- Model50_confint %>% mutate_if(is.numeric, ~round(., 3))
Model90_confint <- as.data.frame(confint(S_Model90_cherry_forcingBB))
Model90_confint  <- Model90_confint %>% mutate_if(is.numeric, ~round(., 3))

Model10_summary <- cbind(Model10_p, Model10_coef, Model10_confint)

Model50_summary <- cbind(Model50_p, Model50_coef, Model50_confint)

Model90_summary <- cbind(Model90_p, Model90_coef, Model90_confint)


Model10_summary$CI <- paste(Model10_summary$'2.5 %', Model10_summary$'97.5 %', sep = ", ")
Model10_summary$coef_CI <- paste(Model10_summary$coef, Model10_summary$CI, sep = " [")
Model10_summary$coef_CI <- paste(Model10_summary$coef_CI,"]", sep = "") # sep for no space
Model10_summary$parameter <- c('Intercept', 'Temp_mean.lag1', 'Temp_mean.lag3', 'CU', 'logFU')

Model50_summary$CI <- paste(Model50_summary$'2.5 %', Model50_summary$'97.5 %', sep = ", ")
Model50_summary$coef_CI <- paste(Model50_summary$coef, Model50_summary$CI, sep = " [")
Model50_summary$coef_CI <- paste(Model50_summary$coef_CI,"]", sep = "") # sep for no space
Model50_summary$parameter <- c('Intercept', 'Temp_mean.lag1', 'Temp_mean.lag3', 'CU', 'logFU')

Model90_summary$CI <- paste(Model90_summary$'2.5 %', Model90_summary$'97.5 %', sep = ", ")
Model90_summary$coef_CI <- paste(Model90_summary$coef, Model90_summary$CI, sep = " [")
Model90_summary$coef_CI <- paste(Model90_summary$coef_CI,"]", sep = "") # sep for no space
Model90_summary$parameter <- c('Intercept', 'Temp_mean.lag1', 'Temp_mean.lag3', 'CU', 'logFU')

write.csv(Model10_summary, file = "./outputs/Model10.Sweetheart.T1_summary.csv", row.names = FALSE)
write.csv(Model50_summary, file = "./outputs/Model50.Sweetheart.T1_summary.csv", row.names = FALSE)
write.csv(Model90_summary, file = "./outputs/Model90.Sweetheart.T1_summary.csv", row.names = FALSE)

# Plot final model parameter estimates and their confidence intervals
plot(coef(S_Model10_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT10 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model10_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model10_cherry_forcingBB)[,1], y1 = confint(S_Model10_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model50_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT50 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model50_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model50_cherry_forcingBB)[,1], y1 = confint(S_Model50_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model90_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT90 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model90_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model90_cherry_forcingBB)[,1], y1 = confint(S_Model90_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()



```

Plot model residuals against fitted values

```{R, echo=FALSE, out.width="30%"}
# Check residuals:
S_Model10_cherry_forcingBB_residuals <- residuals(S_Model10_cherry_forcingBB, type="normalized")
S_Model10_cherry_forcingBB_fitted <- fitted(S_Model10_cherry_forcingBB)

plot(S_Model10_cherry_forcingBB_residuals ~ S_Model10_cherry_forcingBB_fitted,
     main="LT10: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model50_cherry_forcingBB_residuals <- residuals(S_Model50_cherry_forcingBB, type="normalized")
S_Model50_cherry_forcingBB_fitted <- fitted(S_Model50_cherry_forcingBB)

plot(S_Model50_cherry_forcingBB_residuals ~ S_Model50_cherry_forcingBB_fitted,
     main="LT50: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model90_cherry_forcingBB_residuals <- residuals(S_Model90_cherry_forcingBB, type="normalized")
S_Model90_cherry_forcingBB_fitted <- fitted(S_Model90_cherry_forcingBB)

plot(S_Model90_cherry_forcingBB_residuals ~ S_Model90_cherry_forcingBB_fitted,
     main="LT90: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")



hist(S_Model90_cherry_forcingBB_residuals)

qqnorm(S_Model90_cherry_forcingBB_residuals)
qqline(S_Model90_cherry_forcingBB_residuals)

# # Lets check parameter estimates first
# ols_test_normality(S_Model10_cherry_forcingBB_residuals)


hist(S_Model50_cherry_forcingBB_residuals)

qqnorm(S_Model50_cherry_forcingBB_residuals)
qqline(S_Model50_cherry_forcingBB_residuals)

# # Lets check parameter estimates first
# ols_test_normality(S_Model10_cherry_forcingBB_residuals)


hist(S_Model10_cherry_forcingBB_residuals)

qqnorm(S_Model10_cherry_forcingBB_residuals)
qqline(S_Model10_cherry_forcingBB_residuals)

# # Lets check parameter estimates first
# ols_test_normality(S_Model10_cherry_forcingBB_residuals)

```

Check for autocorrelation

```{R, echo=FALSE, out.width="30%"}
acf(S_Model10_cherry_forcingBB_residuals)
acf(S_Model50_cherry_forcingBB_residuals)
acf(S_Model90_cherry_forcingBB_residuals)
```


* * *
# 6.0 Model Evaluation: FU  < 30

```{R echo=FALSE, out.width="30%"}
# Separate temperatures by season so that you can make predictions from fit model
Predict.Season4 <- subset(SweetheartNEW1, Date >= "2013-09-15" & Date <= "2014-04-30")
Predict.Season5 <- subset(SweetheartNEW1, Date >= "2014-09-15" & Date <= "2015-04-30")
Predict.Season6 <- subset(SweetheartNEW1, Date >= "2015-09-15" & Date <= "2016-04-30")
Predict.Season7 <- subset(SweetheartNEW1, Date >= "2016-09-15" & Date <= "2017-04-30")
Predict.Season8 <- subset(SweetheartNEW1, Date >= "2019-09-15" & Date <= "2020-04-30" & Site == "Martens") # you have temp data for AAFC for this year too
Predict.Season9 <- subset(SweetheartNEW1, Date >= "2021-09-15" & Date <= "2022-04-30")



Model10.m <- gls(LT10 ~ Temp_mean.lag1 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="REML")

Model50.m <- gls(LT50 ~ Temp_mean.lag1 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="REML")

Model90.m <- gls(LT90 ~ Temp_mean.lag1 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA1,
                       method="REML")



# # Save models as RData files to be used to make predictions later on or in other .R or .Rmd files more easily
# save(Model10.m, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model10_Sweetheart1.RData")
# save(Model50.m, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model50_Sweetheart1.RData")
# save(Model90.m, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model90_Sweetheart1.RData")

## Season4
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season4 <- as.data.frame(predict(Model10.m, newdata= Predict.Season4, se= TRUE))
Model10.m_Predict.Season4 <- Model10.m_Predict.Season4 %>% dplyr::rename("Model10.m_Predict.Season4"="fit")
Model10.m_Predict.Season4 <- Model10.m_Predict.Season4 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season4 <- as.data.frame(predict(Model50.m, newdata= Predict.Season4, se= TRUE))
Model50.m_Predict.Season4 <- Model50.m_Predict.Season4 %>% dplyr::rename("Model50.m_Predict.Season4"="fit")
Model50.m_Predict.Season4 <- Model50.m_Predict.Season4 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season4 <- as.data.frame(predict(Model90.m, newdata= Predict.Season4, se= TRUE))
Model90.m_Predict.Season4 <- Model90.m_Predict.Season4 %>% dplyr::rename("Model90.m_Predict.Season4"="fit")
Model90.m_Predict.Season4 <- Model90.m_Predict.Season4 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season4 <- cbind(Predict.Season4, 
                         Model10.m_Predict.Season4, 
                         Model50.m_Predict.Season4, 
                         Model90.m_Predict.Season4)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season4~ LT10, data=Predict.Season4)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season4~ LT10, data=Predict.Season4))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season4 ~ LT10, data=Predict.Season4,
     main="LT10: 2013-2014",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season4 ~ LT10, data=Predict.Season4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season4~ LT50, data=Predict.Season4)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season4~ LT50, data=Predict.Season4))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season4 ~ LT50, data=Predict.Season4,
     main="LT50: 2013-2014",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season4 ~ LT50, data=Predict.Season4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season4~ LT90, data=Predict.Season4)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season4~ LT90, data=Predict.Season4))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season4 ~ LT90, data=Predict.Season4,
     main="LT90: 2013-2014",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season4 ~ LT90, data=Predict.Season4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

## Season5
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season5 <- as.data.frame(predict(Model10.m, newdata= Predict.Season5, se= TRUE))
Model10.m_Predict.Season5 <- Model10.m_Predict.Season5 %>% dplyr::rename("Model10.m_Predict.Season5"="fit")
Model10.m_Predict.Season5 <- Model10.m_Predict.Season5 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season5 <- as.data.frame(predict(Model50.m, newdata= Predict.Season5, se= TRUE))
Model50.m_Predict.Season5 <- Model50.m_Predict.Season5 %>% dplyr::rename("Model50.m_Predict.Season5"="fit")
Model50.m_Predict.Season5 <- Model50.m_Predict.Season5 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season5 <- as.data.frame(predict(Model90.m, newdata= Predict.Season5, se= TRUE))
Model90.m_Predict.Season5 <- Model90.m_Predict.Season5 %>% dplyr::rename("Model90.m_Predict.Season5"="fit")
Model90.m_Predict.Season5 <- Model90.m_Predict.Season5 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season5 <- cbind(Predict.Season5, 
                         Model10.m_Predict.Season5, 
                         Model50.m_Predict.Season5, 
                         Model90.m_Predict.Season5)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season5~ LT10, data=Predict.Season5)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season5~ LT10, data=Predict.Season5))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season5 ~ LT10, data=Predict.Season5,
     main="LT10: 2014-2015",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season5 ~ LT10, data=Predict.Season5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season5~ LT50, data=Predict.Season5)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season5~ LT50, data=Predict.Season5))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season5 ~ LT50, data=Predict.Season5,
     main="LT50: 2014-2015",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season5 ~ LT50, data=Predict.Season5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season5~ LT90, data=Predict.Season5)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season5~ LT90, data=Predict.Season5))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season5 ~ LT90, data=Predict.Season5,
     main="LT90: 2014-2015",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season5 ~ LT90, data=Predict.Season5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

## Season6
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season6 <- as.data.frame(predict(Model10.m, newdata= Predict.Season6, se= TRUE))
Model10.m_Predict.Season6 <- Model10.m_Predict.Season6 %>% dplyr::rename("Model10.m_Predict.Season6"="fit")
Model10.m_Predict.Season6 <- Model10.m_Predict.Season6 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season6 <- as.data.frame(predict(Model50.m, newdata= Predict.Season6, se= TRUE))
Model50.m_Predict.Season6 <- Model50.m_Predict.Season6 %>% dplyr::rename("Model50.m_Predict.Season6"="fit")
Model50.m_Predict.Season6 <- Model50.m_Predict.Season6 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season6 <- as.data.frame(predict(Model90.m, newdata= Predict.Season6, se= TRUE))
Model90.m_Predict.Season6 <- Model90.m_Predict.Season6 %>% dplyr::rename("Model90.m_Predict.Season6"="fit")
Model90.m_Predict.Season6 <- Model90.m_Predict.Season6 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season6 <- cbind(Predict.Season6, 
                         Model10.m_Predict.Season6, 
                         Model50.m_Predict.Season6, 
                         Model90.m_Predict.Season6)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season6~ LT10, data=Predict.Season6)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season6~ LT10, data=Predict.Season6))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season6 ~ LT10, data=Predict.Season6,
     main="LT10: 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season6 ~ LT10, data=Predict.Season6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season6~ LT50, data=Predict.Season6)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season6~ LT50, data=Predict.Season6))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season6 ~ LT50, data=Predict.Season6,
     main="LT50: 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season6 ~ LT50, data=Predict.Season6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season6~ LT90, data=Predict.Season6)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season6~ LT90, data=Predict.Season6))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season6 ~ LT90, data=Predict.Season6,
     main="LT90: 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season6 ~ LT90, data=Predict.Season6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

## Season7
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season7 <- as.data.frame(predict(Model10.m, newdata= Predict.Season7, se= TRUE))
Model10.m_Predict.Season7 <- Model10.m_Predict.Season7 %>% dplyr::rename("Model10.m_Predict.Season7"="fit")
Model10.m_Predict.Season7 <- Model10.m_Predict.Season7 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season7 <- as.data.frame(predict(Model50.m, newdata= Predict.Season7, se= TRUE))
Model50.m_Predict.Season7 <- Model50.m_Predict.Season7 %>% dplyr::rename("Model50.m_Predict.Season7"="fit")
Model50.m_Predict.Season7 <- Model50.m_Predict.Season7 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season7 <- as.data.frame(predict(Model90.m, newdata= Predict.Season7, se= TRUE))
Model90.m_Predict.Season7 <- Model90.m_Predict.Season7 %>% dplyr::rename("Model90.m_Predict.Season7"="fit")
Model90.m_Predict.Season7 <- Model90.m_Predict.Season7 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season7 <- cbind(Predict.Season7, 
                         Model10.m_Predict.Season7, 
                         Model50.m_Predict.Season7, 
                         Model90.m_Predict.Season7)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season7~ LT10, data=Predict.Season7)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season7~ LT10, data=Predict.Season7))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season7 ~ LT10, data=Predict.Season7,
     main="LT10: 2016-2017",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season7 ~ LT10, data=Predict.Season7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season7~ LT50, data=Predict.Season7)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season7~ LT50, data=Predict.Season7))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season7 ~ LT50, data=Predict.Season7,
     main="LT50: 2016-2017",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season7 ~ LT50, data=Predict.Season7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season7~ LT90, data=Predict.Season7)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season7~ LT90, data=Predict.Season7))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season7 ~ LT90, data=Predict.Season7,
     main="LT90: 2016-2017",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season7 ~ LT90, data=Predict.Season7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

## Season8
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season8 <- as.data.frame(predict(Model10.m, newdata= Predict.Season8, se= TRUE))
Model10.m_Predict.Season8 <- Model10.m_Predict.Season8 %>% dplyr::rename("Model10.m_Predict.Season8"="fit")
Model10.m_Predict.Season8 <- Model10.m_Predict.Season8 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season8 <- as.data.frame(predict(Model50.m, newdata= Predict.Season8, se= TRUE))
Model50.m_Predict.Season8 <- Model50.m_Predict.Season8 %>% dplyr::rename("Model50.m_Predict.Season8"="fit")
Model50.m_Predict.Season8 <- Model50.m_Predict.Season8 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season8 <- as.data.frame(predict(Model90.m, newdata= Predict.Season8, se= TRUE))
Model90.m_Predict.Season8 <- Model90.m_Predict.Season8 %>% dplyr::rename("Model90.m_Predict.Season8"="fit")
Model90.m_Predict.Season8 <- Model90.m_Predict.Season8 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season8 <- cbind(Predict.Season8, 
                         Model10.m_Predict.Season8, 
                         Model50.m_Predict.Season8, 
                         Model90.m_Predict.Season8)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season8~ LT10, data=Predict.Season8)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season8~ LT10, data=Predict.Season8))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season8 ~ LT10, data=Predict.Season8,
     main="LT10: 2019-2020",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season8 ~ LT10, data=Predict.Season8), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season8~ LT50, data=Predict.Season8)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season8~ LT50, data=Predict.Season8))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season8 ~ LT50, data=Predict.Season8,
     main="LT50: 2019-2020",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season8 ~ LT50, data=Predict.Season8), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season8~ LT90, data=Predict.Season8)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season8~ LT90, data=Predict.Season8))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season8 ~ LT90, data=Predict.Season8,
     main="LT90: 2019-2020",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season8 ~ LT90, data=Predict.Season8), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


## Season9
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season9 <- as.data.frame(predict(Model10.m, newdata= Predict.Season9, se= TRUE))
Model10.m_Predict.Season9 <- Model10.m_Predict.Season9 %>% dplyr::rename("Model10.m_Predict.Season9"="fit")
Model10.m_Predict.Season9 <- Model10.m_Predict.Season9 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season9 <- as.data.frame(predict(Model50.m, newdata= Predict.Season9, se= TRUE))
Model50.m_Predict.Season9 <- Model50.m_Predict.Season9 %>% dplyr::rename("Model50.m_Predict.Season9"="fit")
Model50.m_Predict.Season9 <- Model50.m_Predict.Season9 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season9 <- as.data.frame(predict(Model90.m, newdata= Predict.Season9, se= TRUE))
Model90.m_Predict.Season9 <- Model90.m_Predict.Season9 %>% dplyr::rename("Model90.m_Predict.Season9"="fit")
Model90.m_Predict.Season9 <- Model90.m_Predict.Season9 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season9 <- cbind(Predict.Season9, 
                         Model10.m_Predict.Season9, 
                         Model50.m_Predict.Season9, 
                         Model90.m_Predict.Season9)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season9~ LT10, data=Predict.Season9)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season9~ LT10, data=Predict.Season9))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season9 ~ LT10, data=Predict.Season9,
     main="LT10: 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season9 ~ LT10, data=Predict.Season9), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season9~ LT50, data=Predict.Season9)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season9~ LT50, data=Predict.Season9))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season9 ~ LT50, data=Predict.Season9,
     main="LT50: 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season9 ~ LT50, data=Predict.Season9), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season9~ LT90, data=Predict.Season9)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season9~ LT90, data=Predict.Season9))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season9 ~ LT90, data=Predict.Season9,
     main="LT90: 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season9 ~ LT90, data=Predict.Season9), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)



# dplyr::rename columns so that you can merge your data
Predict.Season4.m <- Predict.Season4 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season4")
Predict.Season4.m <- Predict.Season4.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season4")
Predict.Season4.m <- Predict.Season4.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season4")

Predict.Season5.m <- Predict.Season5 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season5")
Predict.Season5.m <- Predict.Season5.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season5")
Predict.Season5.m <- Predict.Season5.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season5")

Predict.Season6.m <- Predict.Season6 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season6")
Predict.Season6.m <- Predict.Season6.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season6")
Predict.Season6.m <- Predict.Season6.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season6")

Predict.Season7.m <- Predict.Season7 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season7")
Predict.Season7.m <- Predict.Season7.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season7")
Predict.Season7.m <- Predict.Season7.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season7")

Predict.Season8.m <- Predict.Season8 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season8")
Predict.Season8.m <- Predict.Season8.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season8")
Predict.Season8.m <- Predict.Season8.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season8")

Predict.Season9.m <- Predict.Season9 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season9")
Predict.Season9.m <- Predict.Season9.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season9")
Predict.Season9.m <- Predict.Season9.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season9")


AllSeasons_m <- rbind(Predict.Season4.m,
                            Predict.Season5.m,
                            Predict.Season6.m,
                            Predict.Season7.m,
                            Predict.Season8.m,
                            Predict.Season9.m)


# plot these three functions with 1:1 line against each other with R2 value (for all seasons)
par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=AllSeasons_m)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=AllSeasons_m))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=AllSeasons_m,
     main="All Seasons LT10",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model10 ~ LT10, data=AllSeasons_m), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=AllSeasons_m)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=AllSeasons_m))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=AllSeasons_m,
     main="All Seasons LT50",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model50 ~ LT50, data=AllSeasons_m), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=AllSeasons_m)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=AllSeasons_m))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=AllSeasons_m,
     main="All Seasons LT90",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model90 ~ LT90, data=AllSeasons_m), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```
* * *
# RMSE and d

```{R echo = FALSE}
# Calculate RMSE of the three models

T1_LT10 <- sqrt(mean(Model10.m$residuals^2))
T1_LT50 <- sqrt(mean(Model50.m$residuals^2))
T1_LT90 <- sqrt(mean(Model90.m$residuals^2))

Model1RMSE <- as.data.frame(rbind(T1_LT10, T1_LT50, T1_LT90))
Model1RMSE <- Model1RMSE %>% 
  rename(RMSE = V1)
Model1RMSE <- Model1RMSE %>% mutate_if(is.numeric, ~round(., 3))

# calculate Index of agreement (hydroGOF package fn d())
AllSeasonsNA <- na.omit(AllSeasons_m)
Model10.gls_predicted <- AllSeasonsNA$Model10
Model10.gls_observed <- AllSeasonsNA$LT10
d_gls10 <- d(Model10.gls_predicted, Model10.gls_observed)

Model50.gls_predicted <- AllSeasonsNA$Model50
Model50.gls_observed <- AllSeasonsNA$LT50
d_gls50 <- d(Model50.gls_predicted, Model50.gls_observed)

Model90.gls_predicted <- AllSeasonsNA$Model90
Model90.gls_observed <- AllSeasonsNA$LT90
d_gls90 <- d(Model90.gls_predicted, Model90.gls_observed)

Model1.d <- as.data.frame(rbind(d_gls10, d_gls50, d_gls90))
Model1.d <- Model1.d %>% 
  rename(d = V1)
Model1.d <- Model1.d %>% mutate_if(is.numeric, ~round(., 3))


Model1_RMSE_d <- cbind(Model1RMSE, Model1.d)

Model1_RMSE_d
Model1_RMSE_d$Model <- c('T1_LT10', 'T1_LT50', 'T1_LT90')
Model1_RMSE_d  <- Model1_RMSE_d %>% mutate_if(is.numeric, ~round(., 2))

write.csv(Model1_RMSE_d, file = "./outputs/Sweetheart.T1_RMSE_d.csv", row.names = FALSE)
```

***
# 7.0 Model Visualization: FU  < 30

```{R echo = FALSE, out.width="30%"}
# Assume approximately 2 standard errors produces the confidence intervals

# Season4
LT10.CIUpper <- (Predict.Season4.m$Model10 + Predict.Season4.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season4.m$Model10 - Predict.Season4.m$se.fit.10*1.96)
Season4.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season4.LT10.CI <- as.data.frame(Season4.LT10.CI)

LT50.CIUpper <- (Predict.Season4.m$Model50 + Predict.Season4.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season4.m$Model50 - Predict.Season4.m$se.fit.50*1.96)
Season4.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season4.LT50.CI <- as.data.frame(Season4.LT50.CI)

LT90.CIUpper <- (Predict.Season4.m$Model90 + Predict.Season4.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season4.m$Model90 - Predict.Season4.m$se.fit.90*1.96)
Season4.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season4.LT90.CI <- as.data.frame(Season4.LT90.CI)

Predict.Season4.m <- cbind(Predict.Season4.m, Season4.LT10.CI, Season4.LT50.CI, Season4.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season4.m,
     main= "LT10: 2013-2014",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT10.CIUpper, lty = 2)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season4.m,
     main= "LT50: 2013-2014",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT50.CIUpper, lty = 2)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season4.m,
     main= "LT90: 2013-2014",
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season4.m$Date, Predict.Season4.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT90.CIUpper, lty = 2)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT90.CILower, lty = 2)

# Season5
LT10.CIUpper <- (Predict.Season5.m$Model10 + Predict.Season5.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season5.m$Model10 - Predict.Season5.m$se.fit.10*1.96)
Season5.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season5.LT10.CI <- as.data.frame(Season5.LT10.CI)

LT50.CIUpper <- (Predict.Season5.m$Model50 + Predict.Season5.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season5.m$Model50 - Predict.Season5.m$se.fit.50*1.96)
Season5.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season5.LT50.CI <- as.data.frame(Season5.LT50.CI)

LT90.CIUpper <- (Predict.Season5.m$Model90 + Predict.Season5.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season5.m$Model90 - Predict.Season5.m$se.fit.90*1.96)
Season5.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season5.LT90.CI <- as.data.frame(Season5.LT90.CI)

Predict.Season5.m <- cbind(Predict.Season5.m, Season5.LT10.CI, Season5.LT50.CI, Season5.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season5.m,
     main= "LT10: 2014-2015",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season5.m$Date, Predict.Season5.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season5.m$Date, Predict.Season5.m$LT10.CIUpper, lty = 2)
lines(Predict.Season5.m$Date, Predict.Season5.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season5.m,
     main= "LT50: 2014-2015",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season5.m$Date, Predict.Season5.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season5.m$Date, Predict.Season5.m$LT50.CIUpper, lty = 2)
lines(Predict.Season5.m$Date, Predict.Season5.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season5.m,
     main= "LT90: 2014-2015",
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season5.m$Date, Predict.Season5.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season5.m$Date, Predict.Season5.m$LT90.CIUpper, lty = 2)
lines(Predict.Season5.m$Date, Predict.Season5.m$LT90.CILower, lty = 2)

# Season6
LT10.CIUpper <- (Predict.Season6.m$Model10 + Predict.Season6.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season6.m$Model10 - Predict.Season6.m$se.fit.10*1.96)
Season6.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season6.LT10.CI <- as.data.frame(Season6.LT10.CI)

LT50.CIUpper <- (Predict.Season6.m$Model50 + Predict.Season6.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season6.m$Model50 - Predict.Season6.m$se.fit.50*1.96)
Season6.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season6.LT50.CI <- as.data.frame(Season6.LT50.CI)

LT90.CIUpper <- (Predict.Season6.m$Model90 + Predict.Season6.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season6.m$Model90 - Predict.Season6.m$se.fit.90*1.96)
Season6.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season6.LT90.CI <- as.data.frame(Season6.LT90.CI)

Predict.Season6.m <- cbind(Predict.Season6.m, Season6.LT10.CI, Season6.LT50.CI, Season6.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season6.m,
     main= "LT10: 2015-2016",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season6.m$Date, Predict.Season6.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT10.CIUpper, lty = 2)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season6.m,
     main= "LT50: 2015-2016",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT50.CIUpper, lty = 2)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season6.m,
     main= "LT90: 2015-2016",
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season6.m$Date, Predict.Season6.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT90.CIUpper, lty = 2)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT90.CILower, lty = 2)

# Season7
LT10.CIUpper <- (Predict.Season7.m$Model10 + Predict.Season7.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season7.m$Model10 - Predict.Season7.m$se.fit.10*1.96)
Season7.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season7.LT10.CI <- as.data.frame(Season7.LT10.CI)

LT50.CIUpper <- (Predict.Season7.m$Model50 + Predict.Season7.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season7.m$Model50 - Predict.Season7.m$se.fit.50*1.96)
Season7.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season7.LT50.CI <- as.data.frame(Season7.LT50.CI)

LT90.CIUpper <- (Predict.Season7.m$Model90 + Predict.Season7.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season7.m$Model90 - Predict.Season7.m$se.fit.90*1.96)
Season7.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season7.LT90.CI <- as.data.frame(Season7.LT90.CI)

Predict.Season7.m <- cbind(Predict.Season7.m, Season7.LT10.CI, Season7.LT50.CI, Season7.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season7.m,
     main= "LT10: 2016-2017",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season7.m$Date, Predict.Season7.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT10.CIUpper, lty = 2)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season7.m,
     main= "LT50: 2016-2017",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season7.m$Date, Predict.Season7.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT50.CIUpper, lty = 2)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season7.m,
     main= "LT90: 2016-2017",
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season7.m$Date, Predict.Season7.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT90.CIUpper, lty = 2)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT90.CILower, lty = 2)


# Season8
LT10.CIUpper <- (Predict.Season8.m$Model10 + Predict.Season8.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season8.m$Model10 - Predict.Season8.m$se.fit.10*1.96)
Season8.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season8.LT10.CI <- as.data.frame(Season8.LT10.CI)

LT50.CIUpper <- (Predict.Season8.m$Model50 + Predict.Season8.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season8.m$Model50 - Predict.Season8.m$se.fit.50*1.96)
Season8.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season8.LT50.CI <- as.data.frame(Season8.LT50.CI)

LT90.CIUpper <- (Predict.Season8.m$Model90 + Predict.Season8.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season8.m$Model90 - Predict.Season8.m$se.fit.90*1.96)
Season8.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season8.LT90.CI <- as.data.frame(Season8.LT90.CI)

Predict.Season8.m <- cbind(Predict.Season8.m, Season8.LT10.CI, Season8.LT50.CI, Season8.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season8.m,
     main= "LT10: 2019-2020",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season8.m$Date, Predict.Season8.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season8.m$Date, Predict.Season8.m$LT10.CIUpper, lty = 2)
lines(Predict.Season8.m$Date, Predict.Season8.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season8.m,
     main= "LT50: 2019-2020",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season8.m$Date, Predict.Season8.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season8.m$Date, Predict.Season8.m$LT50.CIUpper, lty = 2)
lines(Predict.Season8.m$Date, Predict.Season8.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season8.m,
     main= "LT90: 2019-2020",
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season8.m$Date, Predict.Season8.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season8.m$Date, Predict.Season8.m$LT90.CIUpper, lty = 2)
lines(Predict.Season8.m$Date, Predict.Season8.m$LT90.CILower, lty = 2)

# Season9
LT10.CIUpper <- (Predict.Season9.m$Model10 + Predict.Season9.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season9.m$Model10 - Predict.Season9.m$se.fit.10*1.96)
Season9.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season9.LT10.CI <- as.data.frame(Season9.LT10.CI)

LT50.CIUpper <- (Predict.Season9.m$Model50 + Predict.Season9.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season9.m$Model50 - Predict.Season9.m$se.fit.50*1.96)
Season9.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season9.LT50.CI <- as.data.frame(Season9.LT50.CI)

LT90.CIUpper <- (Predict.Season9.m$Model90 + Predict.Season9.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season9.m$Model90 - Predict.Season9.m$se.fit.90*1.96)
Season9.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season9.LT90.CI <- as.data.frame(Season9.LT90.CI)

Predict.Season9.m <- cbind(Predict.Season9.m, Season9.LT10.CI, Season9.LT50.CI, Season9.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season9.m,
     main= "LT10: 2021-2022",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season9.m$Date, Predict.Season9.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season9.m$Date, Predict.Season9.m$LT10.CIUpper, lty = 2)
lines(Predict.Season9.m$Date, Predict.Season9.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season9.m,
     main= "LT50: 2021-2022",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season9.m$Date, Predict.Season9.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season9.m$Date, Predict.Season9.m$LT50.CIUpper, lty = 2)
lines(Predict.Season9.m$Date, Predict.Season9.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season9.m,
     main= "LT90: 2021-2022",
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
lines(Predict.Season9.m$Date, Predict.Season9.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season9.m$Date, Predict.Season9.m$LT90.CIUpper, lty = 2)
lines(Predict.Season9.m$Date, Predict.Season9.m$LT90.CILower, lty = 2)
```
# Looking at solar position and Photoperiod
```{R, echo=FALSE}
library('solarPos')

Solar <- as.data.frame(solarPosition(SweetheartNEWNA2$Jday, -119.7, 49.6, delta_t = 32.184, elev = 500, temp = SweetheartNEWNA2$Temp_mean, pres = 1013.25))
SweetheartNEWNA2$solar <- Solar$azimuth

plot(SweetheartNEWNA2$Photoperiod,
     SweetheartNEWNA2$LT50,
     xlab="Photoperiod",
     ylab="LT50",
     main= "",
     pch=20)

plot(SweetheartNEWNA2$solar,
     SweetheartNEWNA2$LT50,
     xlab="solar",
     ylab="LT50",
     main= "",
     pch=20)

# no relationship between solar or photoperiod and LT, omit from model selection
```

***
# 8.0 Initial Modelling: FU  >= 30

```{r}
Model10.corCAR1 <- gls(LT10 ~  stages +
                                    Sweetheart_cherry_forcingBB_final,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="ML")

Model50.corCAR1 <- gls(LT50 ~  stages +
                                    Sweetheart_cherry_forcingBB_final,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="ML")

Model90.corCAR1 <- gls(LT90 ~  stages +
                                    Sweetheart_cherry_forcingBB_final,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="ML")
```
```{r, echo = FALSE, out.width="75%"}
dredgeLT10 <- dredge(Model10.corCAR1)

dredgeLT50 <- dredge(Model50.corCAR1)

dredgeLT90 <- dredge(Model90.corCAR1)
```

Model selection: LT10

```{r, echo = FALSE, out.width="75%"}
DT::datatable(dredgeLT10, options = list(pageLength = 5)) %>%
    DT::formatRound(columns=c('(Intercept)',  'stages', 'Sweetheart_cherry_forcingBB_final', 'logLik', 'AICc', 'delta', 'weight' ), digits=2) %>%
    DT::formatRound(columns=c('Sweetheart_cherry_forcingBB_final','stages'), digits=3)
```

Model selection: LT50

```{r, echo = FALSE, out.width="75%"}
DT::datatable(dredgeLT50, options = list(pageLength = 5)) %>%
    DT::formatRound(columns=c('(Intercept)',  'stages', 'Sweetheart_cherry_forcingBB_final', 'logLik', 'AICc', 'delta', 'weight' ), digits=2) %>%
    DT::formatRound(columns=c('Sweetheart_cherry_forcingBB_final','stages'), digits=3)
```

Model selection: LT90

```{r, echo = FALSE, out.width="75%"}
DT::datatable(dredgeLT90, options = list(pageLength = 5)) %>% 
   DT::formatRound(columns=c('(Intercept)',  'stages', 'Sweetheart_cherry_forcingBB_final',  'logLik', 'AICc', 'delta', 'weight' ), digits=2) %>%
   DT::formatRound(columns=c('Sweetheart_cherry_forcingBB_final','stages'), digits=3)
```


```{r}
# intercept only model is the top model
# drop variables and refit with REML
S_Model10_cherry_forcingBB <- gls(LT10 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="REML")

S_Model50_cherry_forcingBB <- gls(LT50 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="REML")

S_Model90_cherry_forcingBB <- gls(LT90 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="REML")


# Check to see if these variables are significant
Model10_p <- as.data.frame(summary(S_Model10_cherry_forcingBB)$tTable[,4])
colnames(Model10_p)[1] = "p"

Model50_p <- as.data.frame(summary(S_Model50_cherry_forcingBB)$tTable[,4])
colnames(Model50_p)[1] = "p"

Model90_p <- as.data.frame(summary(S_Model90_cherry_forcingBB)$tTable[,4])
colnames(Model90_p)[1] = "p"

# all variables are significant
```

Plot coefficients and their confidence intervals

```{R, echo=FALSE, out.width="30%"}
# Check coefficients and their confidence intervals 
Model10_coef <- as.data.frame(coef(S_Model10_cherry_forcingBB))
colnames(Model10_coef)[1] = "coef"
Model10_coef  <- Model10_coef %>% mutate_if(is.numeric, ~round(., 3))
Model50_coef <- as.data.frame(coef(S_Model50_cherry_forcingBB))
colnames(Model50_coef)[1] = "coef"
Model50_coef  <- Model50_coef %>% mutate_if(is.numeric, ~round(., 3))
Model90_coef <- as.data.frame(coef(S_Model90_cherry_forcingBB))
colnames(Model90_coef)[1] = "coef"
Model90_coef  <- Model90_coef %>% mutate_if(is.numeric, ~round(., 3))

Model10_confint <- as.data.frame(confint(S_Model10_cherry_forcingBB))
Model10_confint  <- Model10_confint %>% mutate_if(is.numeric, ~round(., 3))
Model50_confint <- as.data.frame(confint(S_Model50_cherry_forcingBB))
Model50_confint  <- Model50_confint %>% mutate_if(is.numeric, ~round(., 3))
Model90_confint <- as.data.frame(confint(S_Model90_cherry_forcingBB))
Model90_confint  <- Model90_confint %>% mutate_if(is.numeric, ~round(., 3))

Model10_summary <- cbind(Model10_p, Model10_coef, Model10_confint)

Model50_summary <- cbind(Model50_p, Model50_coef, Model50_confint)

Model90_summary <- cbind(Model90_p, Model90_coef, Model90_confint)


Model10_summary$CI <- paste(Model10_summary$'2.5 %', Model10_summary$'97.5 %', sep = ", ")
Model10_summary$coef_CI <- paste(Model10_summary$coef, Model10_summary$CI, sep = " [")
Model10_summary$coef_CI <- paste(Model10_summary$coef_CI,"]", sep = "") # sep for no space
Model10_summary$parameter <- c('Intercept')

Model50_summary$CI <- paste(Model50_summary$'2.5 %', Model50_summary$'97.5 %', sep = ", ")
Model50_summary$coef_CI <- paste(Model50_summary$coef, Model50_summary$CI, sep = " [")
Model50_summary$coef_CI <- paste(Model50_summary$coef_CI,"]", sep = "") # sep for no space
Model50_summary$parameter <- c('Intercept')

Model90_summary$CI <- paste(Model90_summary$'2.5 %', Model90_summary$'97.5 %', sep = ", ")
Model90_summary$coef_CI <- paste(Model90_summary$coef, Model90_summary$CI, sep = " [")
Model90_summary$coef_CI <- paste(Model90_summary$coef_CI,"]", sep = "") # sep for no space
Model90_summary$parameter <- c('Intercept')

write.csv(Model10_summary, file = "./outputs/Model10.Sweetheart.T2_summary.csv", row.names = FALSE)
write.csv(Model50_summary, file = "./outputs/Model50.Sweetheart.T2_summary.csv", row.names = FALSE)
write.csv(Model90_summary, file = "./outputs/Model90.Sweetheart.T2_summary.csv", row.names = FALSE)


# Plot final model parameter estimates and their confidence intervals
plot(coef(S_Model10_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT10 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model10_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model10_cherry_forcingBB)[,1], y1 = confint(S_Model10_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model50_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT50 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model50_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model50_cherry_forcingBB)[,1], y1 = confint(S_Model50_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model90_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT90 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model90_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model90_cherry_forcingBB)[,1], y1 = confint(S_Model90_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()
```

Plot model residuals against fitted values

```{R, echo=FALSE, out.width="30%"}
# Check residuals:
S_Model10_cherry_forcingBB_residuals <- residuals(S_Model10_cherry_forcingBB, type="normalized")
S_Model10_cherry_forcingBB_fitted <- fitted(S_Model10_cherry_forcingBB)

plot(S_Model10_cherry_forcingBB_residuals ~ S_Model10_cherry_forcingBB_fitted,
     main="LT10: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model50_cherry_forcingBB_residuals <- residuals(S_Model50_cherry_forcingBB, type="normalized")
S_Model50_cherry_forcingBB_fitted <- fitted(S_Model50_cherry_forcingBB)

plot(S_Model50_cherry_forcingBB_residuals ~ S_Model50_cherry_forcingBB_fitted,
     main="LT50: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model90_cherry_forcingBB_residuals <- residuals(S_Model90_cherry_forcingBB, type="normalized")
S_Model90_cherry_forcingBB_fitted <- fitted(S_Model90_cherry_forcingBB)

plot(S_Model90_cherry_forcingBB_residuals ~ S_Model90_cherry_forcingBB_fitted,
     main="LT90: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")
```

Check for autocorrelation

```{R, echo=FALSE, out.width="30%"}
acf(S_Model10_cherry_forcingBB_residuals)
acf(S_Model50_cherry_forcingBB_residuals)
acf(S_Model90_cherry_forcingBB_residuals)
```


***
# 9.0 Model Evaluation: FU >= 30
```{R echo=FALSE, out.width="30%", warning = FALSE}

# Separate temperatures by season so that you can make predictions from fit model
Predict.Season4.2 <- subset(SweetheartNEW2, Date >= "2013-09-15" & Date <= "2014-04-30")
Predict.Season5.2 <- subset(SweetheartNEW2, Date >= "2014-09-15" & Date <= "2015-04-30")
Predict.Season6.2 <- subset(SweetheartNEW2, Date >= "2015-09-15" & Date <= "2016-04-30")
Predict.Season7.2 <- subset(SweetheartNEW2, Date >= "2016-09-15" & Date <= "2017-04-30")
Predict.Season8.2 <- subset(SweetheartNEW2, Date >= "2019-09-15" & Date <= "2020-04-30" & Site == "Martens") # you have temp data for AAFC for this year too
Predict.Season9.2 <- subset(SweetheartNEW2, Date >= "2021-09-15" & Date <= "2022-04-30")


# Rename new models so you dont have to alter the code throughout

Model10.m2<- gls(LT10 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="REML")

Model50.m2 <- gls(LT50 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="REML")

Model90.m2 <- gls(LT90 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=SweetheartNEWNA2,
                       method="REML")


# # Save models as RData files to be used to make predictions later on or in other .R or .Rmd files more easily
# save(Model10.m2, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model10_Sweetheart2.RData")
# save(Model50.m2, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model50_Sweetheart2.RData")
# save(Model90.m2, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model90_Sweetheart2.RData")

## Season4
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season4.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season4.2, se=TRUE))
Model10.m2_Predict.Season4.2 <- Model10.m2_Predict.Season4.2 %>% dplyr::rename("Model10.m2_Predict.Season4.2"="fit")
Model10.m2_Predict.Season4.2 <- Model10.m2_Predict.Season4.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season4.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season4.2, se= TRUE))
Model50.m2_Predict.Season4.2 <- Model50.m2_Predict.Season4.2 %>% dplyr::rename("Model50.m2_Predict.Season4.2"="fit")
Model50.m2_Predict.Season4.2 <- Model50.m2_Predict.Season4.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season4.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season4.2, se= TRUE))
Model90.m2_Predict.Season4.2 <- Model90.m2_Predict.Season4.2 %>% dplyr::rename("Model90.m2_Predict.Season4.2"="fit")
Model90.m2_Predict.Season4.2 <- Model90.m2_Predict.Season4.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season4.2 <- cbind(Predict.Season4.2, 
                         Model10.m2_Predict.Season4.2, 
                         Model50.m2_Predict.Season4.2, 
                         Model90.m2_Predict.Season4.2)


## Season5
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season5.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season5.2, se= TRUE))
Model10.m2_Predict.Season5.2 <- Model10.m2_Predict.Season5.2 %>% dplyr::rename("Model10.m2_Predict.Season5.2"="fit")
Model10.m2_Predict.Season5.2 <- Model10.m2_Predict.Season5.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season5.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season5.2, se= TRUE))
Model50.m2_Predict.Season5.2 <- Model50.m2_Predict.Season5.2 %>% dplyr::rename("Model50.m2_Predict.Season5.2"="fit")
Model50.m2_Predict.Season5.2 <- Model50.m2_Predict.Season5.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season5.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season5.2, se= TRUE))
Model90.m2_Predict.Season5.2 <- Model90.m2_Predict.Season5.2 %>% dplyr::rename("Model90.m2_Predict.Season5.2"="fit")
Model90.m2_Predict.Season5.2 <- Model90.m2_Predict.Season5.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season5.2 <- cbind(Predict.Season5.2, 
                         Model10.m2_Predict.Season5.2, 
                         Model50.m2_Predict.Season5.2, 
                         Model90.m2_Predict.Season5.2)


## Season6
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season6.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season6.2, se= TRUE))
Model10.m2_Predict.Season6.2 <- Model10.m2_Predict.Season6.2 %>% dplyr::rename("Model10.m2_Predict.Season6.2"="fit")
Model10.m2_Predict.Season6.2 <- Model10.m2_Predict.Season6.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season6.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season6.2, se= TRUE))
Model50.m2_Predict.Season6.2 <- Model50.m2_Predict.Season6.2 %>% dplyr::rename("Model50.m2_Predict.Season6.2"="fit")
Model50.m2_Predict.Season6.2 <- Model50.m2_Predict.Season6.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season6.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season6.2, se= TRUE))
Model90.m2_Predict.Season6.2 <- Model90.m2_Predict.Season6.2 %>% dplyr::rename("Model90.m2_Predict.Season6.2"="fit")
Model90.m2_Predict.Season6.2 <- Model90.m2_Predict.Season6.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season6.2 <- cbind(Predict.Season6.2, 
                         Model10.m2_Predict.Season6.2, 
                         Model50.m2_Predict.Season6.2, 
                         Model90.m2_Predict.Season6.2)


## Season7
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season7.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season7.2, se= TRUE))
Model10.m2_Predict.Season7.2 <- Model10.m2_Predict.Season7.2 %>% dplyr::rename("Model10.m2_Predict.Season7.2"="fit")
Model10.m2_Predict.Season7.2 <- Model10.m2_Predict.Season7.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season7.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season7.2, se= TRUE))
Model50.m2_Predict.Season7.2 <- Model50.m2_Predict.Season7.2 %>% dplyr::rename("Model50.m2_Predict.Season7.2"="fit")
Model50.m2_Predict.Season7.2 <- Model50.m2_Predict.Season7.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season7.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season7.2, se= TRUE))
Model90.m2_Predict.Season7.2 <- Model90.m2_Predict.Season7.2 %>% dplyr::rename("Model90.m2_Predict.Season7.2"="fit")
Model90.m2_Predict.Season7.2 <- Model90.m2_Predict.Season7.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season7.2 <- cbind(Predict.Season7.2, 
                         Model10.m2_Predict.Season7.2, 
                         Model50.m2_Predict.Season7.2, 
                         Model90.m2_Predict.Season7.2)

## Season8
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season8.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season8.2, se= TRUE))
Model10.m2_Predict.Season8.2 <- Model10.m2_Predict.Season8.2 %>% dplyr::rename("Model10.m2_Predict.Season8.2"="fit")
Model10.m2_Predict.Season8.2 <- Model10.m2_Predict.Season8.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season8.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season8.2, se= TRUE))
Model50.m2_Predict.Season8.2 <- Model50.m2_Predict.Season8.2 %>% dplyr::rename("Model50.m2_Predict.Season8.2"="fit")
Model50.m2_Predict.Season8.2 <- Model50.m2_Predict.Season8.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season8.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season8.2, se= TRUE))
Model90.m2_Predict.Season8.2 <- Model90.m2_Predict.Season8.2 %>% dplyr::rename("Model90.m2_Predict.Season8.2"="fit")
Model90.m2_Predict.Season8.2 <- Model90.m2_Predict.Season8.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season8.2 <- cbind(Predict.Season8.2, 
                         Model10.m2_Predict.Season8.2, 
                         Model50.m2_Predict.Season8.2, 
                         Model90.m2_Predict.Season8.2)

## Season9
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season9.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season9.2, se= TRUE))
Model10.m2_Predict.Season9.2 <- Model10.m2_Predict.Season9.2 %>% dplyr::rename("Model10.m2_Predict.Season9.2"="fit")
Model10.m2_Predict.Season9.2 <- Model10.m2_Predict.Season9.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season9.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season9.2, se= TRUE))
Model50.m2_Predict.Season9.2 <- Model50.m2_Predict.Season9.2 %>% dplyr::rename("Model50.m2_Predict.Season9.2"="fit")
Model50.m2_Predict.Season9.2 <- Model50.m2_Predict.Season9.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season9.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season9.2, se= TRUE))
Model90.m2_Predict.Season9.2 <- Model90.m2_Predict.Season9.2 %>% dplyr::rename("Model90.m2_Predict.Season9.2"="fit")
Model90.m2_Predict.Season9.2 <- Model90.m2_Predict.Season9.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season9.2 <- cbind(Predict.Season9.2, 
                         Model10.m2_Predict.Season9.2, 
                         Model50.m2_Predict.Season9.2, 
                         Model90.m2_Predict.Season9.2)





# dplyr::rename columns so that you can merge your data
Predict.Season4.2.m2 <- Predict.Season4.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season4.2")
Predict.Season4.2.m2 <- Predict.Season4.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season4.2")
Predict.Season4.2.m2 <- Predict.Season4.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season4.2")

Predict.Season5.2.m2 <- Predict.Season5.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season5.2")
Predict.Season5.2.m2 <- Predict.Season5.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season5.2")
Predict.Season5.2.m2 <- Predict.Season5.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season5.2")

Predict.Season6.2.m2 <- Predict.Season6.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season6.2")
Predict.Season6.2.m2 <- Predict.Season6.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season6.2")
Predict.Season6.2.m2 <- Predict.Season6.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season6.2")

Predict.Season7.2.m2 <- Predict.Season7.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season7.2")
Predict.Season7.2.m2 <- Predict.Season7.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season7.2")
Predict.Season7.2.m2 <- Predict.Season7.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season7.2")

Predict.Season8.2.m2 <- Predict.Season8.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season8.2")
Predict.Season8.2.m2 <- Predict.Season8.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season8.2")
Predict.Season8.2.m2 <- Predict.Season8.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season8.2")

Predict.Season9.2.m2 <- Predict.Season9.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season9.2")
Predict.Season9.2.m2 <- Predict.Season9.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season9.2")
Predict.Season9.2.m2 <- Predict.Season9.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season9.2")

AllSeasons_m2 <- rbind(Predict.Season4.2.m2,
                            Predict.Season5.2.m2,
                            Predict.Season6.2.m2,
                            Predict.Season7.2.m2,
                            Predict.Season8.2.m2,
                            Predict.Season9.2.m2)


# plot these three functions with 1:1 line against each other with R2 value (for all seasons)
par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=AllSeasons_m2)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=AllSeasons_m2))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=AllSeasons_m2,
     main="All Seasons LT10 Sweetheart cherry forcingBB",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model10 ~ LT10, data=AllSeasons_m2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=AllSeasons_m2)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=AllSeasons_m2))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=AllSeasons_m2,
     main="All Seasons LT50 Sweetheart cherry forcingBB",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model50 ~ LT50, data=AllSeasons_m2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=AllSeasons_m2)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=AllSeasons_m2))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=AllSeasons_m2,
     main="All Seasons LT90 Sweetheart cherry forcingBB",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model90 ~ LT90, data=AllSeasons_m2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

```{R echo = FALSE}
# Calculate RMSE of the three models
T2_LT10 <- sqrt(mean(Model10.m2$residuals^2))
T2_LT50 <- sqrt(mean(Model50.m2$residuals^2))
T2_LT90 <- sqrt(mean(Model90.m2$residuals^2))

Model2RMSE <- as.data.frame(rbind(T2_LT10, T2_LT50, T2_LT90))
Model2RMSE <- Model2RMSE %>%
  rename(RMSE = V1)
Model2RMSE <- Model2RMSE %>% mutate_if(is.numeric, ~round(., 3))

# calculate Index of agreement (hydroGOF package fn d())
AllSeasons_m2NA <- na.omit(AllSeasons_m2)
Model10.gls_predicted <- AllSeasons_m2NA$Model10
Model10.gls_observed <- AllSeasons_m2NA$LT10
d_gls10 <- hydroGOF::d(Model10.gls_predicted, Model10.gls_observed)

Model50.gls_predicted <- AllSeasons_m2NA$Model50
Model50.gls_observed <- AllSeasons_m2NA$LT50
d_gls50 <- hydroGOF::d(Model50.gls_predicted, Model50.gls_observed)

Model90.gls_predicted <- AllSeasons_m2NA$Model90
Model90.gls_observed <- AllSeasons_m2NA$LT90
d_gls90 <- hydroGOF::d(Model90.gls_predicted, Model90.gls_observed)

Model2.d <- as.data.frame(rbind(d_gls10, d_gls50, d_gls90))
Model2.d <- Model2.d %>%
  rename(d = V1)
Model2.d <- Model2.d %>% mutate_if(is.numeric, ~round(., 3))

Model2_RMSE_d <- cbind(Model2RMSE, Model2.d)
Model2_RMSE_d  <- Model2_RMSE_d %>% mutate_if(is.numeric, ~round(., 2))

Model2_RMSE_d

# write.csv(Model2_RMSE_d, file = "./outputs/Sweetheart.T2_RMSE_d.csv", row.names = FALSE)

```

* * *
# Average Difference (Observed-Estimated)
```{r}

# T2 average difference between Observed and Estimated values
# Don't evaluate using RMSE but instead take the average
AllSeasons_m2NA_averaged <- na.omit(AllSeasons_m2)
AllSeasons_m2NA_averaged <- AllSeasons_m2NA_averaged %>% mutate_if(is.numeric, ~round(., 2))
AllSeasons_m2NA_averaged$Obs_pred_LT10 <- (AllSeasons_m2NA_averaged$Model10) - (AllSeasons_m2NA_averaged$LT10)



Avg_obs_pred_LT10 <- mean(AllSeasons_m2NA_averaged$Obs_pred_LT10)

Avg_obs_pred_LT10



AllSeasons_m2NA_averaged$Obs_pred_LT50 <- (AllSeasons_m2NA_averaged$Model50) - (AllSeasons_m2NA_averaged$LT50)
Avg_obs_pred_LT50 <- mean(AllSeasons_m2NA_averaged$Obs_pred_LT50)

Avg_obs_pred_LT50


AllSeasons_m2NA_averaged$Obs_pred_LT90 <- (AllSeasons_m2NA_averaged$Model90) - (AllSeasons_m2NA_averaged$LT90)
Avg_obs_pred_LT90 <- mean(AllSeasons_m2NA_averaged$Obs_pred_LT90)

Avg_obs_pred_LT90

```

***
# 10.0 Model Visualization: FU >= 30
```{R echo = FALSE, out.width="30%", warning = FALSE}
# Assume approximately 2 standard errors produces the confidence intervals
# Assume approximately 2 standard errors produces the confidence intervals
# Need to assign them values to get this to work:

# Season4
LT10.CIUpper <- (Predict.Season4.2.m2$Model10 + Predict.Season4.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season4.2.m2$Model10 - Predict.Season4.2.m2$se.fit.10*1.96)
Season4.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season4.LT10.CI <- as.data.frame(Season4.LT10.CI)

LT50.CIUpper <- (Predict.Season4.2.m2$Model50 + Predict.Season4.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season4.2.m2$Model50 - Predict.Season4.2.m2$se.fit.50*1.96)
Season4.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season4.LT50.CI <- as.data.frame(Season4.LT50.CI)

LT90.CIUpper <- (Predict.Season4.2.m2$Model90 + Predict.Season4.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season4.2.m2$Model90 - Predict.Season4.2.m2$se.fit.90*1.96)
Season4.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season4.LT90.CI <- as.data.frame(Season4.LT90.CI)

Predict.Season4.2.m2 <- cbind(Predict.Season4.2.m2, Season4.LT10.CI, Season4.LT50.CI, Season4.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season4.2.m2,
     main= "LT10: 2013-2014",
     pch= 20,
     xlab=" ", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model10, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season4.2.m2,
     main= "LT50: 2013-2014",
     pch= 20,
     xlab=" ", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season4.2.m2,
     main= "LT90: 2013-2014",
     pch= 20,
     xlab=" ", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model90, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT90.CILower, lty = 2)

# Season5
LT10.CIUpper <- (Predict.Season5.2.m2$Model10 + Predict.Season5.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season5.2.m2$Model10 - Predict.Season5.2.m2$se.fit.10*1.96)
Season5.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season5.LT10.CI <- as.data.frame(Season5.LT10.CI)

LT50.CIUpper <- (Predict.Season5.2.m2$Model50 + Predict.Season5.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season5.2.m2$Model50 - Predict.Season5.2.m2$se.fit.50*1.96)
Season5.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season5.LT50.CI <- as.data.frame(Season5.LT50.CI)

LT90.CIUpper <- (Predict.Season5.2.m2$Model90 + Predict.Season5.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season5.2.m2$Model90 - Predict.Season5.2.m2$se.fit.90*1.96)
Season5.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season5.LT90.CI <- as.data.frame(Season5.LT90.CI)

Predict.Season5.2.m2 <- cbind(Predict.Season5.2.m2, Season5.LT10.CI, Season5.LT50.CI, Season5.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season5.2.m2,
     main= "LT10: 2014-2015",
     pch= 20,
     xlab=" ", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model10, lty = 1)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season5.2.m2,
     main= "LT50: 2014-2015",
     pch= 20,
     xlab=" ", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model50, lty = 1)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season5.2.m2,
     main= "LT90: 2014-2015",
     pch= 20,
     xlab=" ", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model90, lty = 1)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT90.CILower, lty = 2)

# Season6
LT10.CIUpper <- (Predict.Season6.2.m2$Model10 + Predict.Season6.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season6.2.m2$Model10 - Predict.Season6.2.m2$se.fit.10*1.96)
Season6.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season6.LT10.CI <- as.data.frame(Season6.LT10.CI)

LT50.CIUpper <- (Predict.Season6.2.m2$Model50 + Predict.Season6.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season6.2.m2$Model50 - Predict.Season6.2.m2$se.fit.50*1.96)
Season6.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season6.LT50.CI <- as.data.frame(Season6.LT50.CI)

LT90.CIUpper <- (Predict.Season6.2.m2$Model90 + Predict.Season6.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season6.2.m2$Model90 - Predict.Season6.2.m2$se.fit.90*1.96)
Season6.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season6.LT90.CI <- as.data.frame(Season6.LT90.CI)

Predict.Season6.2.m2 <- cbind(Predict.Season6.2.m2, Season6.LT10.CI, Season6.LT50.CI, Season6.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season6.2.m2,
     main= "LT10: 2015-2016",
     pch= 20,
     xlab=" ", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model10, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season6.2.m2,
     main= "LT50: 2015-2016",
     pch= 20,
     xlab=" ", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season6.2.m2,
     main= "LT90: 2015-2016",
     pch= 20,
     xlab=" ", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model90, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT90.CILower, lty = 2)

# Season7
LT10.CIUpper <- (Predict.Season7.2.m2$Model10 + Predict.Season7.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season7.2.m2$Model10 - Predict.Season7.2.m2$se.fit.10*1.96)
Season7.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season7.LT10.CI <- as.data.frame(Season7.LT10.CI)

LT50.CIUpper <- (Predict.Season7.2.m2$Model50 + Predict.Season7.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season7.2.m2$Model50 - Predict.Season7.2.m2$se.fit.50*1.96)
Season7.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season7.LT50.CI <- as.data.frame(Season7.LT50.CI)

LT90.CIUpper <- (Predict.Season7.2.m2$Model90 + Predict.Season7.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season7.2.m2$Model90 - Predict.Season7.2.m2$se.fit.90*1.96)
Season7.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season7.LT90.CI <- as.data.frame(Season7.LT90.CI)

Predict.Season7.2.m2 <- cbind(Predict.Season7.2.m2, Season7.LT10.CI, Season7.LT50.CI, Season7.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season7.2.m2,
     main= "LT10: 2016-2017",
     pch= 20,
     xlab=" ", 
     ylab="LT10 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model10, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season7.2.m2,
     main= "LT50: 2016-2017",
     pch= 20,
     xlab=" ", 
     ylab="LT50 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model50, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season7.2.m2,
     main= "LT90: 2016-2017",
     pch= 20,
     xlab=" ", 
     ylab="LT90 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model90, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT90.CILower, lty = 2)

# Season8
LT10.CIUpper <- (Predict.Season8.2.m2$Model10 + Predict.Season8.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season8.2.m2$Model10 - Predict.Season8.2.m2$se.fit.10*1.96)
Season8.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season8.LT10.CI <- as.data.frame(Season8.LT10.CI)

LT50.CIUpper <- (Predict.Season8.2.m2$Model50 + Predict.Season8.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season8.2.m2$Model50 - Predict.Season8.2.m2$se.fit.50*1.96)
Season8.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season8.LT50.CI <- as.data.frame(Season8.LT50.CI)

LT90.CIUpper <- (Predict.Season8.2.m2$Model90 + Predict.Season8.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season8.2.m2$Model90 - Predict.Season8.2.m2$se.fit.90*1.96)
Season8.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season8.LT90.CI <- as.data.frame(Season8.LT90.CI)

Predict.Season8.2.m2 <- cbind(Predict.Season8.2.m2, Season8.LT10.CI, Season8.LT50.CI, Season8.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season8.2.m2,
     main= "LT10: 2019-2020",
     pch= 20,
     xlab=" ", 
     ylab="LT10 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model10, lty = 1)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season8.2.m2,
     main= "LT50: 2019-2020",
     pch= 20,
     xlab=" ", 
     ylab="LT50 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model50, lty = 1)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season8.2.m2,
     main= "LT90: 2019-2020",
     pch= 20,
     xlab=" ", 
     ylab="LT90 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model90, lty = 1)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$LT90.CILower, lty = 2)

# Season9
LT10.CIUpper <- (Predict.Season9.2.m2$Model10 + Predict.Season9.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season9.2.m2$Model10 - Predict.Season9.2.m2$se.fit.10*1.96)
Season9.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season9.LT10.CI <- as.data.frame(Season9.LT10.CI)

LT50.CIUpper <- (Predict.Season9.2.m2$Model50 + Predict.Season9.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season9.2.m2$Model50 - Predict.Season9.2.m2$se.fit.50*1.96)
Season9.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season9.LT50.CI <- as.data.frame(Season9.LT50.CI)

LT90.CIUpper <- (Predict.Season9.2.m2$Model90 + Predict.Season9.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season9.2.m2$Model90 - Predict.Season9.2.m2$se.fit.90*1.96)
Season9.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season9.LT90.CI <- as.data.frame(Season9.LT90.CI)

Predict.Season9.2.m2 <- cbind(Predict.Season9.2.m2, Season9.LT10.CI, Season9.LT50.CI, Season9.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season9.2.m2,
     main= "LT10: 2021-2022",
     pch= 20,
     xlab=" ", 
     ylab="LT10 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model10, lty = 1)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season9.2.m2,
     main= "LT50: 2021-2022",
     pch= 20,
     xlab=" ", 
     ylab="LT50 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model50, lty = 1)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season9.2.m2,
     main= "LT90: 2021-2022",
     pch= 20,
     xlab=" ", 
     ylab="LT90 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model90, lty = 1)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$LT90.CILower, lty = 2)
```

***
# 11.0 Full Model Visualization
Combine models for forcing units <30 and >=30

```{R echo = FALSE, out.width="30%"}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)
points8 <- rbind(Predict.Season8.m, Predict.Season8.2.m2)
points9 <- rbind(Predict.Season9.m, Predict.Season9.2.m2)

# Plot Season4
plot(LT10 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "LT10: 2013-2014",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT10.CILower, rev(Predict.Season4.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT10.CILower, rev(Predict.Season4.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model10, lty = 1, col= c("mediumblue"), lwd=1.5)


# plot(LT10 ~ Date, data=Predict.Season4.m,
#      main= "LT10: 2013-2014",
#      pch= 20,
#      xlab="", 
#      ylab="LT10 (˚C)",
#      cex.main=1.65,
#      cex.axis=1.15,
#      cex.lab=1.45, ylim=c(-30, 0))
# lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1, lwd=1.5)
# lines(Predict.Season4.m$Date, Predict.Season4.m$LT10.CIUpper, lty = 2)
# lines(Predict.Season4.m$Date, Predict.Season4.m$LT10.CILower, lty = 2)




plot(LT50 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "LT50: 2013-2014",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT50.CILower, rev(Predict.Season4.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT50.CILower, rev(Predict.Season4.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1,  lwd=1.5)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))


plot(LT90 ~ Date, data=points4,
     main= "LT90: 2013-2014",
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT90.CILower, rev(Predict.Season4.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT90.CILower, rev(Predict.Season4.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model90, lty = 1, lwd=1.5, col= c("mediumblue"))



# Plot Season5
plot(LT10 ~ Date, data=points5,
     main= "LT10: 2014-2015",
     xlim = as.Date(c("2014-09-01", "2015-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT10.CILower, rev(Predict.Season5.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT10.CILower, rev(Predict.Season5.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season5.m$Date, Predict.Season5.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model10, lty = 1, lwd=1.5, col= c("mediumblue"))

plot(LT50 ~ Date, data=points5,
     main= "LT50: 2014-2015",
     xlim = as.Date(c("2014-09-01", "2015-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT50.CILower, rev(Predict.Season5.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT50.CILower, rev(Predict.Season5.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season5.m$Date, Predict.Season5.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))


plot(LT90 ~ Date, data=points5,
     main= "LT90: 2014-2015",
     xlim = as.Date(c("2014-09-01", "2015-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT90.CILower, rev(Predict.Season5.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT90.CILower, rev(Predict.Season5.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season5.m$Date, Predict.Season5.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model90, lty = 1, lwd=1.5, col= c("mediumblue"))


# Plot Season6
plot(LT10 ~ Date, data=points6,
     main= "LT10: 2015-2016",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT10.CILower, rev(Predict.Season6.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT10.CILower, rev(Predict.Season6.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model10, lty = 1, lwd=1.5, col= c("mediumblue"))

plot(LT50 ~ Date, data=points6,
     main= "LT50: 2015-2016",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT50.CILower, rev(Predict.Season6.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT50.CILower, rev(Predict.Season6.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))


plot(LT90 ~ Date, data=points6,
     main= "LT90: 2015-2016",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT90.CILower, rev(Predict.Season6.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT90.CILower, rev(Predict.Season6.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model90, lty = 1, lwd=1.5, col= c("mediumblue"))




# Plot Season7
plot(LT10 ~ Date, data=points7,
     main= "LT10: 2016-2017",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT10.CILower, rev(Predict.Season7.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT10.CILower, rev(Predict.Season7.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model10, lty = 1, lwd=1.5, col= c("mediumblue"))

plot(LT50 ~ Date, data=points7,
     main= "LT50: 2016-2017",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT50.CILower, rev(Predict.Season7.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT50.CILower, rev(Predict.Season7.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))


plot(LT90 ~ Date, data=points7,
     main= "LT90: 2016-2017",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT90.CILower, rev(Predict.Season7.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines, rgb specifications lets us have alpha changes (transparency)
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT90.CILower, rev(Predict.Season7.2.m2$LT90.CIUpper)), 
        col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model90, lty = 1, lwd=1.5, col= c("mediumblue"))
# legend('topleft', legend=c("Measured Values"),
#        col=c("black"), pch = 20, cex=1,
#        box.lty=0)


# Plot Season8
plot(LT10 ~ Date, data=points8,
     main= "LT10: 2019-2020",
     xlim = as.Date(c("2019-09-01", "2020-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season8.m$Date, rev(Predict.Season8.m$Date)), c(Predict.Season8.m$LT10.CILower, rev(Predict.Season8.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season8.2.m2$Date, rev(Predict.Season8.2.m2$Date)), c(Predict.Season8.2.m2$LT10.CILower, rev(Predict.Season8.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season8.m$Date, Predict.Season8.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model10, lty = 1, lwd=1.5, col= c("mediumblue"))

plot(LT50 ~ Date, data=points8,
     main= "LT50: 2019-2020",
     xlim = as.Date(c("2019-09-01", "2020-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season8.m$Date, rev(Predict.Season8.m$Date)), c(Predict.Season8.m$LT50.CILower, rev(Predict.Season8.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season8.2.m2$Date, rev(Predict.Season8.2.m2$Date)), c(Predict.Season8.2.m2$LT50.CILower, rev(Predict.Season8.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season8.m$Date, Predict.Season8.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))


plot(LT90 ~ Date, data=points8,
     main= "LT90: 2019-2020",
     xlim = as.Date(c("2019-09-01", "2020-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season8.m$Date, rev(Predict.Season8.m$Date)), c(Predict.Season8.m$LT90.CILower, rev(Predict.Season8.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines, rgb specifications lets us have alpha changes (transparency)
polygon(c(Predict.Season8.2.m2$Date, rev(Predict.Season8.2.m2$Date)), c(Predict.Season8.2.m2$LT90.CILower, rev(Predict.Season8.2.m2$LT90.CIUpper)), 
        col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season8.m$Date, Predict.Season8.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model90, lty = 1, lwd=1.5, col= c("mediumblue"))
# legend('topleft', legend=c("Measured Values"),
#        col=c("black"), pch = 20, cex=1,
#        box.lty=0)



# Plot Season9
plot(LT10 ~ Date, data=points9,
     main= "LT10: 2021-2022",
     xlim = as.Date(c("2021-09-01", "2022-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season9.m$Date, rev(Predict.Season9.m$Date)), c(Predict.Season9.m$LT10.CILower, rev(Predict.Season9.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season9.2.m2$Date, rev(Predict.Season9.2.m2$Date)), c(Predict.Season9.2.m2$LT10.CILower, rev(Predict.Season9.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season9.m$Date, Predict.Season9.m$Model10, lty = 1, lwd=1.5)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model10, lty = 1, lwd=1.5, col= c("mediumblue"))

plot(LT50 ~ Date, data=points9,
     main= "LT50: 2021-2022",
     xlim = as.Date(c("2021-09-01", "2022-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season9.m$Date, rev(Predict.Season9.m$Date)), c(Predict.Season9.m$LT50.CILower, rev(Predict.Season9.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season9.2.m2$Date, rev(Predict.Season9.2.m2$Date)), c(Predict.Season9.2.m2$LT50.CILower, rev(Predict.Season9.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season9.m$Date, Predict.Season9.m$Model50, lty = 1, lwd=1.5)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))


plot(LT90 ~ Date, data=points9,
     main= "LT90: 2021-2022",
     xlim = as.Date(c("2021-09-01", "2022-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.65,
     cex.axis=1.15,
     cex.lab=1.45, ylim=c(-30, 0))
polygon(c(Predict.Season9.m$Date, rev(Predict.Season9.m$Date)), c(Predict.Season9.m$LT90.CILower, rev(Predict.Season9.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines, rgb specifications lets us have alpha changes (transparency)
polygon(c(Predict.Season9.2.m2$Date, rev(Predict.Season9.2.m2$Date)), c(Predict.Season9.2.m2$LT90.CILower, rev(Predict.Season9.2.m2$LT90.CIUpper)), 
        col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season9.m$Date, Predict.Season9.m$Model90, lty = 1, lwd=1.5)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model90, lty = 1, lwd=1.5, col= c("mediumblue"))

# legend('topleft', legend=c("Measured Values"),
#        col=c("black"), pch = 20, cex=1,
#        box.lty=0)


# 
# plot(LT50 ~ Date, data=points6,
#      main= "LT50: 2015-2016",
#      xlim = as.Date(c("2015-09-01", "2016-04-25")),
#      pch= 20,
#      xlab="",
#      ylab="LT50 (˚C)",
#      cex.main=1.25,
#      cex=0.75,
#      cex.lab=1, ylim=c(-25, 0))
# polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT50.CILower, rev(Predict.Season6.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
# polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT50.CILower, rev(Predict.Season6.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
# lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1, lwd=1.5)
# lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1, lwd=1.5, col= c("mediumblue"))
# legend('bottomleft', legend=c("Observed"),
#        col=c("black"), pch=20, cex=0.75, box.lty=0)
# legend('bottomleft', legend=c("Predicted T1", "Predicted T2"),
#        col=c("black", "mediumblue"), lty=1, cex=0.75, box.lty=0)
```
***
# 11.1 Full Model Visualization: Publication Figures LT50
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)
points8 <- rbind(Predict.Season8.m, Predict.Season8.2.m2)
points9 <- rbind(Predict.Season9.m, Predict.Season9.2.m2)

points4 <- points4 %>% mutate_if(is.numeric, ~round(., 2))
points5 <- points5 %>% mutate_if(is.numeric, ~round(., 2))
points6 <- points6 %>% mutate_if(is.numeric, ~round(., 2))
points7 <- points7 %>% mutate_if(is.numeric, ~round(., 2))
points8 <- points8 %>% mutate_if(is.numeric, ~round(., 2))
points9 <- points9 %>% mutate_if(is.numeric, ~round(., 2))

# par(pty="m")
par(mfrow=c(2,3)) 

# pdf("LT50.1.pdf", width = 6, height = 5)
plot(LT50 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT50 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT50.CILower, rev(Predict.Season4.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT50.CILower, rev(Predict.Season4.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1,  lwd=1.15)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2014-03-25'), -24, "2013-2014", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 


plot(LT50 ~ Date, data=points5,
     main= "",
     xlim = as.Date(c("2014-09-01", "2015-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT50.CILower, rev(Predict.Season5.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT50.CILower, rev(Predict.Season5.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season5.m$Date, Predict.Season5.m$Model50, lty = 1, lwd=1.15)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2015-03-25'), -24, "2014-2015", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT50 ~ Date, data=points6,
     main= "",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT50.CILower, rev(Predict.Season6.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT50.CILower, rev(Predict.Season6.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1, lwd=1.15)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2016-03-25'), -24, "2015-2016", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT50 ~ Date, data=points7,
     main= "",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab= expression("LT50 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT50.CILower, rev(Predict.Season7.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT50.CILower, rev(Predict.Season7.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model50, lty = 1, lwd=1.15)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2017-03-25'), -24, "2016-2017", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT50 ~ Date, data=points8,
     main= "",
     xlim = as.Date(c("2019-09-01", "2020-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season8.m$Date, rev(Predict.Season8.m$Date)), c(Predict.Season8.m$LT50.CILower, rev(Predict.Season8.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season8.2.m2$Date, rev(Predict.Season8.2.m2$Date)), c(Predict.Season8.2.m2$LT50.CILower, rev(Predict.Season8.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season8.m$Date, Predict.Season8.m$Model50, lty = 1, lwd=1.15)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2020-03-25'), -24, "2019-2020", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT50 ~ Date, data=points9,
     main= "",
     xlim = as.Date(c("2021-09-01", "2022-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season9.m$Date, rev(Predict.Season9.m$Date)), c(Predict.Season9.m$LT50.CILower, rev(Predict.Season9.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season9.2.m2$Date, rev(Predict.Season9.2.m2$Date)), c(Predict.Season9.2.m2$LT50.CILower, rev(Predict.Season9.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season9.m$Date, Predict.Season9.m$Model50, lty = 1, lwd=1.15)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2022-03-25'), -24, "2021-2022", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

# save width as 6 x 15 inches
```

***
# 11.1 Full Model Visualization: Publication Figures LT10
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points
# par(pty="m") # reset from square
par(mfrow=c(2,3)) 

# pdf("LT10.1.pdf", width = 6, height = 5)
plot(LT10 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT10 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, -0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT10.CILower, rev(Predict.Season4.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT10.CILower, rev(Predict.Season4.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1,  lwd=1.15)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2014-03-25'), -21, "2013-2014", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 


plot(LT10 ~ Date, data=points5,
     main= "",
     xlim = as.Date(c("2014-09-01", "2015-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT10.CILower, rev(Predict.Season5.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT10.CILower, rev(Predict.Season5.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season5.m$Date, Predict.Season5.m$Model10, lty = 1, lwd=1.15)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2015-03-25'), -21, "2014-2015", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT10 ~ Date, data=points6,
     main= "",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT10.CILower, rev(Predict.Season6.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT10.CILower, rev(Predict.Season6.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model10, lty = 1, lwd=1.15)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2016-03-25'), -21, "2015-2016", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT10 ~ Date, data=points7,
     main= "",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab= expression("LT10 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT10.CILower, rev(Predict.Season7.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT10.CILower, rev(Predict.Season7.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model10, lty = 1, lwd=1.15)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2017-03-25'), -21, "2016-2017", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT10 ~ Date, data=points8,
     main= "",
     xlim = as.Date(c("2019-09-01", "2020-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season8.m$Date, rev(Predict.Season8.m$Date)), c(Predict.Season8.m$LT10.CILower, rev(Predict.Season8.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season8.2.m2$Date, rev(Predict.Season8.2.m2$Date)), c(Predict.Season8.2.m2$LT10.CILower, rev(Predict.Season8.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season8.m$Date, Predict.Season8.m$Model10, lty = 1, lwd=1.15)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2020-03-25'), -21, "2019-2020", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT10 ~ Date, data=points9,
     main= "",
     xlim = as.Date(c("2021-09-01", "2022-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season9.m$Date, rev(Predict.Season9.m$Date)), c(Predict.Season9.m$LT10.CILower, rev(Predict.Season9.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season9.2.m2$Date, rev(Predict.Season9.2.m2$Date)), c(Predict.Season9.2.m2$LT10.CILower, rev(Predict.Season9.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season9.m$Date, Predict.Season9.m$Model10, lty = 1, lwd=1.15)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2022-03-25'), -21, "2021-2022", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

# save width as 6 x 15 inches
```

***
# 11.1 Full Model Visualization: Publication Figures LT90
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

par(pty="m") # reset from square
par(mfrow=c(2,3)) 

# pdf("LT90.1.pdf", width = 6, height = 5)
plot(LT90 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT90 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT90.CILower, rev(Predict.Season4.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT90.CILower, rev(Predict.Season4.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model90, lty = 1,  lwd=1.15)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2014-03-25'), -26.5, "2013-2014", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 


plot(LT90 ~ Date, data=points5,
     main= "",
     xlim = as.Date(c("2014-09-01", "2015-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT90.CILower, rev(Predict.Season5.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT90.CILower, rev(Predict.Season5.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season5.m$Date, Predict.Season5.m$Model90, lty = 1, lwd=1.15)
lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2015-03-25'), -26.5, "2014-2015", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT90 ~ Date, data=points6,
     main= "",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT90.CILower, rev(Predict.Season6.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT90.CILower, rev(Predict.Season6.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model90, lty = 1, lwd=1.15)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2016-03-25'), -26.5, "2015-2016", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT90 ~ Date, data=points7,
     main= "",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab= expression("LT90 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT90.CILower, rev(Predict.Season7.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT90.CILower, rev(Predict.Season7.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model90, lty = 1, lwd=1.15)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2017-03-25'), -26.5, "2016-2017", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT90 ~ Date, data=points8,
     main= "",
     xlim = as.Date(c("2019-09-01", "2020-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season8.m$Date, rev(Predict.Season8.m$Date)), c(Predict.Season8.m$LT90.CILower, rev(Predict.Season8.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season8.2.m2$Date, rev(Predict.Season8.2.m2$Date)), c(Predict.Season8.2.m2$LT90.CILower, rev(Predict.Season8.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season8.m$Date, Predict.Season8.m$Model90, lty = 1, lwd=1.15)
lines(Predict.Season8.2.m2$Date, Predict.Season8.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2020-03-25'), -26.5, "2019-2020", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

plot(LT90 ~ Date, data=points9,
     main= "",
     xlim = as.Date(c("2021-09-01", "2022-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season9.m$Date, rev(Predict.Season9.m$Date)), c(Predict.Season9.m$LT90.CILower, rev(Predict.Season9.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season9.2.m2$Date, rev(Predict.Season9.2.m2$Date)), c(Predict.Season9.2.m2$LT90.CILower, rev(Predict.Season9.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season9.m$Date, Predict.Season9.m$Model90, lty = 1, lwd=1.15)
lines(Predict.Season9.2.m2$Date, Predict.Season9.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2022-03-25'), -26.5, "2021-2022", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

# save width as 6 x 15 inches
```


***
# 12.0 Full Model Evaluation (1:1)
Combine models for forcing units <30 and >=30

```{R, echo = FALSE, out.width="30%"}
AllSeasons_m$colour <- "black"
AllSeasons_m2$colour <- "blue"
Sweetheart_all <- rbind(AllSeasons_m, AllSeasons_m2)

Predict.Season4.m$colour <- "black"
Predict.Season4.2.m2$colour <- "blue"

Predict.Season5.m$colour <- "black"
Predict.Season5.2.m2$colour <- "blue"

Predict.Season6.m$colour <- "black"
Predict.Season6.2.m2$colour <- "blue"

Predict.Season7.m$colour <- "black"
Predict.Season7.2.m2$colour <- "blue"

Predict.Season8.m$colour <- "black"
Predict.Season8.2.m2$colour <- "blue"

Predict.Season9.m$colour <- "black"
Predict.Season9.2.m2$colour <- "blue"

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)
points8 <- rbind(Predict.Season8.m, Predict.Season8.2.m2)
points9 <- rbind(Predict.Season9.m, Predict.Season9.2.m2)

## Season4

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=points4)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=points4))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=points4,
     main="LT10: 2013-2014",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points4$colour)
abline(lm(Model10 ~ LT10, data=points4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=points4)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=points4))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=points4,
     main="LT50: 2013-2014",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points4$colour)
abline(lm(Model50 ~ LT50, data=points4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=points4)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=points4))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=points4,
     main="LT90: 2013-2014",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points4$colour)
abline(lm(Model90 ~ LT90, data=points4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

## Season5

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=points5)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=points5))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=points5,
     main="LT10: 2014-2015",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points5$colour)
abline(lm(Model10 ~ LT10, data=points5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=points5)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=points5))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=points5,
     main="LT50: 2014-2015",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points5$colour)
abline(lm(Model50 ~ LT50, data=points5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=points5)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=points5))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=points5,
     main="LT90: 2014-2015",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points5$colour)
abline(lm(Model90 ~ LT90, data=points5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


## Season6

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=points6)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=points6))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=points6,
     main="LT10: 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points6$colour)
abline(lm(Model10 ~ LT10, data=points6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=points6)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=points6))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=points6,
     main="LT50: 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points6$colour)
abline(lm(Model50 ~ LT50, data=points6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=points6)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=points6))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=points6,
     main="LT90: 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points6$colour)
abline(lm(Model90 ~ LT90, data=points6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


## Season7

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=points7)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=points7))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=points7,
     main="LT10: 2016-2017",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points7$colour)
abline(lm(Model10 ~ LT10, data=points7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=points7)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=points7))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=points7,
     main="LT50: 2016-2017",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points7$colour)
abline(lm(Model50 ~ LT50, data=points7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=points7)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=points7))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=points7,
     main="LT90: 2016-2017",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points7$colour)
abline(lm(Model90 ~ LT90, data=points7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)



## Season8

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=points8)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=points8))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=points8,
     main="LT10: 2019-2020",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points8$colour)
abline(lm(Model10 ~ LT10, data=points8), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=points8)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=points8))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=points8,
     main="LT50: 2019-2020",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points8$colour)
abline(lm(Model50 ~ LT50, data=points8), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=points8)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=points8))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=points8,
     main="LT90: 2019-2020",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points8$colour)
abline(lm(Model90 ~ LT90, data=points8), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


## Season9

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=points9)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=points9))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=points9,
     main="LT10: 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points9$colour)
abline(lm(Model10 ~ LT10, data=points9), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=points9)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=points9))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=points9,
     main="LT50: 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points9$colour)
abline(lm(Model50 ~ LT50, data=points9), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=points9)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=points9))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=points9,
     main="LT90: 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=points9$colour)
abline(lm(Model90 ~ LT90, data=points9), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


# all seasons

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)
par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=Sweetheart_all)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=Sweetheart_all))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=Sweetheart_all,
     main="10% Lethal Temperature",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=Sweetheart_all$colour)
abline(lm(Model10 ~ LT10, data=Sweetheart_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=Sweetheart_all)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=Sweetheart_all))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=Sweetheart_all,
     main="50% Lethal Temperature",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=Sweetheart_all$colour)
abline(lm(Model50 ~ LT50, data=Sweetheart_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=Sweetheart_all)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=Sweetheart_all))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=Sweetheart_all,
     main="90% Lethal Temperature",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-25, 0),
     ylim= c(-25, 0),
     cex=0.5,
     col=Sweetheart_all$colour)
abline(lm(Model90 ~ LT90, data=Sweetheart_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

***
# 12.1 Full Model Evaluation (1:1): Publication Figures
Combine models for forcing units <30 and >=30

```{R, echo = FALSE}
# all seasons

Sweetheart_all <- Sweetheart_all %>% mutate_if(is.numeric, ~round(., 2))

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(mfrow=c(1,3)) 
# plot(LT50 ~ Date, data=points4,
#      xlim = as.Date(c("2013-09-01", "2014-04-25")),
#      main= "",
#      pch= 20,
#      xlab="", 
#      ylab= expression("LT50 (" * degree * C *")"),
#      cex.main=1.65,
#      cex.axis=1.75,
#      cex.lab=1.75, ylim=c(-25, -3))
# polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT50.CILower, rev(Predict.Season4.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
# polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT50.CILower, rev(Predict.Season4.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
# lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1,  lwd=1.15)
# lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
# text(as.Date('2014-03-25'), -24, "2013-2014", cex = 1.65)
# par(mar = c(3, 5, 1, 1.5)) 



par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=Sweetheart_all)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=Sweetheart_all))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=Sweetheart_all,
     # main="LT10",
     pch=20,
     font.main = 1, #removes bold title
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= expression("Predicted Temperature (" * degree * C *")"),
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Sweetheart_all$colour)
abline(lm(Model10 ~ LT10, data=Sweetheart_all), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=Sweetheart_all)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=Sweetheart_all))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=Sweetheart_all,
     # main="LT50",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Sweetheart_all$colour)
abline(lm(Model50 ~ LT50, data=Sweetheart_all), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=Sweetheart_all)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=Sweetheart_all))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=Sweetheart_all,
     # main="LT90",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Sweetheart_all$colour)
abline(lm(Model90 ~ LT90, data=Sweetheart_all), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)


# save width as 4.5 x 11.5 inches
```

* * *
# Average Difference (Observed-Estimated): Full Model
```{r}

# T2 average difference between Observed and Estimated values
# Don't evaluate using RMSE but instead take the average
Sweetheart_allNA_averaged <- na.omit(Sweetheart_all)
Sweetheart_allNA_averaged <- Sweetheart_allNA_averaged %>% mutate_if(is.numeric, ~round(., 2))
Sweetheart_allNA_averaged$Obs_pred_LT10 <- (Sweetheart_allNA_averaged$Model10) - (Sweetheart_allNA_averaged$LT10)



Avg_obs_pred_LT10 <- mean(Sweetheart_allNA_averaged$Obs_pred_LT10)

Avg_obs_pred_LT10



Sweetheart_allNA_averaged$Obs_pred_LT50 <- (Sweetheart_allNA_averaged$Model50) - (Sweetheart_allNA_averaged$LT50)
Avg_obs_pred_LT50 <- mean(Sweetheart_allNA_averaged$Obs_pred_LT50)

Avg_obs_pred_LT50


Sweetheart_allNA_averaged$Obs_pred_LT90 <- (Sweetheart_allNA_averaged$Model90) - (Sweetheart_allNA_averaged$LT90)
Avg_obs_pred_LT90 <- mean(Sweetheart_allNA_averaged$Obs_pred_LT90)

Avg_obs_pred_LT90

```


```{R echo = FALSE}
# Calculate RMSE of the three models
Model10.m_T1_residuals <- as.data.frame(Model10.m$residuals)
colnames(Model10.m_T1_residuals)[1] = "residuals"

Model10.m_T2_residuals <- as.data.frame(Model10.m2$residuals)
colnames(Model10.m_T2_residuals)[1] = "residuals"

Model10_T1_T2_residuals <- rbind(Model10.m_T1_residuals, Model10.m_T2_residuals)


Model50.m_T1_residuals <- as.data.frame(Model50.m$residuals)
colnames(Model50.m_T1_residuals)[1] = "residuals"

Model50.m_T2_residuals <- as.data.frame(Model50.m2$residuals)
colnames(Model50.m_T2_residuals)[1] = "residuals"

Model50_T1_T2_residuals <- rbind(Model50.m_T1_residuals, Model50.m_T2_residuals)

Model90.m_T1_residuals <- as.data.frame(Model90.m$residuals)
colnames(Model90.m_T1_residuals)[1] = "residuals"

Model90.m_T2_residuals <- as.data.frame(Model90.m2$residuals)
colnames(Model90.m_T2_residuals)[1] = "residuals"

Model90_T1_T2_residuals <- rbind(Model90.m_T1_residuals, Model90.m_T2_residuals)

T1_T2_LT10 <- sqrt(mean(Model10_T1_T2_residuals$residuals^2))
T1_T2_LT50 <- sqrt(mean(Model50_T1_T2_residuals$residuals^2))
T1_T2_LT90 <- sqrt(mean(Model90_T1_T2_residuals$residuals^2))

Model_T1_T2_RMSE <- as.data.frame(rbind(T1_T2_LT10, T1_T2_LT50, T1_T2_LT90))
Model_T1_T2_RMSE <- Model_T1_T2_RMSE %>% 
  rename(RMSE = V1)
Model_T1_T2_RMSE <- Model_T1_T2_RMSE %>% mutate_if(is.numeric, ~round(., 2))

# calculate Index of agreement (hydroGOF package fn d())
AllSeasonsNA <- na.omit(AllSeasons_m)
Model10.gls_predicted <- as.data.frame(AllSeasonsNA$Model10)
colnames(Model10.gls_predicted)[1] = "predicted"
Model10.gls_observed <- as.data.frame(AllSeasonsNA$LT10)
colnames(Model10.gls_observed)[1] = "observed"

AllSeasons_m2NA <- na.omit(AllSeasons_m2)
Model10.gls_predicted2 <- as.data.frame(AllSeasons_m2NA$Model10)
colnames(Model10.gls_predicted2)[1] = "predicted"
Model10.gls_observed2 <- as.data.frame(AllSeasons_m2NA$LT10)
colnames(Model10.gls_observed2)[1] = "observed"

Model10.gls_predicted_T1_T2 <- rbind(Model10.gls_predicted, Model10.gls_predicted2)
Model10.gls_observed_T1_T2 <- rbind(Model10.gls_observed, Model10.gls_observed2)

d_T1_T2_gls10 <- hydroGOF::d(Model10.gls_predicted_T1_T2, Model10.gls_observed_T1_T2)



Model50.gls_predicted <- as.data.frame(AllSeasonsNA$Model50)
colnames(Model50.gls_predicted)[1] = "predicted"
Model50.gls_observed <- as.data.frame(AllSeasonsNA$LT50)
colnames(Model50.gls_observed)[1] = "observed"

Model50.gls_predicted2 <- as.data.frame(AllSeasons_m2NA$Model50)
colnames(Model50.gls_predicted2)[1] = "predicted"
Model50.gls_observed2 <- as.data.frame(AllSeasons_m2NA$LT50)
colnames(Model50.gls_observed2)[1] = "observed"

Model50.gls_predicted_T1_T2 <- rbind(Model50.gls_predicted, Model50.gls_predicted2)
Model50.gls_observed_T1_T2 <- rbind(Model50.gls_observed, Model50.gls_observed2)

d_T1_T2_gls50 <- hydroGOF::d(Model50.gls_predicted_T1_T2, Model50.gls_observed_T1_T2)


Model90.gls_predicted <- as.data.frame(AllSeasonsNA$Model90)
colnames(Model90.gls_predicted)[1] = "predicted"
Model90.gls_observed <- as.data.frame(AllSeasonsNA$LT90)
colnames(Model90.gls_observed)[1] = "observed"

Model90.gls_predicted2 <- as.data.frame(AllSeasons_m2NA$Model90)
colnames(Model90.gls_predicted2)[1] = "predicted"
Model90.gls_observed2 <- as.data.frame(AllSeasons_m2NA$LT90)
colnames(Model90.gls_observed2)[1] = "observed"

Model90.gls_predicted_T1_T2 <- rbind(Model90.gls_predicted, Model90.gls_predicted2)
Model90.gls_observed_T1_T2 <- rbind(Model90.gls_observed, Model90.gls_observed2)

d_T1_T2_gls90 <- hydroGOF::d(Model90.gls_predicted_T1_T2, Model90.gls_observed_T1_T2)




Model_T1_T2.d <- as.data.frame(rbind(d_T1_T2_gls10, d_T1_T2_gls50, d_T1_T2_gls90))
Model_T1_T2.d <- Model_T1_T2.d %>% 
  rename(d = observed)
Model_T1_T2.d <- Model_T1_T2.d %>% mutate_if(is.numeric, ~round(., 2))


Model_T1_T2_RMSE_d <- cbind(Model_T1_T2_RMSE, Model_T1_T2.d)

Model_T1_T2_RMSE_d
Model_T1_T2_RMSE_d$Model <- c('T1_T2_LT10', 'T1_T2_LT50', 'T1_T2_LT90')
Model_T1_T2_RMSE_d  <- Model_T1_T2_RMSE_d %>% mutate_if(is.numeric, ~round(., 2))

write.csv(Model_T1_T2_RMSE_d, file = "./outputs/Sweetheart.T1.T2_RMSE_d.csv", row.names = FALSE)
```

***
# 13.0 Percentage of observed values within 95% CI

```{R include=FALSE}

# Calculate 95% CI
LT10.CIUpper <- (Sweetheart_all$Model10 + Sweetheart_all$se.fit.10*1.96)
LT10.CILower <- (Sweetheart_all$Model10 - Sweetheart_all$se.fit.10*1.96)
LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
LT10.CI <- as.data.frame(LT10.CI)

LT50.CIUpper <- (Sweetheart_all$Model50 + Sweetheart_all$se.fit.50*1.96)
LT50.CILower <- (Sweetheart_all$Model50 - Sweetheart_all$se.fit.50*1.96)
LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
LT50.CI <- as.data.frame(LT50.CI)

LT90.CIUpper <- (Sweetheart_all$Model90 + Sweetheart_all$se.fit.90*1.96)
LT90.CILower <- (Sweetheart_all$Model90 - Sweetheart_all$se.fit.90*1.96)
LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
LT90.CI <- as.data.frame(LT90.CI)

Sweetheart_all <- cbind(Sweetheart_all, LT10.CI, LT50.CI, LT90.CI)

Sweetheart_allNA <- na.omit(Sweetheart_all)

# LT10
Predict.Sweetheart_allNA_outside <- subset(Sweetheart_allNA, LT10 > LT10.CIUpper | LT10 < LT10.CILower)
Predict.Sweetheart_allNA_outside$CI <- "outside"
Predict.Sweetheart_allNA_inside <- subset(Sweetheart_allNA, LT10 < LT10.CIUpper & LT10 > LT10.CILower)
Predict.Sweetheart_allNA_inside$CI <- "inside"
Predict.Sweetheart_allNA <- rbind(Predict.Sweetheart_allNA_outside, Predict.Sweetheart_allNA_inside)
table(Predict.Sweetheart_allNA$CI)

# LT50
Predict.Sweetheart_allNA_outside <- subset(Sweetheart_allNA, LT50 > LT50.CIUpper | LT50 < LT50.CILower)
Predict.Sweetheart_allNA_outside$CI <- "outside"
Predict.Sweetheart_allNA_inside <- subset(Sweetheart_allNA, LT50 < LT50.CIUpper & LT50 > LT50.CILower)
Predict.Sweetheart_allNA_inside$CI <- "inside"
Predict.Sweetheart_allNA <- rbind(Predict.Sweetheart_allNA_outside, Predict.Sweetheart_allNA_inside)
table(Predict.Sweetheart_allNA$CI)

# LT90
Predict.Sweetheart_allNA_outside <- subset(Sweetheart_allNA, LT90 > LT90.CIUpper | LT90 < LT90.CILower)
Predict.Sweetheart_allNA_outside$CI <- "outside"
Predict.Sweetheart_allNA_inside <- subset(Sweetheart_allNA, LT90 < LT90.CIUpper & LT90 > LT90.CILower)
Predict.Sweetheart_allNA_inside$CI <- "inside"
Predict.Sweetheart_allNA <- rbind(Predict.Sweetheart_allNA_outside, Predict.Sweetheart_allNA_inside)
table(Predict.Sweetheart_allNA$CI)
```

***
# 13.0 Full Model Validation

```{R, echo=FALSE}
# Import data
Bud_damage <- read.csv(file='Bud_damage.csv')
Bud_damage <- subset(Bud_damage, Treatment == "Control" | Treatment == "Red")
Bud_damage$Date <- as.Date(Bud_damage$Date)
Bud_damageM <- subset(Bud_damage, Site == "Martens")
Bud_damageSa <- subset(Bud_damage, Site == "Savanna")
Bud_damageSl <- subset(Bud_damage, Site == "Slater")


# C <- read.csv(file='Coldstream_Temp_CUFU_CH.csv')
# B <- read.csv(file='Belgo_Temp_CUFU_CH.csv')
Sa <- read.csv(file='Savanna_final_CUFU_LT_2023.csv')
M <- read.csv(file='Martens_final_CUFU_LT_2023.csv')
Sl <- read.csv(file='Slater_final_CUFU_LT_2023.csv')
Other <- read.csv(file='OtherVarieties_final_CUFU_LT_2023.csv')

# C$Date <- as.Date(C$Date)
# B$Date <- as.Date(B$Date)
Sa$Date <- as.Date(Sa$Date)
M$Date <- as.Date(M$Date)
Sl$Date <- as.Date(Sl$Date)
Other$Date <- as.Date(Other$Date)

Staccato <- subset(Other, Variety == "Staccato")
Staccato$Sweetheart_cherry_forcingBB_final.05 <- 0
Staccato$Sweetheart_cherry_forcingBB_final <- ifelse(Staccato$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Staccato$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Staccato$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Staccato$Sweetheart_cherry_forcingBB_final_log <- log(Staccato$Sweetheart_cherry_forcingBB_final + 10)


Staccato.1 <- subset(Staccato, Sweetheart_cherry_forcingBB_final < 30)
Staccato.2 <- subset(Staccato, Sweetheart_cherry_forcingBB_final >= 30)


Sonata <- subset(Other, Variety == "Sonata")
Sonata$Sweetheart_cherry_forcingBB_final.05 <- 0
Sonata$Sweetheart_cherry_forcingBB_final <- ifelse(Sonata$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Sonata$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Sonata$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Sonata$Sweetheart_cherry_forcingBB_final_log <- log(Sonata$Sweetheart_cherry_forcingBB_final + 10)

Sonata.1 <- subset(Sonata, Sweetheart_cherry_forcingBB_final < 30)
Sonata.2 <- subset(Sonata, Sweetheart_cherry_forcingBB_final >= 30)

Skeena <- subset(Other, Variety == "Skeena")
Skeena$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena$Sweetheart_cherry_forcingBB_final_log <- log(Skeena$Sweetheart_cherry_forcingBB_final + 10)

Skeena.1 <- subset(Skeena, Sweetheart_cherry_forcingBB_final < 30)
Skeena.2 <- subset(Skeena, Sweetheart_cherry_forcingBB_final >= 30)

Skeena1.Gi3 <- subset(Other, Variety == "Skeena.Gi3")
Skeena1.Gi3$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena1.Gi3$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena1.Gi3$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena1.Gi3$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena1.Gi3$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena1.Gi3$Sweetheart_cherry_forcingBB_final_log <- log(Skeena1.Gi3$Sweetheart_cherry_forcingBB_final + 10)

Skeena.Gi3.1 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final < 30)
Skeena.Gi3.2 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final >= 30)

Skeena1.Gi5 <- subset(Other, Variety == "Skeena.Gi5")
Skeena1.Gi5$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena1.Gi5$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena1.Gi5$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena1.Gi5$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena1.Gi5$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena1.Gi5$Sweetheart_cherry_forcingBB_final_log <- log(Skeena1.Gi5$Sweetheart_cherry_forcingBB_final + 10)

Skeena.Gi5.1 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final < 30)
Skeena.Gi5.2 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final >= 30)

Skeena1.Gi6 <- subset(Other, Variety == "Skeena.Gi6")
Skeena1.Gi6$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena1.Gi6$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena1.Gi6$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena1.Gi6$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena1.Gi6$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena1.Gi6$Sweetheart_cherry_forcingBB_final_log <- log(Skeena1.Gi6$Sweetheart_cherry_forcingBB_final + 10)


Skeena.Gi6.1 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final < 30)
Skeena.Gi6.2 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final >= 30)



# # Assign new FU (less weight to values under 10)
# # C$Sweetheart_cherry_forcingBB_final.05 <- C$Sweetheart_cherry_forcingBB_final/4
# C$Sweetheart_cherry_forcingBB_final.05 <- 0
# C$Sweetheart_cherry_forcingBB_final <- ifelse(C$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
#                                                           C$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
#                                                           C$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
# C$Sweetheart_cherry_forcingBB_final_log <- log(C$Sweetheart_cherry_forcingBB_final + 10)
# 
# 
# # B$Sweetheart_cherry_forcingBB_final.05 <- B$Sweetheart_cherry_forcingBB_final/4
# B$Sweetheart_cherry_forcingBB_final.05 <- 0
# B$Sweetheart_cherry_forcingBB_final <- ifelse(B$cherry_model_accumulated <= 2000, # if forcing units less than or equal to 5
#                                                           B$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
#                                                           B$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
# B$Sweetheart_cherry_forcingBB_final_log <- log(B$Sweetheart_cherry_forcingBB_final + 10)

# Sa$Sweetheart_cherry_forcingBB_final.05 <- Sa$Sweetheart_cherry_forcingBB_final/4
Sa$Sweetheart_cherry_forcingBB_final.05 <- 0
Sa$Sweetheart_cherry_forcingBB_final <- ifelse(Sa$cherry_model_accumulated <= 2000, # if forcing units less than or equal to 5
                                                          Sa$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Sa$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Sa$Sweetheart_cherry_forcingBB_final_log <- log(Sa$Sweetheart_cherry_forcingBB_final + 10)

# M$Sweetheart_cherry_forcingBB_final.05 <- M$Sweetheart_cherry_forcingBB_final/4
M$Sweetheart_cherry_forcingBB_final.05 <- 0
M$Sweetheart_cherry_forcingBB_final <- ifelse(M$cherry_model_accumulated <= 2000, # if forcing units less than or equal to 5
                                                          M$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          M$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
M$Sweetheart_cherry_forcingBB_final_log <- log(M$Sweetheart_cherry_forcingBB_final + 10)

# Sl$Sweetheart_cherry_forcingBB_final.05 <- Sl$Sweetheart_cherry_forcingBB_final/4
Sl$Sweetheart_cherry_forcingBB_final.05 <- 0
Sl$Sweetheart_cherry_forcingBB_final <- ifelse(Sl$cherry_model_accumulated <= 2000, # if forcing units less than or equal to 5
                                                          Sl$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Sl$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Sl$Sweetheart_cherry_forcingBB_final_log <- log(Sl$Sweetheart_cherry_forcingBB_final + 10)


# 
# # Seperate each site by season
# C1 <- subset(C, Date >= "2019-09-15" & Date <= "2020-04-30")
# C2 <- subset(C, Date >= "2020-09-15" & Date <= "2021-04-30")
# C3 <- subset(C, Date >= "2021-09-15" & Date <= "2022-04-30")
# C1.1 <- subset(C1, Sweetheart_cherry_forcingBB_final < 30)
# C1.2 <- subset(C1, Sweetheart_cherry_forcingBB_final >= 30)
# C2.1 <- subset(C2, Sweetheart_cherry_forcingBB_final < 30)
# C2.2 <- subset(C2, Sweetheart_cherry_forcingBB_final >= 30)
# C3.1 <- subset(C3, Sweetheart_cherry_forcingBB_final < 30)
# C3.2 <- subset(C3, Sweetheart_cherry_forcingBB_final >= 30)
# 
# B1 <- subset(B, Date >= "2019-09-15" & Date <= "2020-04-30")
# B2 <- subset(B, Date >= "2020-09-15" & Date <= "2021-04-30")
# B3 <- subset(B, Date >= "2021-09-15" & Date <= "2022-04-30")
# B1.1 <- subset(B1, Sweetheart_cherry_forcingBB_final < 30)
# B1.2 <- subset(B1, Sweetheart_cherry_forcingBB_final >= 30)
# B2.1 <- subset(B2, Sweetheart_cherry_forcingBB_final < 30)
# B2.2 <- subset(B2, Sweetheart_cherry_forcingBB_final >= 30)
# B3.1 <- subset(B3, Sweetheart_cherry_forcingBB_final < 30)
# B3.2 <- subset(B3, Sweetheart_cherry_forcingBB_final >= 30)

Sa1 <- subset(Sa, Date >= "2019-09-15" & Date <= "2020-04-30")
Sa2 <- subset(Sa, Date >= "2020-09-15" & Date <= "2021-04-30")
# a few weird data points that you are going to omit in season 2 for Savanna:
Sa2 <- subset(Sa, Date != "2021-03-09")
Sa2 <- subset(Sa2, Date != "2021-03-16")

Sa2.Mar9.21 <- subset(Sa, Date == "2021-03-09")
Sa2.Mar9.21$LT10 <- NA
Sa2.Mar9.21$LT50 <- NA
Sa2.Mar9.21$LT90 <- NA

Sa2.Mar16.21 <- subset(Sa, Date == "2021-03-16")
Sa2.Mar16.21$LT10 <- NA
Sa2.Mar16.21$LT50 <- NA
Sa2.Mar16.21$LT90 <- NA

Sa2 <- rbind(Sa2, Sa2.Mar9.21, Sa2.Mar16.21)

# sort by date
Sa2 <- Sa2[order(as.Date(Sa2$Date, format="%Y-%m-%d")),]
Sa2 <- subset(Sa2, Date >= "2020-09-15" & Date <= "2021-04-30")

Sa3 <- subset(Sa, Date >= "2021-09-15" & Date <= "2022-04-30")
Sa1.1 <- subset(Sa1, Sweetheart_cherry_forcingBB_final < 30)
Sa1.2 <- subset(Sa1, Sweetheart_cherry_forcingBB_final >= 30)
Sa2.1 <- subset(Sa2, Sweetheart_cherry_forcingBB_final < 30)
Sa2.2 <- subset(Sa2, Sweetheart_cherry_forcingBB_final >= 30)
Sa3.1 <- subset(Sa3, Sweetheart_cherry_forcingBB_final < 30)
Sa3.2 <- subset(Sa3, Sweetheart_cherry_forcingBB_final >= 30)

M1 <- subset(M, Date >= "2019-09-15" & Date <= "2020-04-30")
M2 <- subset(M, Date >= "2020-09-15" & Date <= "2021-04-30")
M3 <- subset(M, Date >= "2021-09-15" & Date <= "2022-04-30")
M1.1 <- subset(M1, Sweetheart_cherry_forcingBB_final < 30)
M1.2 <- subset(M1, Sweetheart_cherry_forcingBB_final >= 30)
M2.1 <- subset(M2, Sweetheart_cherry_forcingBB_final < 30)
M2.2 <- subset(M2, Sweetheart_cherry_forcingBB_final >= 30)
M3.1 <- subset(M3, Sweetheart_cherry_forcingBB_final < 30)
M3.2 <- subset(M3, Sweetheart_cherry_forcingBB_final >= 30)

Sl1 <- subset(Sl, Date >= "2019-09-15" & Date <= "2020-04-30")
Sl2 <- subset(Sl, Date >= "2020-09-15" & Date <= "2021-04-30")
Sl3 <- subset(Sl, Date >= "2021-09-15" & Date <= "2022-04-30")
Sl1.1 <- subset(Sl1, Sweetheart_cherry_forcingBB_final < 30)
Sl1.2 <- subset(Sl1, Sweetheart_cherry_forcingBB_final >= 30)
Sl2.1 <- subset(Sl2, Sweetheart_cherry_forcingBB_final < 30)
Sl2.2 <- subset(Sl2, Sweetheart_cherry_forcingBB_final >= 30)
Sl3.1 <- subset(Sl3, Sweetheart_cherry_forcingBB_final < 30)
Sl3.2 <- subset(Sl3, Sweetheart_cherry_forcingBB_final >= 30)

# pull in your sweetheart models as well:
load("Model10_Sweetheart1.RData")
load("Model10_Sweetheart2.RData")

load("Model50_Sweetheart1.RData")
load("Model50_Sweetheart2.RData")

load("Model90_Sweetheart1.RData")
load("Model90_Sweetheart2.RData")


```

```{r, echo=FALSE}
# ### COLDSTREAM
# ## Season 1
# # Coldstream LT10 Season 1 Model 1
# PredictLT10_C1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = C1.1, se= TRUE))
#     PredictLT10_C1.1$LT10.CIUpper <- (PredictLT10_C1.1$fit + PredictLT10_C1.1$se.fit*1.96)
#     PredictLT10_C1.1$LT10.CILower <- (PredictLT10_C1.1$fit - PredictLT10_C1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_C1.1$Date <- C1.1$Date
#     # rename fit to LT50
#     PredictLT10_C1.1 <- PredictLT10_C1.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_C1.1 <- PredictLT10_C1.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_C1.1$Colour = "black"
#     
# # Coldstream LT10 Season 1 Model 2
# PredictLT10_C1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = C1.2, se= TRUE))
#     PredictLT10_C1.2$LT10.CIUpper <- (PredictLT10_C1.2$fit + PredictLT10_C1.2$se.fit*1.96)
#     PredictLT10_C1.2$LT10.CILower <- (PredictLT10_C1.2$fit - PredictLT10_C1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_C1.2$Date <- C1.2$Date
#     # rename fit to LT50
#     PredictLT10_C1.2 <- PredictLT10_C1.2 %>%
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_C1.2 <- PredictLT10_C1.2 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_C1.2$Colour = "mediumblue"
# 
# 
# PredictLT10_C1 <- rbind(PredictLT10_C1.1, PredictLT10_C1.2)
# 
# 
# # Coldstream LT50 Season 1 Model 1
# PredictLT50_C1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = C1.1, se= TRUE))
#     PredictLT50_C1.1$LT50.CIUpper <- (PredictLT50_C1.1$fit + PredictLT50_C1.1$se.fit*1.96)
#     PredictLT50_C1.1$LT50.CILower <- (PredictLT50_C1.1$fit - PredictLT50_C1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_C1.1$Date <- C1.1$Date
#     # rename fit to LT50
#     PredictLT50_C1.1 <- PredictLT50_C1.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_C1.1 <- PredictLT50_C1.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_C1.1$Colour = "black"
#     
# # Coldstream LT50 Season 1 Model 2
# PredictLT50_C1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = C1.2, se= TRUE))
#     PredictLT50_C1.2$LT50.CIUpper <- (PredictLT50_C1.2$fit + PredictLT50_C1.2$se.fit*1.96)
#     PredictLT50_C1.2$LT50.CILower <- (PredictLT50_C1.2$fit - PredictLT50_C1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_C1.2$Date <- C1.2$Date
#     # rename fit to LT50
#     PredictLT50_C1.2 <- PredictLT50_C1.2 %>%
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_C1.2 <- PredictLT50_C1.2 %>%
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_C1.2$Colour = "mediumblue"
# 
# PredictLT50_C1 <- rbind(PredictLT50_C1.1, PredictLT50_C1.2)
#     
#     
#     # Coldstream LT90 Season 1 Model 1
# PredictLT90_C1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = C1.1, se= TRUE))
#     PredictLT90_C1.1$LT90.CIUpper <- (PredictLT90_C1.1$fit + PredictLT90_C1.1$se.fit*1.96)
#     PredictLT90_C1.1$LT90.CILower <- (PredictLT90_C1.1$fit - PredictLT90_C1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_C1.1$Date <- C1.1$Date
#     # rename fit to LT50
#     PredictLT90_C1.1 <- PredictLT90_C1.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_C1.1 <- PredictLT90_C1.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_C1.1$Colour = "black"
#     
# # Coldstream LT90 Season 1 Model 2
# PredictLT90_C1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = C1.2, se= TRUE))
#     PredictLT90_C1.2$LT90.CIUpper <- (PredictLT90_C1.2$fit + PredictLT90_C1.2$se.fit*1.96)
#     PredictLT90_C1.2$LT90.CILower <- (PredictLT90_C1.2$fit - PredictLT90_C1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_C1.2$Date <- C1.2$Date
#     # rename fit to LT50
#     PredictLT90_C1.2 <- PredictLT90_C1.2 %>%
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_C1.2 <- PredictLT90_C1.2 %>%
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_C1.2$Colour = "mediumblue"
# 
# 
# PredictLT90_C1 <- rbind(PredictLT90_C1.1, PredictLT90_C1.2)
# 
# 
# ## Season 2
# # Coldstream LT10 Season 2 Model 1
# PredictLT10_C2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = C2.1, se= TRUE))
#     PredictLT10_C2.1$LT10.CIUpper <- (PredictLT10_C2.1$fit + PredictLT10_C2.1$se.fit*1.96)
#     PredictLT10_C2.1$LT10.CILower <- (PredictLT10_C2.1$fit - PredictLT10_C2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_C2.1$Date <- C2.1$Date
#     # rename fit to LT50
#     PredictLT10_C2.1 <- PredictLT10_C2.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_C2.1 <- PredictLT10_C2.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_C2.1$Colour = "black"
#     
# # Coldstream LT10 Season 2 Model 2
#     
# PredictLT10_C2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = C2.2, se= TRUE))
#     PredictLT10_C2.2$LT10.CIUpper <- (PredictLT10_C2.2$fit + PredictLT10_C2.2$se.fit*1.96)
#     PredictLT10_C2.2$LT10.CILower <- (PredictLT10_C2.2$fit - PredictLT10_C2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_C2.2$Date <- C2.2$Date
#     # rename fit to LT50
#     PredictLT10_C2.2 <- PredictLT10_C2.2 %>%
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_C2.2 <- PredictLT10_C2.2 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_C2.2$Colour = "mediumblue"
# 
# 
# PredictLT10_C2 <- rbind(PredictLT10_C2.1, PredictLT10_C2.2)
# 
# # Coldstream LT50 Season 2 Model 1
# PredictLT50_C2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = C2.1, se= TRUE))
#     PredictLT50_C2.1$LT50.CIUpper <- (PredictLT50_C2.1$fit + PredictLT50_C2.1$se.fit*1.96)
#     PredictLT50_C2.1$LT50.CILower <- (PredictLT50_C2.1$fit - PredictLT50_C2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_C2.1$Date <- C2.1$Date
#     # rename fit to LT50
#     PredictLT50_C2.1 <- PredictLT50_C2.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_C2.1 <- PredictLT50_C2.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_C2.1$Colour = "black"
#     
# # Coldstream LT50 Season 2 Model 2
# PredictLT50_C2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = C2.2, se= TRUE))
#     PredictLT50_C2.2$LT50.CIUpper <- (PredictLT50_C2.2$fit + PredictLT50_C2.2$se.fit*1.96)
#     PredictLT50_C2.2$LT50.CILower <- (PredictLT50_C2.2$fit - PredictLT50_C2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_C2.2$Date <- C2.2$Date
#     # rename fit to LT50
#     PredictLT50_C2.2 <- PredictLT50_C2.2 %>%
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_C2.2 <- PredictLT50_C2.2 %>%
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_C2.2$Colour = "mediumblue"
# 
# PredictLT50_C2 <- rbind(PredictLT50_C2.1, PredictLT50_C2.2)
#     
#     
#     # Coldstream LT90 Season 2 Model 1
# PredictLT90_C2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = C2.1, se= TRUE))
#     PredictLT90_C2.1$LT90.CIUpper <- (PredictLT90_C2.1$fit + PredictLT90_C2.1$se.fit*1.96)
#     PredictLT90_C2.1$LT90.CILower <- (PredictLT90_C2.1$fit - PredictLT90_C2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_C2.1$Date <- C2.1$Date
#     # rename fit to LT50
#     PredictLT90_C2.1 <- PredictLT90_C2.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_C2.1 <- PredictLT90_C2.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_C2.1$Colour = "black"
#     
# # Coldstream LT90 Season 2 Model 2
# PredictLT90_C2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = C2.2, se= TRUE))
#     PredictLT90_C2.2$LT90.CIUpper <- (PredictLT90_C2.2$fit + PredictLT90_C2.2$se.fit*1.96)
#     PredictLT90_C2.2$LT90.CILower <- (PredictLT90_C2.2$fit - PredictLT90_C2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_C2.2$Date <- C2.2$Date
#     # rename fit to LT50
#     PredictLT90_C2.2 <- PredictLT90_C2.2 %>%
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_C2.2 <- PredictLT90_C2.2 %>%
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_C2.2$Colour = "mediumblue"
# 
# 
# PredictLT90_C2 <- rbind(PredictLT90_C2.1, PredictLT90_C2.2)
#     
# 
# ## Season 3
# # Coldstream LT10 Season 3 Model 1
# PredictLT10_C3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = C3.1, se= TRUE))
#     PredictLT10_C3.1$LT10.CIUpper <- (PredictLT10_C3.1$fit + PredictLT10_C3.1$se.fit*1.96)
#     PredictLT10_C3.1$LT10.CILower <- (PredictLT10_C3.1$fit - PredictLT10_C3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_C3.1$Date <- C3.1$Date
#     # rename fit to LT50
#     PredictLT10_C3.1 <- PredictLT10_C3.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_C3.1 <- PredictLT10_C3.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_C3.1$Colour = "black"
#     
# # Coldstream LT10 Season 3 Model 2
# PredictLT10_C3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = C3.2, se= TRUE))
#     PredictLT10_C3.2$LT10.CIUpper <- (PredictLT10_C3.2$fit + PredictLT10_C3.2$se.fit*1.96)
#     PredictLT10_C3.2$LT10.CILower <- (PredictLT10_C3.2$fit - PredictLT10_C3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_C3.2$Date <- C3.2$Date
#     # rename fit to LT50
#     PredictLT10_C3.2 <- PredictLT10_C3.2 %>%
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_C3.2 <- PredictLT10_C3.2 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_C3.2$Colour = "mediumblue"
# 
# 
# PredictLT10_C3 <- rbind(PredictLT10_C3.1, PredictLT10_C3.2)
# 
# 
# # Coldstream LT50 Season 3 Model 1
# PredictLT50_C3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = C3.1, se= TRUE))
#     PredictLT50_C3.1$LT50.CIUpper <- (PredictLT50_C3.1$fit + PredictLT50_C3.1$se.fit*1.96)
#     PredictLT50_C3.1$LT50.CILower <- (PredictLT50_C3.1$fit - PredictLT50_C3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_C3.1$Date <- C3.1$Date
#     # rename fit to LT50
#     PredictLT50_C3.1 <- PredictLT50_C3.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_C3.1 <- PredictLT50_C3.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_C3.1$Colour = "black"
#     
# # Coldstream LT50 Season 3 Model 2
# PredictLT50_C3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = C3.2, se= TRUE))
#     PredictLT50_C3.2$LT50.CIUpper <- (PredictLT50_C3.2$fit + PredictLT50_C3.2$se.fit*1.96)
#     PredictLT50_C3.2$LT50.CILower <- (PredictLT50_C3.2$fit - PredictLT50_C3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_C3.2$Date <- C3.2$Date
#     # rename fit to LT50
#     PredictLT50_C3.2 <- PredictLT50_C3.2 %>%
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_C3.2 <- PredictLT50_C3.2 %>%
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_C3.2$Colour = "mediumblue"
# 
# PredictLT50_C3 <- rbind(PredictLT50_C3.1, PredictLT50_C3.2)
# 
#     
#     # Coldstream LT90 Season 3 Model 1
# PredictLT90_C3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = C3.1, se= TRUE))
#     PredictLT90_C3.1$LT90.CIUpper <- (PredictLT90_C3.1$fit + PredictLT90_C3.1$se.fit*1.96)
#     PredictLT90_C3.1$LT90.CILower <- (PredictLT90_C3.1$fit - PredictLT90_C3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_C3.1$Date <- C3.1$Date
#     # rename fit to LT50
#     PredictLT90_C3.1 <- PredictLT90_C3.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_C3.1 <- PredictLT90_C3.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_C3.1$Colour = "black"
#     
# # Coldstream LT90 Season 3 Model 2
# PredictLT90_C3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = C3.2, se= TRUE))
#     PredictLT90_C3.2$LT90.CIUpper <- (PredictLT90_C3.2$fit + PredictLT90_C3.2$se.fit*1.96)
#     PredictLT90_C3.2$LT90.CILower <- (PredictLT90_C3.2$fit - PredictLT90_C3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_C3.2$Date <- C3.2$Date
#     # rename fit to LT50
#     PredictLT90_C3.2 <- PredictLT90_C3.2 %>%
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_C3.2 <- PredictLT90_C3.2 %>%
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_C3.2$Colour = "mediumblue"
# 
# 
# PredictLT90_C3 <- rbind(PredictLT90_C3.1, PredictLT90_C3.2)
# 
# 
# # Season 1
# 
# plot(C1$Date, C1$LT10,
#          main= "LT10 Model Validation: Coldstream 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_C1.1$Date, rev(PredictLT10_C1.1$Date)), c(PredictLT10_C1.1$LT10.CILower, rev(PredictLT10_C1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_C1.2$Date, rev(PredictLT10_C1.2$Date)), c(PredictLT10_C1.2$LT10.CILower, rev(PredictLT10_C1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_C1.1$Date, PredictLT10_C1.1$LT10, lty = 1, lwd=1, col = PredictLT10_C1.1$Colour)
#     lines(PredictLT10_C1.2$Date, PredictLT10_C1.2$LT10, lty = 1, lwd=1, col = PredictLT10_C1.2$Colour)
#     
#     
# plot(C1$Date, C1$LT50,
#          main= "LT50 Model Validation: Coldstream 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_C1.1$Date, rev(PredictLT50_C1.1$Date)), c(PredictLT50_C1.1$LT50.CILower, rev(PredictLT50_C1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_C1.2$Date, rev(PredictLT50_C1.2$Date)), c(PredictLT50_C1.2$LT50.CILower, rev(PredictLT50_C1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_C1.1$Date, PredictLT50_C1.1$LT50, lty = 1, lwd=1, col = PredictLT50_C1.1$Colour)
#     lines(PredictLT50_C1.2$Date, PredictLT50_C1.2$LT50, lty = 1, lwd=1, col = PredictLT50_C1.2$Colour)
#     
#     
# plot(C1$Date, C1$LT90,
#          main= "LT90 Model Validation: Coldstream 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_C1.1$Date, rev(PredictLT90_C1.1$Date)), c(PredictLT90_C1.1$LT90.CILower, rev(PredictLT90_C1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_C1.2$Date, rev(PredictLT90_C1.2$Date)), c(PredictLT90_C1.2$LT90.CILower, rev(PredictLT90_C1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_C1.1$Date, PredictLT90_C1.1$LT90, lty = 1, lwd=1, col = PredictLT90_C1.1$Colour)
#     lines(PredictLT90_C1.2$Date, PredictLT90_C1.2$LT90, lty = 1, lwd=1, col = PredictLT90_C1.2$Colour)
#     
#     
# # Season 2
#     
# plot(C2$Date, C2$LT10,
#          main= "LT10 Model Validation: Coldstream 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_C2.1$Date, rev(PredictLT10_C2.1$Date)), c(PredictLT10_C2.1$LT10.CILower, rev(PredictLT10_C2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_C2.2$Date, rev(PredictLT10_C2.2$Date)), c(PredictLT10_C2.2$LT10.CILower, rev(PredictLT10_C2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_C2.1$Date, PredictLT10_C2.1$LT10, lty = 1, lwd=1, col = PredictLT10_C2.1$Colour)
#     lines(PredictLT10_C2.2$Date, PredictLT10_C2.2$LT10, lty = 1, lwd=1, col = PredictLT10_C2.2$Colour)
#     
#     
# plot(C2$Date, C2$LT50,
#          main= "LT50 Model Validation: Coldstream 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_C2.1$Date, rev(PredictLT50_C2.1$Date)), c(PredictLT50_C2.1$LT50.CILower, rev(PredictLT50_C2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_C2.2$Date, rev(PredictLT50_C2.2$Date)), c(PredictLT50_C2.2$LT50.CILower, rev(PredictLT50_C2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_C2.1$Date, PredictLT50_C2.1$LT50, lty = 1, lwd=1, col = PredictLT50_C2.1$Colour)
#     lines(PredictLT50_C2.2$Date, PredictLT50_C2.2$LT50, lty = 1, lwd=1, col = PredictLT50_C2.2$Colour)
#     
#     
# plot(C2$Date, C2$LT90,
#          main= "LT90 Model Validation: Coldstream 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_C2.1$Date, rev(PredictLT90_C2.1$Date)), c(PredictLT90_C2.1$LT90.CILower, rev(PredictLT90_C2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_C2.2$Date, rev(PredictLT90_C2.2$Date)), c(PredictLT90_C2.2$LT90.CILower, rev(PredictLT90_C2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_C2.1$Date, PredictLT90_C2.1$LT90, lty = 1, lwd=1, col = PredictLT90_C2.1$Colour)
#     lines(PredictLT90_C2.2$Date, PredictLT90_C2.2$LT90, lty = 1, lwd=1, col = PredictLT90_C2.2$Colour)
#     
# # Season 3
#     
# plot(C3$Date, C3$LT10,
#          main= "LT10 Model Validation: Coldstream 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_C3.1$Date, rev(PredictLT10_C3.1$Date)), c(PredictLT10_C3.1$LT10.CILower, rev(PredictLT10_C3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_C3.2$Date, rev(PredictLT10_C3.2$Date)), c(PredictLT10_C3.2$LT10.CILower, rev(PredictLT10_C3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_C3.1$Date, PredictLT10_C3.1$LT10, lty = 1, lwd=1, col = PredictLT10_C3.1$Colour)
#     lines(PredictLT10_C3.2$Date, PredictLT10_C3.2$LT10, lty = 1, lwd=1, col = PredictLT10_C3.2$Colour)
#     
#     
# plot(C3$Date, C3$LT50,
#          main= "LT50 Model Validation: Coldstream 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_C3.1$Date, rev(PredictLT50_C3.1$Date)), c(PredictLT50_C3.1$LT50.CILower, rev(PredictLT50_C3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_C3.2$Date, rev(PredictLT50_C3.2$Date)), c(PredictLT50_C3.2$LT50.CILower, rev(PredictLT50_C3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_C3.1$Date, PredictLT50_C3.1$LT50, lty = 1, lwd=1, col = PredictLT50_C3.1$Colour)
#     lines(PredictLT50_C3.2$Date, PredictLT50_C3.2$LT50, lty = 1, lwd=1, col = PredictLT50_C3.2$Colour)
#     
#     
# plot(C3$Date, C3$LT90,
#          main= "LT90 Model Validation: Coldstream 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_C3.1$Date, rev(PredictLT90_C3.1$Date)), c(PredictLT90_C3.1$LT90.CILower, rev(PredictLT90_C3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_C3.2$Date, rev(PredictLT90_C3.2$Date)), c(PredictLT90_C3.2$LT90.CILower, rev(PredictLT90_C3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_C3.1$Date, PredictLT90_C3.1$LT90, lty = 1, lwd=1, col = PredictLT90_C3.1$Colour)
#     lines(PredictLT90_C3.2$Date, PredictLT90_C3.2$LT90, lty = 1, lwd=1, col = PredictLT90_C3.2$Colour)
```
```{r, echo=FALSE}
# # BELGO
# ## Season 1
# # Belgo LT10 Season 1 Model 1
# PredictLT10_B1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = B1.1, se= TRUE))
#     PredictLT10_B1.1$LT10.CIUpper <- (PredictLT10_B1.1$fit + PredictLT10_B1.1$se.fit*1.96)
#     PredictLT10_B1.1$LT10.CILower <- (PredictLT10_B1.1$fit - PredictLT10_B1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_B1.1$Date <- B1.1$Date
#     # rename fit to LT50
#     PredictLT10_B1.1 <- PredictLT10_B1.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_B1.1 <- PredictLT10_B1.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_B1.1$Colour = "black"
#     
# # Belgo LT10 Season 1 Model 2
# PredictLT10_B1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = B1.2, se= TRUE))
#     PredictLT10_B1.2$LT10.CIUpper <- (PredictLT10_B1.2$fit + PredictLT10_B1.2$se.fit*1.96)
#     PredictLT10_B1.2$LT10.CILower <- (PredictLT10_B1.2$fit - PredictLT10_B1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_B1.2$Date <- B1.2$Date
#     # rename fit to LT50
#     PredictLT10_B1.2 <- PredictLT10_B1.2 %>%
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_B1.2 <- PredictLT10_B1.2 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_B1.2$Colour = "mediumblue"
# 
# 
# PredictLT10_B1 <- rbind(PredictLT10_B1.1, PredictLT10_B1.2)
# 
# 
# # Belgo LT50 Season 1 Model 1
# PredictLT50_B1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = B1.1, se= TRUE))
#     PredictLT50_B1.1$LT50.CIUpper <- (PredictLT50_B1.1$fit + PredictLT50_B1.1$se.fit*1.96)
#     PredictLT50_B1.1$LT50.CILower <- (PredictLT50_B1.1$fit - PredictLT50_B1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_B1.1$Date <- B1.1$Date
#     # rename fit to LT50
#     PredictLT50_B1.1 <- PredictLT50_B1.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_B1.1 <- PredictLT50_B1.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_B1.1$Colour = "black"
#     
# # Belgo LT50 Season 1 Model 2
# PredictLT50_B1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = B1.2, se= TRUE))
#     PredictLT50_B1.2$LT50.CIUpper <- (PredictLT50_B1.2$fit + PredictLT50_B1.2$se.fit*1.96)
#     PredictLT50_B1.2$LT50.CILower <- (PredictLT50_B1.2$fit - PredictLT50_B1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_B1.2$Date <- B1.2$Date
#     # rename fit to LT50
#     PredictLT50_B1.2 <- PredictLT50_B1.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_B1.2 <- PredictLT50_B1.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_B1.2$Colour = "mediumblue"
#     
# PredictLT50_B1 <- rbind(PredictLT50_B1.1, PredictLT50_B1.2)
#     
#     # Belgo LT90 Season 1 Model 1
# PredictLT90_B1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = B1.1, se= TRUE))
#     PredictLT90_B1.1$LT90.CIUpper <- (PredictLT90_B1.1$fit + PredictLT90_B1.1$se.fit*1.96)
#     PredictLT90_B1.1$LT90.CILower <- (PredictLT90_B1.1$fit - PredictLT90_B1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_B1.1$Date <- B1.1$Date
#     # rename fit to LT50
#     PredictLT90_B1.1 <- PredictLT90_B1.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_B1.1 <- PredictLT90_B1.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_B1.1$Colour = "black"
#     
# # Belgo LT90 Season 1 Model 2
# PredictLT90_B1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = B1.2, se= TRUE))
#     PredictLT90_B1.2$LT90.CIUpper <- (PredictLT90_B1.2$fit + PredictLT90_B1.2$se.fit*1.96)
#     PredictLT90_B1.2$LT90.CILower <- (PredictLT90_B1.2$fit - PredictLT90_B1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_B1.2$Date <- B1.2$Date
#     # rename fit to LT50
#     PredictLT90_B1.2 <- PredictLT90_B1.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_B1.2 <- PredictLT90_B1.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_B1.2$Colour = "mediumblue"
#     
#     
# PredictLT90_B1 <- rbind(PredictLT90_B1.1, PredictLT90_B1.2)
# 
# 
# ## Season 2
# # Belgo LT10 Season 2 Model 1
# PredictLT10_B2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = B2.1, se= TRUE))
#     PredictLT10_B2.1$LT10.CIUpper <- (PredictLT10_B2.1$fit + PredictLT10_B2.1$se.fit*1.96)
#     PredictLT10_B2.1$LT10.CILower <- (PredictLT10_B2.1$fit - PredictLT10_B2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_B2.1$Date <- B2.1$Date
#     # rename fit to LT50
#     PredictLT10_B2.1 <- PredictLT10_B2.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_B2.1 <- PredictLT10_B2.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_B2.1$Colour = "black"
#     
# # Belgo LT10 Season 2 Model 2
# PredictLT10_B2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = B2.2, se= TRUE))
#     PredictLT10_B2.2$LT10.CIUpper <- (PredictLT10_B2.2$fit + PredictLT10_B2.2$se.fit*1.96)
#     PredictLT10_B2.2$LT10.CILower <- (PredictLT10_B2.2$fit - PredictLT10_B2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_B2.2$Date <- B2.2$Date
#     # rename fit to LT50
#     PredictLT10_B2.2 <- PredictLT10_B2.2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_B2.2 <- PredictLT10_B2.2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_B2.2$Colour = "mediumblue"
#     
#     
# PredictLT10_B2 <- rbind(PredictLT10_B2.1, PredictLT10_B2.2)
# 
# 
# # Belgo LT50 Season 2 Model 1
# PredictLT50_B2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = B2.1, se= TRUE))
#     PredictLT50_B2.1$LT50.CIUpper <- (PredictLT50_B2.1$fit + PredictLT50_B2.1$se.fit*1.96)
#     PredictLT50_B2.1$LT50.CILower <- (PredictLT50_B2.1$fit - PredictLT50_B2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_B2.1$Date <- B2.1$Date
#     # rename fit to LT50
#     PredictLT50_B2.1 <- PredictLT50_B2.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_B2.1 <- PredictLT50_B2.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_B2.1$Colour = "black"
#     
# # Belgo LT50 Season 2 Model 2
# PredictLT50_B2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = B2.2, se= TRUE))
#     PredictLT50_B2.2$LT50.CIUpper <- (PredictLT50_B2.2$fit + PredictLT50_B2.2$se.fit*1.96)
#     PredictLT50_B2.2$LT50.CILower <- (PredictLT50_B2.2$fit - PredictLT50_B2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_B2.2$Date <- B2.2$Date
#     # rename fit to LT50
#     PredictLT50_B2.2 <- PredictLT50_B2.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_B2.2 <- PredictLT50_B2.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_B2.2$Colour = "mediumblue"
#     
# PredictLT50_B2 <- rbind(PredictLT50_B2.1, PredictLT50_B2.2)
#     
#     # Belgo LT90 Season 2 Model 1
# PredictLT90_B2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = B2.1, se= TRUE))
#     PredictLT90_B2.1$LT90.CIUpper <- (PredictLT90_B2.1$fit + PredictLT90_B2.1$se.fit*1.96)
#     PredictLT90_B2.1$LT90.CILower <- (PredictLT90_B2.1$fit - PredictLT90_B2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_B2.1$Date <- B2.1$Date
#     # rename fit to LT50
#     PredictLT90_B2.1 <- PredictLT90_B2.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_B2.1 <- PredictLT90_B2.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_B2.1$Colour = "black"
#     
# # Belgo LT90 Season 2 Model 2
# PredictLT90_B2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = B2.2, se= TRUE))
#     PredictLT90_B2.2$LT90.CIUpper <- (PredictLT90_B2.2$fit + PredictLT90_B2.2$se.fit*1.96)
#     PredictLT90_B2.2$LT90.CILower <- (PredictLT90_B2.2$fit - PredictLT90_B2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_B2.2$Date <- B2.2$Date
#     # rename fit to LT50
#     PredictLT90_B2.2 <- PredictLT90_B2.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_B2.2 <- PredictLT90_B2.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_B2.2$Colour = "mediumblue"
#     
#     
# PredictLT90_B2 <- rbind(PredictLT90_B2.1, PredictLT90_B2.2)
# 
# ## Season 3
# # Belgo LT10 Season 3 Model 1
# PredictLT10_B3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = B3.1, se= TRUE))
#     PredictLT10_B3.1$LT10.CIUpper <- (PredictLT10_B3.1$fit + PredictLT10_B3.1$se.fit*1.96)
#     PredictLT10_B3.1$LT10.CILower <- (PredictLT10_B3.1$fit - PredictLT10_B3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_B3.1$Date <- B3.1$Date
#     # rename fit to LT50
#     PredictLT10_B3.1 <- PredictLT10_B3.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_B3.1 <- PredictLT10_B3.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_B3.1$Colour = "black"
#     
# # Belgo LT10 Season 3 Model 2
# PredictLT10_B3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = B3.2, se= TRUE))
#     PredictLT10_B3.2$LT10.CIUpper <- (PredictLT10_B3.2$fit + PredictLT10_B3.2$se.fit*1.96)
#     PredictLT10_B3.2$LT10.CILower <- (PredictLT10_B3.2$fit - PredictLT10_B3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_B3.2$Date <- B3.2$Date
#     # rename fit to LT50
#     PredictLT10_B3.2 <- PredictLT10_B3.2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_B3.2 <- PredictLT10_B3.2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_B3.2$Colour = "mediumblue"
#     
#     
# PredictLT10_B3 <- rbind(PredictLT10_B3.1, PredictLT10_B3.2)
# 
# 
# # Belgo LT50 Season 3 Model 1
# PredictLT50_B3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = B3.1, se= TRUE))
#     PredictLT50_B3.1$LT50.CIUpper <- (PredictLT50_B3.1$fit + PredictLT50_B3.1$se.fit*1.96)
#     PredictLT50_B3.1$LT50.CILower <- (PredictLT50_B3.1$fit - PredictLT50_B3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_B3.1$Date <- B3.1$Date
#     # rename fit to LT50
#     PredictLT50_B3.1 <- PredictLT50_B3.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_B3.1 <- PredictLT50_B3.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_B3.1$Colour = "black"
#     
# # Belgo LT50 Season 3 Model 2
# PredictLT50_B3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = B3.2, se= TRUE))
#     PredictLT50_B3.2$LT50.CIUpper <- (PredictLT50_B3.2$fit + PredictLT50_B3.2$se.fit*1.96)
#     PredictLT50_B3.2$LT50.CILower <- (PredictLT50_B3.2$fit - PredictLT50_B3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_B3.2$Date <- B3.2$Date
#     # rename fit to LT50
#     PredictLT50_B3.2 <- PredictLT50_B3.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_B3.2 <- PredictLT50_B3.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_B3.2$Colour = "mediumblue"
#     
# PredictLT50_B3 <- rbind(PredictLT50_B3.1, PredictLT50_B3.2)
#     
#     # Belgo LT90 Season 3 Model 1
# PredictLT90_B3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = B3.1, se= TRUE))
#     PredictLT90_B3.1$LT90.CIUpper <- (PredictLT90_B3.1$fit + PredictLT90_B3.1$se.fit*1.96)
#     PredictLT90_B3.1$LT90.CILower <- (PredictLT90_B3.1$fit - PredictLT90_B3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_B3.1$Date <- B3.1$Date
#     # rename fit to LT50
#     PredictLT90_B3.1 <- PredictLT90_B3.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_B3.1 <- PredictLT90_B3.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_B3.1$Colour = "black"
#     
# # Belgo LT90 Season 3 Model 2
# PredictLT90_B3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = B3.2, se= TRUE))
#     PredictLT90_B3.2$LT90.CIUpper <- (PredictLT90_B3.2$fit + PredictLT90_B3.2$se.fit*1.96)
#     PredictLT90_B3.2$LT90.CILower <- (PredictLT90_B3.2$fit - PredictLT90_B3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_B3.2$Date <- B3.2$Date
#     # rename fit to LT50
#     PredictLT90_B3.2 <- PredictLT90_B3.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_B3.2 <- PredictLT90_B3.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_B3.2$Colour = "mediumblue"
#     
#     
# PredictLT90_B3 <- rbind(PredictLT90_B3.1, PredictLT90_B3.2)
# 
# 
# 
# # Season 1
# 
# plot(B1$Date, B1$LT10,
#          main= "LT10 Model Validation: Belgo 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_B1.1$Date, rev(PredictLT10_B1.1$Date)), c(PredictLT10_B1.1$LT10.CILower, rev(PredictLT10_B1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_B1.2$Date, rev(PredictLT10_B1.2$Date)), c(PredictLT10_B1.2$LT10.CILower, rev(PredictLT10_B1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_B1.1$Date, PredictLT10_B1.1$LT10, lty = 1, lwd=1, col = PredictLT10_B1.1$Colour)
#     lines(PredictLT10_B1.2$Date, PredictLT10_B1.2$LT10, lty = 1, lwd=1, col = PredictLT10_B1.2$Colour)
#     
#     
# plot(B1$Date, B1$LT50,
#          main= "LT50 Model Validation: Belgo 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_B1.1$Date, rev(PredictLT50_B1.1$Date)), c(PredictLT50_B1.1$LT50.CILower, rev(PredictLT50_B1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_B1.2$Date, rev(PredictLT50_B1.2$Date)), c(PredictLT50_B1.2$LT50.CILower, rev(PredictLT50_B1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_B1.1$Date, PredictLT50_B1.1$LT50, lty = 1, lwd=1, col = PredictLT50_B1.1$Colour)
#     lines(PredictLT50_B1.2$Date, PredictLT50_B1.2$LT50, lty = 1, lwd=1, col = PredictLT50_B1.2$Colour)
#     
#     
# plot(B1$Date, B1$LT90,
#          main= "LT90 Model Validation: Belgo 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_B1.1$Date, rev(PredictLT90_B1.1$Date)), c(PredictLT90_B1.1$LT90.CILower, rev(PredictLT90_B1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_B1.2$Date, rev(PredictLT90_B1.2$Date)), c(PredictLT90_B1.2$LT90.CILower, rev(PredictLT90_B1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_B1.1$Date, PredictLT90_B1.1$LT90, lty = 1, lwd=1, col = PredictLT90_B1.1$Colour)
#     lines(PredictLT90_B1.2$Date, PredictLT90_B1.2$LT90, lty = 1, lwd=1, col = PredictLT90_B1.2$Colour)
#     
#     
# # Season 2
#     
# plot(B2$Date, B2$LT10,
#          main= "LT10 Model Validation: Belgo 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_B2.1$Date, rev(PredictLT10_B2.1$Date)), c(PredictLT10_B2.1$LT10.CILower, rev(PredictLT10_B2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_B2.2$Date, rev(PredictLT10_B2.2$Date)), c(PredictLT10_B2.2$LT10.CILower, rev(PredictLT10_B2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_B2.1$Date, PredictLT10_B2.1$LT10, lty = 1, lwd=1, col = PredictLT10_B2.1$Colour)
#     lines(PredictLT10_B2.2$Date, PredictLT10_B2.2$LT10, lty = 1, lwd=1, col = PredictLT10_B2.2$Colour)
#     
#     
# plot(B2$Date, B2$LT50,
#          main= "LT50 Model Validation: Belgo 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_B2.1$Date, rev(PredictLT50_B2.1$Date)), c(PredictLT50_B2.1$LT50.CILower, rev(PredictLT50_B2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_B2.2$Date, rev(PredictLT50_B2.2$Date)), c(PredictLT50_B2.2$LT50.CILower, rev(PredictLT50_B2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_B2.1$Date, PredictLT50_B2.1$LT50, lty = 1, lwd=1, col = PredictLT50_B2.1$Colour)
#     lines(PredictLT50_B2.2$Date, PredictLT50_B2.2$LT50, lty = 1, lwd=1, col = PredictLT50_B2.2$Colour)
#     
#     
# plot(B2$Date, B2$LT90,
#          main= "LT90 Model Validation: Belgo 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_B2.1$Date, rev(PredictLT90_B2.1$Date)), c(PredictLT90_B2.1$LT90.CILower, rev(PredictLT90_B2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_B2.2$Date, rev(PredictLT90_B2.2$Date)), c(PredictLT90_B2.2$LT90.CILower, rev(PredictLT90_B2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_B2.1$Date, PredictLT90_B2.1$LT90, lty = 1, lwd=1, col = PredictLT90_B2.1$Colour)
#     lines(PredictLT90_B2.2$Date, PredictLT90_B2.2$LT90, lty = 1, lwd=1, col = PredictLT90_B2.2$Colour)
#     
# # Season 3
#     
# plot(B3$Date, B3$LT10,
#          main= "LT10 Model Validation: Belgo 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_B3.1$Date, rev(PredictLT10_B3.1$Date)), c(PredictLT10_B3.1$LT10.CILower, rev(PredictLT10_B3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_B3.2$Date, rev(PredictLT10_B3.2$Date)), c(PredictLT10_B3.2$LT10.CILower, rev(PredictLT10_B3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_B3.1$Date, PredictLT10_B3.1$LT10, lty = 1, lwd=1, col = PredictLT10_B3.1$Colour)
#     lines(PredictLT10_B3.2$Date, PredictLT10_B3.2$LT10, lty = 1, lwd=1, col = PredictLT10_B3.2$Colour)
#     
#     
# plot(B3$Date, B3$LT50,
#          main= "LT50 Model Validation: Belgo 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_B3.1$Date, rev(PredictLT50_B3.1$Date)), c(PredictLT50_B3.1$LT50.CILower, rev(PredictLT50_B3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_B3.2$Date, rev(PredictLT50_B3.2$Date)), c(PredictLT50_B3.2$LT50.CILower, rev(PredictLT50_B3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_B3.1$Date, PredictLT50_B3.1$LT50, lty = 1, lwd=1, col = PredictLT50_B3.1$Colour)
#     lines(PredictLT50_B3.2$Date, PredictLT50_B3.2$LT50, lty = 1, lwd=1, col = PredictLT50_B3.2$Colour)
#     
#     
# plot(B3$Date, B3$LT90,
#          main= "LT90 Model Validation: Belgo 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_B3.1$Date, rev(PredictLT90_B3.1$Date)), c(PredictLT90_B3.1$LT90.CILower, rev(PredictLT90_B3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_B3.2$Date, rev(PredictLT90_B3.2$Date)), c(PredictLT90_B3.2$LT90.CILower, rev(PredictLT90_B3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_B3.1$Date, PredictLT90_B3.1$LT90, lty = 1, lwd=1, col = PredictLT90_B3.1$Colour)
#     lines(PredictLT90_B3.2$Date, PredictLT90_B3.2$LT90, lty = 1, lwd=1, col = PredictLT90_B3.2$Colour)
```
***
## 13.1 Validation: Mid-Elevation Site
```{r, echo=FALSE, out.width="30%"}
# ## Season 1
# # Martens LT10 Season 1 Model 1
# PredictLT10_M1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = M1.1, se= TRUE))
#     PredictLT10_M1.1$LT10.CIUpper <- (PredictLT10_M1.1$fit + PredictLT10_M1.1$se.fit*1.96)
#     PredictLT10_M1.1$LT10.CILower <- (PredictLT10_M1.1$fit - PredictLT10_M1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_M1.1$Date <- M1.1$Date
#     # rename fit to LT50
#     PredictLT10_M1.1 <- PredictLT10_M1.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_M1.1 <- PredictLT10_M1.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_M1.1$Colour = "black"
#     
# # Martens LT10 Season 1 Model 2
# PredictLT10_M1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = M1.2, se= TRUE))
#     PredictLT10_M1.2$LT10.CIUpper <- (PredictLT10_M1.2$fit + PredictLT10_M1.2$se.fit*1.96)
#     PredictLT10_M1.2$LT10.CILower <- (PredictLT10_M1.2$fit - PredictLT10_M1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_M1.2$Date <- M1.2$Date
#     # rename fit to LT50
#     PredictLT10_M1.2 <- PredictLT10_M1.2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_M1.2 <- PredictLT10_M1.2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_M1.2$Colour = "mediumblue"
#     
#     
# PredictLT10_M1 <- rbind(PredictLT10_M1.1, PredictLT10_M1.2)
# 
# 
# # Martens LT50 Season 1 Model 1
# PredictLT50_M1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = M1.1, se= TRUE))
#     PredictLT50_M1.1$LT50.CIUpper <- (PredictLT50_M1.1$fit + PredictLT50_M1.1$se.fit*1.96)
#     PredictLT50_M1.1$LT50.CILower <- (PredictLT50_M1.1$fit - PredictLT50_M1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_M1.1$Date <- M1.1$Date
#     # rename fit to LT50
#     PredictLT50_M1.1 <- PredictLT50_M1.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_M1.1 <- PredictLT50_M1.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_M1.1$Colour = "black"
#     
# # Martens LT50 Season 1 Model 2
# PredictLT50_M1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = M1.2, se= TRUE))
#     PredictLT50_M1.2$LT50.CIUpper <- (PredictLT50_M1.2$fit + PredictLT50_M1.2$se.fit*1.96)
#     PredictLT50_M1.2$LT50.CILower <- (PredictLT50_M1.2$fit - PredictLT50_M1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_M1.2$Date <- M1.2$Date
#     # rename fit to LT50
#     PredictLT50_M1.2 <- PredictLT50_M1.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_M1.2 <- PredictLT50_M1.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_M1.2$Colour = "mediumblue"
#     
# PredictLT50_M1 <- rbind(PredictLT50_M1.1, PredictLT50_M1.2)
#     
#     # Martens LT90 Season 1 Model 1
# PredictLT90_M1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = M1.1, se= TRUE))
#     PredictLT90_M1.1$LT90.CIUpper <- (PredictLT90_M1.1$fit + PredictLT90_M1.1$se.fit*1.96)
#     PredictLT90_M1.1$LT90.CILower <- (PredictLT90_M1.1$fit - PredictLT90_M1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_M1.1$Date <- M1.1$Date
#     # rename fit to LT50
#     PredictLT90_M1.1 <- PredictLT90_M1.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_M1.1 <- PredictLT90_M1.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_M1.1$Colour = "black"
#     
# # Martens LT90 Season 1 Model 2
# PredictLT90_M1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = M1.2, se= TRUE))
#     PredictLT90_M1.2$LT90.CIUpper <- (PredictLT90_M1.2$fit + PredictLT90_M1.2$se.fit*1.96)
#     PredictLT90_M1.2$LT90.CILower <- (PredictLT90_M1.2$fit - PredictLT90_M1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_M1.2$Date <- M1.2$Date
#     # rename fit to LT50
#     PredictLT90_M1.2 <- PredictLT90_M1.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_M1.2 <- PredictLT90_M1.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_M1.2$Colour = "mediumblue"
#     
#     
# PredictLT90_M1 <- rbind(PredictLT90_M1.1, PredictLT90_M1.2)
# 

## Season 2
# Martens LT10 Season 2 Model 1
PredictLT10_M2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = M2.1, se= TRUE))
    PredictLT10_M2.1$LT10.CIUpper <- (PredictLT10_M2.1$fit + PredictLT10_M2.1$se.fit*1.96)
    PredictLT10_M2.1$LT10.CILower <- (PredictLT10_M2.1$fit - PredictLT10_M2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M2.1$Date <- M2.1$Date
    # rename fit to LT50
    PredictLT10_M2.1 <- PredictLT10_M2.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_M2.1 <- PredictLT10_M2.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M2.1$Colour = "black"
    
# Martens LT10 Season 2 Model 2
PredictLT10_M2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = M2.2, se= TRUE))
    PredictLT10_M2.2$LT10.CIUpper <- (PredictLT10_M2.2$fit + PredictLT10_M2.2$se.fit*1.96)
    PredictLT10_M2.2$LT10.CILower <- (PredictLT10_M2.2$fit - PredictLT10_M2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M2.2$Date <- M2.2$Date
    # rename fit to LT50
    PredictLT10_M2.2 <- PredictLT10_M2.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_M2.2 <- PredictLT10_M2.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M2.2$Colour = "mediumblue"
    
    
PredictLT10_M2 <- rbind(PredictLT10_M2.1, PredictLT10_M2.2)


# Martens LT50 Season 2 Model 1
PredictLT50_M2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = M2.1, se= TRUE))
    PredictLT50_M2.1$LT50.CIUpper <- (PredictLT50_M2.1$fit + PredictLT50_M2.1$se.fit*1.96)
    PredictLT50_M2.1$LT50.CILower <- (PredictLT50_M2.1$fit - PredictLT50_M2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M2.1$Date <- M2.1$Date
    # rename fit to LT50
    PredictLT50_M2.1 <- PredictLT50_M2.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_M2.1 <- PredictLT50_M2.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M2.1$Colour = "black"
    
# Martens LT50 Season 2 Model 2
PredictLT50_M2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = M2.2, se= TRUE))
    PredictLT50_M2.2$LT50.CIUpper <- (PredictLT50_M2.2$fit + PredictLT50_M2.2$se.fit*1.96)
    PredictLT50_M2.2$LT50.CILower <- (PredictLT50_M2.2$fit - PredictLT50_M2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M2.2$Date <- M2.2$Date
    # rename fit to LT50
    PredictLT50_M2.2 <- PredictLT50_M2.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_M2.2 <- PredictLT50_M2.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M2.2$Colour = "mediumblue"
    
PredictLT50_M2 <- rbind(PredictLT50_M2.1, PredictLT50_M2.2)
    
    # Martens LT90 Season 2 Model 1
PredictLT90_M2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = M2.1, se= TRUE))
    PredictLT90_M2.1$LT90.CIUpper <- (PredictLT90_M2.1$fit + PredictLT90_M2.1$se.fit*1.96)
    PredictLT90_M2.1$LT90.CILower <- (PredictLT90_M2.1$fit - PredictLT90_M2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M2.1$Date <- M2.1$Date
    # rename fit to LT50
    PredictLT90_M2.1 <- PredictLT90_M2.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_M2.1 <- PredictLT90_M2.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M2.1$Colour = "black"
    
# Martens LT90 Season 2 Model 2
PredictLT90_M2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = M2.2, se= TRUE))
    PredictLT90_M2.2$LT90.CIUpper <- (PredictLT90_M2.2$fit + PredictLT90_M2.2$se.fit*1.96)
    PredictLT90_M2.2$LT90.CILower <- (PredictLT90_M2.2$fit - PredictLT90_M2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M2.2$Date <- M2.2$Date
    # rename fit to LT50
    PredictLT90_M2.2 <- PredictLT90_M2.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_M2.2 <- PredictLT90_M2.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M2.2$Colour = "mediumblue"
    
    
PredictLT90_M2 <- rbind(PredictLT90_M2.1, PredictLT90_M2.2)

# ## Season 3
# # Martens LT10 Season 3 Model 1
# PredictLT10_M3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = M3.1, se= TRUE))
#     PredictLT10_M3.1$LT10.CIUpper <- (PredictLT10_M3.1$fit + PredictLT10_M3.1$se.fit*1.96)
#     PredictLT10_M3.1$LT10.CILower <- (PredictLT10_M3.1$fit - PredictLT10_M3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_M3.1$Date <- M3.1$Date
#     # rename fit to LT50
#     PredictLT10_M3.1 <- PredictLT10_M3.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_M3.1 <- PredictLT10_M3.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_M3.1$Colour = "black"
#     
# # Martens LT10 Season 3 Model 2
# PredictLT10_M3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = M3.2, se= TRUE))
#     PredictLT10_M3.2$LT10.CIUpper <- (PredictLT10_M3.2$fit + PredictLT10_M3.2$se.fit*1.96)
#     PredictLT10_M3.2$LT10.CILower <- (PredictLT10_M3.2$fit - PredictLT10_M3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_M3.2$Date <- M3.2$Date
#     # rename fit to LT50
#     PredictLT10_M3.2 <- PredictLT10_M3.2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_M3.2 <- PredictLT10_M3.2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_M3.2$Colour = "mediumblue"
#     
#     
# PredictLT10_M3 <- rbind(PredictLT10_M3.1, PredictLT10_M3.2)
# 
# 
# # Martens LT50 Season 3 Model 1
# PredictLT50_M3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = M3.1, se= TRUE))
#     PredictLT50_M3.1$LT50.CIUpper <- (PredictLT50_M3.1$fit + PredictLT50_M3.1$se.fit*1.96)
#     PredictLT50_M3.1$LT50.CILower <- (PredictLT50_M3.1$fit - PredictLT50_M3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_M3.1$Date <- M3.1$Date
#     # rename fit to LT50
#     PredictLT50_M3.1 <- PredictLT50_M3.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_M3.1 <- PredictLT50_M3.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_M3.1$Colour = "black"
#     
# # Martens LT50 Season 3 Model 2
# PredictLT50_M3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = M3.2, se= TRUE))
#     PredictLT50_M3.2$LT50.CIUpper <- (PredictLT50_M3.2$fit + PredictLT50_M3.2$se.fit*1.96)
#     PredictLT50_M3.2$LT50.CILower <- (PredictLT50_M3.2$fit - PredictLT50_M3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_M3.2$Date <- M3.2$Date
#     # rename fit to LT50
#     PredictLT50_M3.2 <- PredictLT50_M3.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_M3.2 <- PredictLT50_M3.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_M3.2$Colour = "mediumblue"
#     
# PredictLT50_M3 <- rbind(PredictLT50_M3.1, PredictLT50_M3.2)
#     
#     # Martens LT90 Season 3 Model 1
# PredictLT90_M3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = M3.1, se= TRUE))
#     PredictLT90_M3.1$LT90.CIUpper <- (PredictLT90_M3.1$fit + PredictLT90_M3.1$se.fit*1.96)
#     PredictLT90_M3.1$LT90.CILower <- (PredictLT90_M3.1$fit - PredictLT90_M3.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_M3.1$Date <- M3.1$Date
#     # rename fit to LT50
#     PredictLT90_M3.1 <- PredictLT90_M3.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_M3.1 <- PredictLT90_M3.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_M3.1$Colour = "black"
#     
# # Martens LT90 Season 3 Model 2
# PredictLT90_M3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = M3.2, se= TRUE))
#     PredictLT90_M3.2$LT90.CIUpper <- (PredictLT90_M3.2$fit + PredictLT90_M3.2$se.fit*1.96)
#     PredictLT90_M3.2$LT90.CILower <- (PredictLT90_M3.2$fit - PredictLT90_M3.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_M3.2$Date <- M3.2$Date
#     # rename fit to LT50
#     PredictLT90_M3.2 <- PredictLT90_M3.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_M3.2 <- PredictLT90_M3.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_M3.2$Colour = "mediumblue"
#     
#     
# PredictLT90_M3 <- rbind(PredictLT90_M3.1, PredictLT90_M3.2)



# # Season 1
# 
# plot(M1$Date, M1$LT10,
#          main= "LT10 Model Validation: Martens 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_M1.1$Date, rev(PredictLT10_M1.1$Date)), c(PredictLT10_M1.1$LT10.CILower, rev(PredictLT10_M1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_M1.2$Date, rev(PredictLT10_M1.2$Date)), c(PredictLT10_M1.2$LT10.CILower, rev(PredictLT10_M1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_M1.1$Date, PredictLT10_M1.1$LT10, lty = 1, lwd=1, col = PredictLT10_M1.1$Colour)
#     lines(PredictLT10_M1.2$Date, PredictLT10_M1.2$LT10, lty = 1, lwd=1, col = PredictLT10_M1.2$Colour)
#     
#     
# plot(M1$Date, M1$LT50,
#          main= "LT50 Model Validation: Martens 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_M1.1$Date, rev(PredictLT50_M1.1$Date)), c(PredictLT50_M1.1$LT50.CILower, rev(PredictLT50_M1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_M1.2$Date, rev(PredictLT50_M1.2$Date)), c(PredictLT50_M1.2$LT50.CILower, rev(PredictLT50_M1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_M1.1$Date, PredictLT50_M1.1$LT50, lty = 1, lwd=1, col = PredictLT50_M1.1$Colour)
#     lines(PredictLT50_M1.2$Date, PredictLT50_M1.2$LT50, lty = 1, lwd=1, col = PredictLT50_M1.2$Colour)
#     
#     
# plot(M1$Date, M1$LT90,
#          main= "LT90 Model Validation: Martens 2019-2020",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2019-09-01", "2020-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_M1.1$Date, rev(PredictLT90_M1.1$Date)), c(PredictLT90_M1.1$LT90.CILower, rev(PredictLT90_M1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_M1.2$Date, rev(PredictLT90_M1.2$Date)), c(PredictLT90_M1.2$LT90.CILower, rev(PredictLT90_M1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_M1.1$Date, PredictLT90_M1.1$LT90, lty = 1, lwd=1, col = PredictLT90_M1.1$Colour)
#     lines(PredictLT90_M1.2$Date, PredictLT90_M1.2$LT90, lty = 1, lwd=1, col = PredictLT90_M1.2$Colour)
#     
#     
# Season 2
    
plot(M2$Date, M2$LT10,
         main= "LT10 Model Validation: Mid-Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_M2.1$Date, rev(PredictLT10_M2.1$Date)), c(PredictLT10_M2.1$LT10.CILower, rev(PredictLT10_M2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_M2.2$Date, rev(PredictLT10_M2.2$Date)), c(PredictLT10_M2.2$LT10.CILower, rev(PredictLT10_M2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_M2.1$Date, PredictLT10_M2.1$LT10, lty = 1, lwd=1, col = PredictLT10_M2.1$Colour)
    lines(PredictLT10_M2.2$Date, PredictLT10_M2.2$LT10, lty = 1, lwd=1, col = PredictLT10_M2.2$Colour)
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.75, col = 'red4')
        abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "0.3%", cex= 0.5)
    
plot(M2$Date, M2$LT50,
         main= "LT50 Model Validation: Mid-Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_M2.1$Date, rev(PredictLT50_M2.1$Date)), c(PredictLT50_M2.1$LT50.CILower, rev(PredictLT50_M2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M2.2$Date, rev(PredictLT50_M2.2$Date)), c(PredictLT50_M2.2$LT50.CILower, rev(PredictLT50_M2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M2.1$Date, PredictLT50_M2.1$LT50, lty = 1, lwd=1, col = PredictLT50_M2.1$Colour)
    lines(PredictLT50_M2.2$Date, PredictLT50_M2.2$LT50, lty = 1, lwd=1, col = PredictLT50_M2.2$Colour)
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
               abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "0.3%", cex= 0.5)
    
# without additional lines for min temp/damage    
plot(M2$Date, M2$LT50,
         main= "Sweetheart LT50 Model Validation: Mid-Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_M2.1$Date, rev(PredictLT50_M2.1$Date)), c(PredictLT50_M2.1$LT50.CILower, rev(PredictLT50_M2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M2.2$Date, rev(PredictLT50_M2.2$Date)), c(PredictLT50_M2.2$LT50.CILower, rev(PredictLT50_M2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M2.1$Date, PredictLT50_M2.1$LT50, lty = 1, lwd=1, col = PredictLT50_M2.1$Colour)
    lines(PredictLT50_M2.2$Date, PredictLT50_M2.2$LT50, lty = 1, lwd=1, col = PredictLT50_M2.2$Colour)

    
    
    
plot(M2$Date, M2$LT90,
         main= "LT90 Model Validation: Mid-Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_M2.1$Date, rev(PredictLT90_M2.1$Date)), c(PredictLT90_M2.1$LT90.CILower, rev(PredictLT90_M2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_M2.2$Date, rev(PredictLT90_M2.2$Date)), c(PredictLT90_M2.2$LT90.CILower, rev(PredictLT90_M2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_M2.1$Date, PredictLT90_M2.1$LT90, lty = 1, lwd=1, col = PredictLT90_M2.1$Colour)
    lines(PredictLT90_M2.2$Date, PredictLT90_M2.2$LT90, lty = 1, lwd=1, col = PredictLT90_M2.2$Colour)
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.75, col = 'red4')
    abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "0.3%", cex= 0.5)
  
# # Season 3
#     
# plot(M3$Date, M3$LT10,
#          main= "LT10 Model Validation: Martens 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_M3.1$Date, rev(PredictLT10_M3.1$Date)), c(PredictLT10_M3.1$LT10.CILower, rev(PredictLT10_M3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_M3.2$Date, rev(PredictLT10_M3.2$Date)), c(PredictLT10_M3.2$LT10.CILower, rev(PredictLT10_M3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_M3.1$Date, PredictLT10_M3.1$LT10, lty = 1, lwd=1, col = PredictLT10_M3.1$Colour)
#     lines(PredictLT10_M3.2$Date, PredictLT10_M3.2$LT10, lty = 1, lwd=1, col = PredictLT10_M3.2$Colour)
#     
#     
# plot(M3$Date, M3$LT50,
#          main= "LT50 Model Validation: Martens 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_M3.1$Date, rev(PredictLT50_M3.1$Date)), c(PredictLT50_M3.1$LT50.CILower, rev(PredictLT50_M3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_M3.2$Date, rev(PredictLT50_M3.2$Date)), c(PredictLT50_M3.2$LT50.CILower, rev(PredictLT50_M3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_M3.1$Date, PredictLT50_M3.1$LT50, lty = 1, lwd=1, col = PredictLT50_M3.1$Colour)
#     lines(PredictLT50_M3.2$Date, PredictLT50_M3.2$LT50, lty = 1, lwd=1, col = PredictLT50_M3.2$Colour)
#     
#     
# plot(M3$Date, M3$LT90,
#          main= "LT90 Model Validation: Martens 2021-2022",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2021-09-01", "2022-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_M3.1$Date, rev(PredictLT90_M3.1$Date)), c(PredictLT90_M3.1$LT90.CILower, rev(PredictLT90_M3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_M3.2$Date, rev(PredictLT90_M3.2$Date)), c(PredictLT90_M3.2$LT90.CILower, rev(PredictLT90_M3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_M3.1$Date, PredictLT90_M3.1$LT90, lty = 1, lwd=1, col = PredictLT90_M3.1$Colour)
#     lines(PredictLT90_M3.2$Date, PredictLT90_M3.2$LT90, lty = 1, lwd=1, col = PredictLT90_M3.2$Colour)
    

    
    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.M2 <- as.data.frame(predict(Model10.m, newdata= M2.1, se= TRUE))
Model10.m_Predict.M2 <- Model10.m_Predict.M2 %>% dplyr::rename("Model10.m_Predict.M2"="fit")
Model10.m_Predict.M2 <- Model10.m_Predict.M2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.M2 <- as.data.frame(predict(Model50.m, newdata= M2.1, se= TRUE))
Model50.m_Predict.M2 <- Model50.m_Predict.M2 %>% dplyr::rename("Model50.m_Predict.M2"="fit")
Model50.m_Predict.M2 <- Model50.m_Predict.M2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.M2 <- as.data.frame(predict(Model90.m, newdata= M2.1, se= TRUE))
Model90.m_Predict.M2 <- Model90.m_Predict.M2 %>% dplyr::rename("Model90.m_Predict.M2"="fit")
Model90.m_Predict.M2 <- Model90.m_Predict.M2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.M2.1 <- cbind(M2.1, 
                         Model10.m_Predict.M2, 
                         Model50.m_Predict.M2, 
                         Model90.m_Predict.M2)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.M2.2 <- as.data.frame(predict(Model10.m2, newdata= M2.2, se= TRUE))
Model10.m2_Predict.M2.2 <- Model10.m2_Predict.M2.2 %>% dplyr::rename("Model10.m_Predict.M2"="fit")
Model10.m2_Predict.M2.2 <- Model10.m2_Predict.M2.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.M2.2 <- as.data.frame(predict(Model50.m2, newdata= M2.2, se= TRUE))
Model50.m2_Predict.M2.2 <- Model50.m2_Predict.M2.2 %>% dplyr::rename("Model50.m_Predict.M2"="fit")
Model50.m2_Predict.M2.2 <- Model50.m2_Predict.M2.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.M2.2 <- as.data.frame(predict(Model90.m2, newdata= M2.2, se= TRUE))
Model90.m2_Predict.M2.2 <- Model90.m2_Predict.M2.2 %>% dplyr::rename("Model90.m_Predict.M2"="fit")
Model90.m2_Predict.M2.2 <- Model90.m2_Predict.M2.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.M2.2 <- cbind(M2.2, 
                         Model10.m2_Predict.M2.2, 
                         Model50.m2_Predict.M2.2, 
                         Model90.m2_Predict.M2.2)


Predict.M2 <- rbind(Predict.M2.1, Predict.M2.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.M2~ LT10, data=Predict.M2)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.M2~ LT10, data=Predict.M2))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.M2 ~ LT10, data=Predict.M2,
     main="LT10: Mid-Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.M2 ~ LT10, data=Predict.M2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.M2~ LT50, data=Predict.M2)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.M2~ LT50, data=Predict.M2))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.M2 ~ LT50, data=Predict.M2,
     main="LT50: Mid-Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.M2 ~ LT50, data=Predict.M2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.M2~ LT90, data=Predict.M2)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.M2~ LT90, data=Predict.M2))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.M2 ~ LT90, data=Predict.M2,
     main="LT90: Mid-Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.M2 ~ LT90, data=Predict.M2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)







## FOR FACT SHEER


plot(M2$Date, M2$LT50,
         main= "LT50 Model Validation",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-21, -4),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1)
    polygon(c(PredictLT50_M2.1$Date, rev(PredictLT50_M2.1$Date)), c(PredictLT50_M2.1$LT50.CILower, rev(PredictLT50_M2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M2.2$Date, rev(PredictLT50_M2.2$Date)), c(PredictLT50_M2.2$LT50.CILower, rev(PredictLT50_M2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M2.1$Date, PredictLT50_M2.1$LT50, lty = 1, lwd=1, col = PredictLT50_M2.1$Colour)
    lines(PredictLT50_M2.2$Date, PredictLT50_M2.2$LT50, lty = 1, lwd=1, col = PredictLT50_M2.2$Colour)
    
    
    
    
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.75, col = 'red4')
        abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "0.3%", cex= 0.5)
    
    
# for dates where the temp min falls below the predicted LT
subset(PredictLT10_M2.1, Date == "2021-02-09")
subset(PredictLT50_M2.1, Date == "2021-02-09")
subset(PredictLT90_M2.1, Date == "2021-02-09")

subset(PredictLT10_M2.1, Date == "2021-02-11")
subset(PredictLT50_M2.1, Date == "2021-02-11")
subset(PredictLT90_M2.1, Date == "2021-02-11")
    
    
```

***
## 13.2 Validation: High Elevation Site
```{r, echo=FALSE, out.width="30%"}
## Season 1
# Savanna LT10 Season 1 Model 1
PredictLT10_Sa1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Sa1.1, se= TRUE))
    PredictLT10_Sa1.1$LT10.CIUpper <- (PredictLT10_Sa1.1$fit + PredictLT10_Sa1.1$se.fit*1.96)
    PredictLT10_Sa1.1$LT10.CILower <- (PredictLT10_Sa1.1$fit - PredictLT10_Sa1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sa1.1$Date <- Sa1.1$Date
    # rename fit to LT50
    PredictLT10_Sa1.1 <- PredictLT10_Sa1.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Sa1.1 <- PredictLT10_Sa1.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sa1.1$Colour = "black"
    
# Savanna LT10 Season 1 Model 2
PredictLT10_Sa1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Sa1.2, se= TRUE))
    PredictLT10_Sa1.2$LT10.CIUpper <- (PredictLT10_Sa1.2$fit + PredictLT10_Sa1.2$se.fit*1.96)
    PredictLT10_Sa1.2$LT10.CILower <- (PredictLT10_Sa1.2$fit - PredictLT10_Sa1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sa1.2$Date <- Sa1.2$Date
    # rename fit to LT50
    PredictLT10_Sa1.2 <- PredictLT10_Sa1.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_Sa1.2 <- PredictLT10_Sa1.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sa1.2$Colour = "mediumblue"
    
    
PredictLT10_Sa1 <- rbind(PredictLT10_Sa1.1, PredictLT10_Sa1.2)


# Savanna LT50 Season 1 Model 1
PredictLT50_Sa1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Sa1.1, se= TRUE))
    PredictLT50_Sa1.1$LT50.CIUpper <- (PredictLT50_Sa1.1$fit + PredictLT50_Sa1.1$se.fit*1.96)
    PredictLT50_Sa1.1$LT50.CILower <- (PredictLT50_Sa1.1$fit - PredictLT50_Sa1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sa1.1$Date <- Sa1.1$Date
    # rename fit to LT50
    PredictLT50_Sa1.1 <- PredictLT50_Sa1.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Sa1.1 <- PredictLT50_Sa1.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sa1.1$Colour = "black"
    
# Savanna LT50 Season 1 Model 2
PredictLT50_Sa1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Sa1.2, se= TRUE))
    PredictLT50_Sa1.2$LT50.CIUpper <- (PredictLT50_Sa1.2$fit + PredictLT50_Sa1.2$se.fit*1.96)
    PredictLT50_Sa1.2$LT50.CILower <- (PredictLT50_Sa1.2$fit - PredictLT50_Sa1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sa1.2$Date <- Sa1.2$Date
    # rename fit to LT50
    PredictLT50_Sa1.2 <- PredictLT50_Sa1.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_Sa1.2 <- PredictLT50_Sa1.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sa1.2$Colour = "mediumblue"
    
PredictLT50_Sa1 <- rbind(PredictLT50_Sa1.1, PredictLT50_Sa1.2)
    
    # Savanna LT90 Season 1 Model 1
PredictLT90_Sa1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Sa1.1, se= TRUE))
    PredictLT90_Sa1.1$LT90.CIUpper <- (PredictLT90_Sa1.1$fit + PredictLT90_Sa1.1$se.fit*1.96)
    PredictLT90_Sa1.1$LT90.CILower <- (PredictLT90_Sa1.1$fit - PredictLT90_Sa1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sa1.1$Date <- Sa1.1$Date
    # rename fit to LT50
    PredictLT90_Sa1.1 <- PredictLT90_Sa1.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Sa1.1 <- PredictLT90_Sa1.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sa1.1$Colour = "black"
    
# Savanna LT90 Season 1 Model 2
PredictLT90_Sa1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Sa1.2, se= TRUE))
    PredictLT90_Sa1.2$LT90.CIUpper <- (PredictLT90_Sa1.2$fit + PredictLT90_Sa1.2$se.fit*1.96)
    PredictLT90_Sa1.2$LT90.CILower <- (PredictLT90_Sa1.2$fit - PredictLT90_Sa1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sa1.2$Date <- Sa1.2$Date
    # rename fit to LT50
    PredictLT90_Sa1.2 <- PredictLT90_Sa1.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_Sa1.2 <- PredictLT90_Sa1.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sa1.2$Colour = "mediumblue"
    
    
PredictLT90_Sa1 <- rbind(PredictLT90_Sa1.1, PredictLT90_Sa1.2)


## Season 2
# Savanna LT10 Season 2 Model 1
PredictLT10_Sa2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Sa2.1, se= TRUE))
    PredictLT10_Sa2.1$LT10.CIUpper <- (PredictLT10_Sa2.1$fit + PredictLT10_Sa2.1$se.fit*1.96)
    PredictLT10_Sa2.1$LT10.CILower <- (PredictLT10_Sa2.1$fit - PredictLT10_Sa2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sa2.1$Date <- Sa2.1$Date
    # rename fit to LT50
    PredictLT10_Sa2.1 <- PredictLT10_Sa2.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Sa2.1 <- PredictLT10_Sa2.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sa2.1$Colour = "black"
    
# Savanna LT10 Season 2 Model 2
PredictLT10_Sa2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Sa2.2, se= TRUE))
    PredictLT10_Sa2.2$LT10.CIUpper <- (PredictLT10_Sa2.2$fit + PredictLT10_Sa2.2$se.fit*1.96)
    PredictLT10_Sa2.2$LT10.CILower <- (PredictLT10_Sa2.2$fit - PredictLT10_Sa2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sa2.2$Date <- Sa2.2$Date
    # rename fit to LT50
    PredictLT10_Sa2.2 <- PredictLT10_Sa2.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_Sa2.2 <- PredictLT10_Sa2.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sa2.2$Colour = "mediumblue"
    
    
PredictLT10_Sa2 <- rbind(PredictLT10_Sa2.1, PredictLT10_Sa2.2)


# Savanna LT50 Season 2 Model 1
PredictLT50_Sa2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Sa2.1, se= TRUE))
    PredictLT50_Sa2.1$LT50.CIUpper <- (PredictLT50_Sa2.1$fit + PredictLT50_Sa2.1$se.fit*1.96)
    PredictLT50_Sa2.1$LT50.CILower <- (PredictLT50_Sa2.1$fit - PredictLT50_Sa2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sa2.1$Date <- Sa2.1$Date
    # rename fit to LT50
    PredictLT50_Sa2.1 <- PredictLT50_Sa2.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Sa2.1 <- PredictLT50_Sa2.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sa2.1$Colour = "black"
    
# Savanna LT50 Season 2 Model 2
PredictLT50_Sa2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Sa2.2, se= TRUE))
    PredictLT50_Sa2.2$LT50.CIUpper <- (PredictLT50_Sa2.2$fit + PredictLT50_Sa2.2$se.fit*1.96)
    PredictLT50_Sa2.2$LT50.CILower <- (PredictLT50_Sa2.2$fit - PredictLT50_Sa2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sa2.2$Date <- Sa2.2$Date
    # rename fit to LT50
    PredictLT50_Sa2.2 <- PredictLT50_Sa2.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_Sa2.2 <- PredictLT50_Sa2.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sa2.2$Colour = "mediumblue"
    
PredictLT50_Sa2 <- rbind(PredictLT50_Sa2.1, PredictLT50_Sa2.2)
    
    # Savanna LT90 Season 2 Model 1
PredictLT90_Sa2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Sa2.1, se= TRUE))
    PredictLT90_Sa2.1$LT90.CIUpper <- (PredictLT90_Sa2.1$fit + PredictLT90_Sa2.1$se.fit*1.96)
    PredictLT90_Sa2.1$LT90.CILower <- (PredictLT90_Sa2.1$fit - PredictLT90_Sa2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sa2.1$Date <- Sa2.1$Date
    # rename fit to LT50
    PredictLT90_Sa2.1 <- PredictLT90_Sa2.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Sa2.1 <- PredictLT90_Sa2.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sa2.1$Colour = "black"
    
# Savanna LT90 Season 2 Model 2
PredictLT90_Sa2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Sa2.2, se= TRUE))
    PredictLT90_Sa2.2$LT90.CIUpper <- (PredictLT90_Sa2.2$fit + PredictLT90_Sa2.2$se.fit*1.96)
    PredictLT90_Sa2.2$LT90.CILower <- (PredictLT90_Sa2.2$fit - PredictLT90_Sa2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sa2.2$Date <- Sa2.2$Date
    # rename fit to LT50
    PredictLT90_Sa2.2 <- PredictLT90_Sa2.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_Sa2.2 <- PredictLT90_Sa2.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sa2.2$Colour = "mediumblue"
    
    
PredictLT90_Sa2 <- rbind(PredictLT90_Sa2.1, PredictLT90_Sa2.2)

## Season 3
# Savanna LT10 Season 3 Model 1
PredictLT10_Sa3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Sa3.1, se= TRUE))
    PredictLT10_Sa3.1$LT10.CIUpper <- (PredictLT10_Sa3.1$fit + PredictLT10_Sa3.1$se.fit*1.96)
    PredictLT10_Sa3.1$LT10.CILower <- (PredictLT10_Sa3.1$fit - PredictLT10_Sa3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sa3.1$Date <- Sa3.1$Date
    # rename fit to LT50
    PredictLT10_Sa3.1 <- PredictLT10_Sa3.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Sa3.1 <- PredictLT10_Sa3.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sa3.1$Colour = "black"
    
# Savanna LT10 Season 3 Model 2
PredictLT10_Sa3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Sa3.2, se= TRUE))
    PredictLT10_Sa3.2$LT10.CIUpper <- (PredictLT10_Sa3.2$fit + PredictLT10_Sa3.2$se.fit*1.96)
    PredictLT10_Sa3.2$LT10.CILower <- (PredictLT10_Sa3.2$fit - PredictLT10_Sa3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sa3.2$Date <- Sa3.2$Date
    # rename fit to LT50
    PredictLT10_Sa3.2 <- PredictLT10_Sa3.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_Sa3.2 <- PredictLT10_Sa3.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sa3.2$Colour = "mediumblue"
    
    
PredictLT10_Sa3 <- rbind(PredictLT10_Sa3.1, PredictLT10_Sa3.2)


# Savanna LT50 Season 3 Model 1
PredictLT50_Sa3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Sa3.1, se= TRUE))
    PredictLT50_Sa3.1$LT50.CIUpper <- (PredictLT50_Sa3.1$fit + PredictLT50_Sa3.1$se.fit*1.96)
    PredictLT50_Sa3.1$LT50.CILower <- (PredictLT50_Sa3.1$fit - PredictLT50_Sa3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sa3.1$Date <- Sa3.1$Date
    # rename fit to LT50
    PredictLT50_Sa3.1 <- PredictLT50_Sa3.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Sa3.1 <- PredictLT50_Sa3.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sa3.1$Colour = "black"
    
# Savanna LT50 Season 3 Model 2
PredictLT50_Sa3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Sa3.2, se= TRUE))
    PredictLT50_Sa3.2$LT50.CIUpper <- (PredictLT50_Sa3.2$fit + PredictLT50_Sa3.2$se.fit*1.96)
    PredictLT50_Sa3.2$LT50.CILower <- (PredictLT50_Sa3.2$fit - PredictLT50_Sa3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sa3.2$Date <- Sa3.2$Date
    # rename fit to LT50
    PredictLT50_Sa3.2 <- PredictLT50_Sa3.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_Sa3.2 <- PredictLT50_Sa3.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sa3.2$Colour = "mediumblue"
    
PredictLT50_Sa3 <- rbind(PredictLT50_Sa3.1, PredictLT50_Sa3.2)
    
    # Savanna LT90 Season 3 Model 1
PredictLT90_Sa3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Sa3.1, se= TRUE))
    PredictLT90_Sa3.1$LT90.CIUpper <- (PredictLT90_Sa3.1$fit + PredictLT90_Sa3.1$se.fit*1.96)
    PredictLT90_Sa3.1$LT90.CILower <- (PredictLT90_Sa3.1$fit - PredictLT90_Sa3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sa3.1$Date <- Sa3.1$Date
    # rename fit to LT50
    PredictLT90_Sa3.1 <- PredictLT90_Sa3.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Sa3.1 <- PredictLT90_Sa3.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sa3.1$Colour = "black"
    
# Savanna LT90 Season 3 Model 2
PredictLT90_Sa3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Sa3.2, se= TRUE))
    PredictLT90_Sa3.2$LT90.CIUpper <- (PredictLT90_Sa3.2$fit + PredictLT90_Sa3.2$se.fit*1.96)
    PredictLT90_Sa3.2$LT90.CILower <- (PredictLT90_Sa3.2$fit - PredictLT90_Sa3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sa3.2$Date <- Sa3.2$Date
    # rename fit to LT50
    PredictLT90_Sa3.2 <- PredictLT90_Sa3.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_Sa3.2 <- PredictLT90_Sa3.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sa3.2$Colour = "mediumblue"
    
    
PredictLT90_Sa3 <- rbind(PredictLT90_Sa3.1, PredictLT90_Sa3.2)



# Season 1

plot(Sa1$Date, Sa1$LT10,
         main= "LT10 Model Validation: High Elevation 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Sa1.1$Date, rev(PredictLT10_Sa1.1$Date)), c(PredictLT10_Sa1.1$LT10.CILower, rev(PredictLT10_Sa1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sa1.2$Date, rev(PredictLT10_Sa1.2$Date)), c(PredictLT10_Sa1.2$LT10.CILower, rev(PredictLT10_Sa1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sa1.1$Date, PredictLT10_Sa1.1$LT10, lty = 1, lwd=1, col = PredictLT10_Sa1.1$Colour)
    lines(PredictLT10_Sa1.2$Date, PredictLT10_Sa1.2$LT10, lty = 1, lwd=1, col = PredictLT10_Sa1.2$Colour)
    lines(Sa1$Date, Sa1$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2019-12-05'), col="grey80", lty=2)
    text(as.Date('2019-12-05'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-09'), col="grey80", lty=2)
    text(as.Date('2020-01-09'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-13'), col="grey80", lty=2)
    text(as.Date('2020-01-13'), -25, "35%", cex= 0.5)
        abline(v=as.Date('2020-01-21'), col="grey80", lty=2)
    text(as.Date('2020-01-21'), -24, "40%", cex= 0.5)
            abline(v=as.Date('2020-02-05'), col="grey80", lty=2)
    text(as.Date('2020-02-05'), -24, "42%", cex= 0.5)
            abline(v=as.Date('2020-02-25'), col="grey80", lty=2)
    text(as.Date('2020-02-25'), -24, "41%", cex= 0.5)
        abline(v=as.Date('2020-03-02'), col="grey80", lty=2)
    text(as.Date('2020-03-02'), -25, "46%", cex= 0.5)
    
plot(Sa1$Date, Sa1$LT50,
         main= "LT50 Model Validation: High Elevation 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sa1.1$Date, rev(PredictLT50_Sa1.1$Date)), c(PredictLT50_Sa1.1$LT50.CILower, rev(PredictLT50_Sa1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa1.2$Date, rev(PredictLT50_Sa1.2$Date)), c(PredictLT50_Sa1.2$LT50.CILower, rev(PredictLT50_Sa1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa1.1$Date, PredictLT50_Sa1.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sa1.1$Colour)
    lines(PredictLT50_Sa1.2$Date, PredictLT50_Sa1.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sa1.2$Colour)
        lines(Sa1$Date, Sa1$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2019-12-05'), col="grey80", lty=2)
    text(as.Date('2019-12-05'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-09'), col="grey80", lty=2)
    text(as.Date('2020-01-09'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-13'), col="grey80", lty=2)
    text(as.Date('2020-01-13'), -25, "35%", cex= 0.5)
        abline(v=as.Date('2020-01-21'), col="grey80", lty=2)
    text(as.Date('2020-01-21'), -24, "40%", cex= 0.5)
            abline(v=as.Date('2020-02-05'), col="grey80", lty=2)
    text(as.Date('2020-02-05'), -24, "42%", cex= 0.5)
            abline(v=as.Date('2020-02-25'), col="grey80", lty=2)
    text(as.Date('2020-02-25'), -24, "41%", cex= 0.5)
        abline(v=as.Date('2020-03-02'), col="grey80", lty=2)
    text(as.Date('2020-03-02'), -25, "46%", cex= 0.5)
    
# without extra lines  
plot(Sa1$Date, Sa1$LT50,
         main= "LT50 Model Validation: High Elevation 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sa1.1$Date, rev(PredictLT50_Sa1.1$Date)), c(PredictLT50_Sa1.1$LT50.CILower, rev(PredictLT50_Sa1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa1.2$Date, rev(PredictLT50_Sa1.2$Date)), c(PredictLT50_Sa1.2$LT50.CILower, rev(PredictLT50_Sa1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa1.1$Date, PredictLT50_Sa1.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sa1.1$Colour)
    lines(PredictLT50_Sa1.2$Date, PredictLT50_Sa1.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sa1.2$Colour)

    
plot(Sa1$Date, Sa1$LT90,
         main= "LT90 Model Validation: High Elevation 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Sa1.1$Date, rev(PredictLT90_Sa1.1$Date)), c(PredictLT90_Sa1.1$LT90.CILower, rev(PredictLT90_Sa1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sa1.2$Date, rev(PredictLT90_Sa1.2$Date)), c(PredictLT90_Sa1.2$LT90.CILower, rev(PredictLT90_Sa1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sa1.1$Date, PredictLT90_Sa1.1$LT90, lty = 1, lwd=1, col = PredictLT90_Sa1.1$Colour)
    lines(PredictLT90_Sa1.2$Date, PredictLT90_Sa1.2$LT90, lty = 1, lwd=1, col = PredictLT90_Sa1.2$Colour)
        lines(Sa1$Date, Sa1$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2019-12-05'), col="grey80", lty=2)
    text(as.Date('2019-12-05'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-09'), col="grey80", lty=2)
    text(as.Date('2020-01-09'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-13'), col="grey80", lty=2)
    text(as.Date('2020-01-13'), -25, "35%", cex= 0.5)
        abline(v=as.Date('2020-01-21'), col="grey80", lty=2)
    text(as.Date('2020-01-21'), -24, "40%", cex= 0.5)
            abline(v=as.Date('2020-02-05'), col="grey80", lty=2)
    text(as.Date('2020-02-05'), -24, "42%", cex= 0.5)
            abline(v=as.Date('2020-02-25'), col="grey80", lty=2)
    text(as.Date('2020-02-25'), -24, "41%", cex= 0.5)
        abline(v=as.Date('2020-03-02'), col="grey80", lty=2)
    text(as.Date('2020-03-02'), -25, "46%", cex= 0.5)

    
    
    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Sa1 <- as.data.frame(predict(Model10.m, newdata= Sa1.1, se= TRUE))
Model10.m_Predict.Sa1 <- Model10.m_Predict.Sa1 %>% dplyr::rename("Model10.m_Predict.Sa1"="fit")
Model10.m_Predict.Sa1 <- Model10.m_Predict.Sa1 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Sa1 <- as.data.frame(predict(Model50.m, newdata= Sa1.1, se= TRUE))
Model50.m_Predict.Sa1 <- Model50.m_Predict.Sa1 %>% dplyr::rename("Model50.m_Predict.Sa1"="fit")
Model50.m_Predict.Sa1 <- Model50.m_Predict.Sa1 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Sa1 <- as.data.frame(predict(Model90.m, newdata= Sa1.1, se= TRUE))
Model90.m_Predict.Sa1 <- Model90.m_Predict.Sa1 %>% dplyr::rename("Model90.m_Predict.Sa1"="fit")
Model90.m_Predict.Sa1 <- Model90.m_Predict.Sa1 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sa1.1 <- cbind(Sa1.1, 
                         Model10.m_Predict.Sa1, 
                         Model50.m_Predict.Sa1, 
                         Model90.m_Predict.Sa1)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Sa1.2 <- as.data.frame(predict(Model10.m2, newdata= Sa1.2, se= TRUE))
Model10.m2_Predict.Sa1.2 <- Model10.m2_Predict.Sa1.2 %>% dplyr::rename("Model10.m_Predict.Sa1"="fit")
Model10.m2_Predict.Sa1.2 <- Model10.m2_Predict.Sa1.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Sa1.2 <- as.data.frame(predict(Model50.m2, newdata= Sa1.2, se= TRUE))
Model50.m2_Predict.Sa1.2 <- Model50.m2_Predict.Sa1.2 %>% dplyr::rename("Model50.m_Predict.Sa1"="fit")
Model50.m2_Predict.Sa1.2 <- Model50.m2_Predict.Sa1.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Sa1.2 <- as.data.frame(predict(Model90.m2, newdata= Sa1.2, se= TRUE))
Model90.m2_Predict.Sa1.2 <- Model90.m2_Predict.Sa1.2 %>% dplyr::rename("Model90.m_Predict.Sa1"="fit")
Model90.m2_Predict.Sa1.2 <- Model90.m2_Predict.Sa1.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sa1.2 <- cbind(Sa1.2, 
                         Model10.m2_Predict.Sa1.2, 
                         Model50.m2_Predict.Sa1.2, 
                         Model90.m2_Predict.Sa1.2)


Predict.Sa1 <- rbind(Predict.Sa1.1, Predict.Sa1.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Sa1~ LT10, data=Predict.Sa1)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Sa1~ LT10, data=Predict.Sa1))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Sa1 ~ LT10, data=Predict.Sa1,
     main="LT10: High Elevation 2019-2029",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Sa1 ~ LT10, data=Predict.Sa1), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Sa1~ LT50, data=Predict.Sa1)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Sa1~ LT50, data=Predict.Sa1))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Sa1 ~ LT50, data=Predict.Sa1,
     main="LT50: High Elevation 2019-2029",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Sa1 ~ LT50, data=Predict.Sa1), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Sa1~ LT90, data=Predict.Sa1)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Sa1~ LT90, data=Predict.Sa1))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Sa1 ~ LT90, data=Predict.Sa1,
     main="LT90: High Elevation 2019-2029",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Sa1 ~ LT90, data=Predict.Sa1), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)



# Season 2
    
plot(Sa2$Date, Sa2$LT10,
         main= "LT10 Model Validation: High Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Sa2.1$Date, rev(PredictLT10_Sa2.1$Date)), c(PredictLT10_Sa2.1$LT10.CILower, rev(PredictLT10_Sa2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sa2.2$Date, rev(PredictLT10_Sa2.2$Date)), c(PredictLT10_Sa2.2$LT10.CILower, rev(PredictLT10_Sa2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sa2.1$Date, PredictLT10_Sa2.1$LT10, lty = 1, lwd=1, col = PredictLT10_Sa2.1$Colour)
    lines(PredictLT10_Sa2.2$Date, PredictLT10_Sa2.2$LT10, lty = 1, lwd=1, col = PredictLT10_Sa2.2$Colour)
          lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    text(as.Date('2020-10-27'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -25, "1%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "6%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "18%", cex= 0.5)
   
    
plot(Sa2$Date, Sa2$LT50,
         main= "LT50 Model Validation: High Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sa2.1$Date, rev(PredictLT50_Sa2.1$Date)), c(PredictLT50_Sa2.1$LT50.CILower, rev(PredictLT50_Sa2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa2.2$Date, rev(PredictLT50_Sa2.2$Date)), c(PredictLT50_Sa2.2$LT50.CILower, rev(PredictLT50_Sa2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa2.1$Date, PredictLT50_Sa2.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sa2.1$Colour)
    lines(PredictLT50_Sa2.2$Date, PredictLT50_Sa2.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sa2.2$Colour)
              lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    text(as.Date('2020-10-27'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -25, "1%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "6%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "18%", cex= 0.5)
    
    
    # without extra lines
    
    plot(Sa2$Date, Sa2$LT50,
         main= "LT50 Model Validation: High Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sa2.1$Date, rev(PredictLT50_Sa2.1$Date)), c(PredictLT50_Sa2.1$LT50.CILower, rev(PredictLT50_Sa2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa2.2$Date, rev(PredictLT50_Sa2.2$Date)), c(PredictLT50_Sa2.2$LT50.CILower, rev(PredictLT50_Sa2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa2.1$Date, PredictLT50_Sa2.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sa2.1$Colour)
    lines(PredictLT50_Sa2.2$Date, PredictLT50_Sa2.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sa2.2$Colour)

    
plot(Sa2$Date, Sa2$LT90,
         main= "LT90 Model Validation: High Elevation 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Sa2.1$Date, rev(PredictLT90_Sa2.1$Date)), c(PredictLT90_Sa2.1$LT90.CILower, rev(PredictLT90_Sa2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sa2.2$Date, rev(PredictLT90_Sa2.2$Date)), c(PredictLT90_Sa2.2$LT90.CILower, rev(PredictLT90_Sa2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sa2.1$Date, PredictLT90_Sa2.1$LT90, lty = 1, lwd=1, col = PredictLT90_Sa2.1$Colour)
    lines(PredictLT90_Sa2.2$Date, PredictLT90_Sa2.2$LT90, lty = 1, lwd=1, col = PredictLT90_Sa2.2$Colour)
              lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    text(as.Date('2020-10-27'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -25, "1%", cex= 0.5)
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -24, "0%", cex= 0.5)
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -24, "6%", cex= 0.5)
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -24, "18%", cex= 0.5)
    

    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Sa2 <- as.data.frame(predict(Model10.m, newdata= Sa2.1, se= TRUE))
Model10.m_Predict.Sa2 <- Model10.m_Predict.Sa2 %>% dplyr::rename("Model10.m_Predict.Sa2"="fit")
Model10.m_Predict.Sa2 <- Model10.m_Predict.Sa2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Sa2 <- as.data.frame(predict(Model50.m, newdata= Sa2.1, se= TRUE))
Model50.m_Predict.Sa2 <- Model50.m_Predict.Sa2 %>% dplyr::rename("Model50.m_Predict.Sa2"="fit")
Model50.m_Predict.Sa2 <- Model50.m_Predict.Sa2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Sa2 <- as.data.frame(predict(Model90.m, newdata= Sa2.1, se= TRUE))
Model90.m_Predict.Sa2 <- Model90.m_Predict.Sa2 %>% dplyr::rename("Model90.m_Predict.Sa2"="fit")
Model90.m_Predict.Sa2 <- Model90.m_Predict.Sa2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sa2.1 <- cbind(Sa2.1, 
                         Model10.m_Predict.Sa2, 
                         Model50.m_Predict.Sa2, 
                         Model90.m_Predict.Sa2)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Sa2.2 <- as.data.frame(predict(Model10.m2, newdata= Sa2.2, se= TRUE))
Model10.m2_Predict.Sa2.2 <- Model10.m2_Predict.Sa2.2 %>% dplyr::rename("Model10.m_Predict.Sa2"="fit")
Model10.m2_Predict.Sa2.2 <- Model10.m2_Predict.Sa2.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Sa2.2 <- as.data.frame(predict(Model50.m2, newdata= Sa2.2, se= TRUE))
Model50.m2_Predict.Sa2.2 <- Model50.m2_Predict.Sa2.2 %>% dplyr::rename("Model50.m_Predict.Sa2"="fit")
Model50.m2_Predict.Sa2.2 <- Model50.m2_Predict.Sa2.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Sa2.2 <- as.data.frame(predict(Model90.m2, newdata= Sa2.2, se= TRUE))
Model90.m2_Predict.Sa2.2 <- Model90.m2_Predict.Sa2.2 %>% dplyr::rename("Model90.m_Predict.Sa2"="fit")
Model90.m2_Predict.Sa2.2 <- Model90.m2_Predict.Sa2.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sa2.2 <- cbind(Sa2.2, 
                         Model10.m2_Predict.Sa2.2, 
                         Model50.m2_Predict.Sa2.2, 
                         Model90.m2_Predict.Sa2.2)


Predict.Sa2 <- rbind(Predict.Sa2.1, Predict.Sa2.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Sa2~ LT10, data=Predict.Sa2)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Sa2~ LT10, data=Predict.Sa2))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Sa2 ~ LT10, data=Predict.Sa2,
     main="LT10: High Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Sa2 ~ LT10, data=Predict.Sa2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Sa2~ LT50, data=Predict.Sa2)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Sa2~ LT50, data=Predict.Sa2))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Sa2 ~ LT50, data=Predict.Sa2,
     main="LT50: High Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Sa2 ~ LT50, data=Predict.Sa2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Sa2~ LT90, data=Predict.Sa2)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Sa2~ LT90, data=Predict.Sa2))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Sa2 ~ LT90, data=Predict.Sa2,
     main="LT90: High Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Sa2 ~ LT90, data=Predict.Sa2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)



# Season 3
    
plot(Sa3$Date, Sa3$LT10,
         main= "LT10 Model Validation: High Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Sa3.1$Date, rev(PredictLT10_Sa3.1$Date)), c(PredictLT10_Sa3.1$LT10.CILower, rev(PredictLT10_Sa3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sa3.2$Date, rev(PredictLT10_Sa3.2$Date)), c(PredictLT10_Sa3.2$LT10.CILower, rev(PredictLT10_Sa3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sa3.1$Date, PredictLT10_Sa3.1$LT10, lty = 1, lwd=1, col = PredictLT10_Sa3.1$Colour)
    lines(PredictLT10_Sa3.2$Date, PredictLT10_Sa3.2$LT10, lty = 1, lwd=1, col = PredictLT10_Sa3.2$Colour)
              lines(Sa3$Date, Sa3$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -24, "39%", cex= 0.5)
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -25, "30%", cex= 0.5)
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -24, "38%", cex= 0.5)
     
    
plot(Sa3$Date, Sa3$LT50,
         main= "LT50 Model Validation: High Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sa3.1$Date, rev(PredictLT50_Sa3.1$Date)), c(PredictLT50_Sa3.1$LT50.CILower, rev(PredictLT50_Sa3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa3.2$Date, rev(PredictLT50_Sa3.2$Date)), c(PredictLT50_Sa3.2$LT50.CILower, rev(PredictLT50_Sa3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa3.1$Date, PredictLT50_Sa3.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sa3.1$Colour)
    lines(PredictLT50_Sa3.2$Date, PredictLT50_Sa3.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sa3.2$Colour)
        lines(Sa3$Date, Sa3$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -24, "39%", cex= 0.5)
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -25, "30%", cex= 0.5)
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -24, "38%", cex= 0.5)
    
    
plot(Sa3$Date, Sa3$LT90,
         main= "LT90 Model Validation: High Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Sa3.1$Date, rev(PredictLT90_Sa3.1$Date)), c(PredictLT90_Sa3.1$LT90.CILower, rev(PredictLT90_Sa3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sa3.2$Date, rev(PredictLT90_Sa3.2$Date)), c(PredictLT90_Sa3.2$LT90.CILower, rev(PredictLT90_Sa3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sa3.1$Date, PredictLT90_Sa3.1$LT90, lty = 1, lwd=1, col = PredictLT90_Sa3.1$Colour)
    lines(PredictLT90_Sa3.2$Date, PredictLT90_Sa3.2$LT90, lty = 1, lwd=1, col = PredictLT90_Sa3.2$Colour)
              lines(Sa3$Date, Sa3$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -24, "39%", cex= 0.5)
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -25, "30%", cex= 0.5)
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -24, "38%", cex= 0.5)
    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Sa3 <- as.data.frame(predict(Model10.m, newdata= Sa3.1, se= TRUE))
Model10.m_Predict.Sa3 <- Model10.m_Predict.Sa3 %>% dplyr::rename("Model10.m_Predict.Sa3"="fit")
Model10.m_Predict.Sa3 <- Model10.m_Predict.Sa3 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Sa3 <- as.data.frame(predict(Model50.m, newdata= Sa3.1, se= TRUE))
Model50.m_Predict.Sa3 <- Model50.m_Predict.Sa3 %>% dplyr::rename("Model50.m_Predict.Sa3"="fit")
Model50.m_Predict.Sa3 <- Model50.m_Predict.Sa3 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Sa3 <- as.data.frame(predict(Model90.m, newdata= Sa3.1, se= TRUE))
Model90.m_Predict.Sa3 <- Model90.m_Predict.Sa3 %>% dplyr::rename("Model90.m_Predict.Sa3"="fit")
Model90.m_Predict.Sa3 <- Model90.m_Predict.Sa3 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sa3.1 <- cbind(Sa3.1, 
                         Model10.m_Predict.Sa3, 
                         Model50.m_Predict.Sa3, 
                         Model90.m_Predict.Sa3)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Sa3.2 <- as.data.frame(predict(Model10.m2, newdata= Sa3.2, se= TRUE))
Model10.m2_Predict.Sa3.2 <- Model10.m2_Predict.Sa3.2 %>% dplyr::rename("Model10.m_Predict.Sa3"="fit")
Model10.m2_Predict.Sa3.2 <- Model10.m2_Predict.Sa3.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Sa3.2 <- as.data.frame(predict(Model50.m2, newdata= Sa3.2, se= TRUE))
Model50.m2_Predict.Sa3.2 <- Model50.m2_Predict.Sa3.2 %>% dplyr::rename("Model50.m_Predict.Sa3"="fit")
Model50.m2_Predict.Sa3.2 <- Model50.m2_Predict.Sa3.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Sa3.2 <- as.data.frame(predict(Model90.m2, newdata= Sa3.2, se= TRUE))
Model90.m2_Predict.Sa3.2 <- Model90.m2_Predict.Sa3.2 %>% dplyr::rename("Model90.m_Predict.Sa3"="fit")
Model90.m2_Predict.Sa3.2 <- Model90.m2_Predict.Sa3.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sa3.2 <- cbind(Sa3.2, 
                         Model10.m2_Predict.Sa3.2, 
                         Model50.m2_Predict.Sa3.2, 
                         Model90.m2_Predict.Sa3.2)


Predict.Sa3 <- rbind(Predict.Sa3.1, Predict.Sa3.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Sa3~ LT10, data=Predict.Sa3)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Sa3~ LT10, data=Predict.Sa3))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Sa3 ~ LT10, data=Predict.Sa3,
     main="LT10: High Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Sa3 ~ LT10, data=Predict.Sa3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Sa3~ LT50, data=Predict.Sa3)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Sa3~ LT50, data=Predict.Sa3))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Sa3 ~ LT50, data=Predict.Sa3,
     main="LT50: High Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Sa3 ~ LT50, data=Predict.Sa3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Sa3~ LT90, data=Predict.Sa3)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Sa3~ LT90, data=Predict.Sa3))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Sa3 ~ LT90, data=Predict.Sa3,
     main="LT90: High Elevation 2020-2021",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Sa3 ~ LT90, data=Predict.Sa3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)



# for dates where the temp min falls below the predicted LT
subset(PredictLT10_Sa2.1, Date == "2020-10-25")
subset(PredictLT50_Sa2.1, Date == "2020-10-25")
subset(PredictLT90_Sa2.1, Date == "2020-10-25")


subset(PredictLT10_Sa2.1, Date == "2021-02-09")
subset(PredictLT50_Sa2.1, Date == "2021-02-09")
subset(PredictLT90_Sa2.1, Date == "2021-02-09")

subset(PredictLT10_Sa2.1, Date == "2021-02-10")
subset(PredictLT50_Sa2.1, Date == "2021-02-10")
subset(PredictLT90_Sa2.1, Date == "2021-02-10")

subset(PredictLT10_Sa2.1, Date == "2021-02-11")
subset(PredictLT50_Sa2.1, Date == "2021-02-11")
subset(PredictLT90_Sa2.1, Date == "2021-02-11")
```



* * *
## 13.3 Validation: Low Elevation Site

```{r, echo=FALSE, out.width="30%"}

# ## Season 2
# # Slater LT10 Season 2 Model 1
# PredictLT10_Sl2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Sl2.1, se= TRUE))
#     PredictLT10_Sl2.1$LT10.CIUpper <- (PredictLT10_Sl2.1$fit + PredictLT10_Sl2.1$se.fit*1.96)
#     PredictLT10_Sl2.1$LT10.CILower <- (PredictLT10_Sl2.1$fit - PredictLT10_Sl2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Sl2.1$Date <- Sl2.1$Date
#     # rename fit to LT50
#     PredictLT10_Sl2.1 <- PredictLT10_Sl2.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_Sl2.1 <- PredictLT10_Sl2.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Sl2.1$Colour = "black"
#     
# # Slater LT10 Season 2 Model 2
# PredictLT10_Sl2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Sl2.2, se= TRUE))
#     PredictLT10_Sl2.2$LT10.CIUpper <- (PredictLT10_Sl2.2$fit + PredictLT10_Sl2.2$se.fit*1.96)
#     PredictLT10_Sl2.2$LT10.CILower <- (PredictLT10_Sl2.2$fit - PredictLT10_Sl2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Sl2.2$Date <- Sl2.2$Date
#     # rename fit to LT50
#     PredictLT10_Sl2.2 <- PredictLT10_Sl2.2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Sl2.2 <- PredictLT10_Sl2.2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Sl2.2$Colour = "mediumblue"
#     
#     
# PredictLT10_Sl2 <- rbind(PredictLT10_Sl2.1, PredictLT10_Sl2.2)
# 
# 
# # Slater LT50 Season 2 Model 1
# PredictLT50_Sl2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Sl2.1, se= TRUE))
#     PredictLT50_Sl2.1$LT50.CIUpper <- (PredictLT50_Sl2.1$fit + PredictLT50_Sl2.1$se.fit*1.96)
#     PredictLT50_Sl2.1$LT50.CILower <- (PredictLT50_Sl2.1$fit - PredictLT50_Sl2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Sl2.1$Date <- Sl2.1$Date
#     # rename fit to LT50
#     PredictLT50_Sl2.1 <- PredictLT50_Sl2.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_Sl2.1 <- PredictLT50_Sl2.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Sl2.1$Colour = "black"
#     
# # Slater LT50 Season 2 Model 2
# PredictLT50_Sl2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Sl2.2, se= TRUE))
#     PredictLT50_Sl2.2$LT50.CIUpper <- (PredictLT50_Sl2.2$fit + PredictLT50_Sl2.2$se.fit*1.96)
#     PredictLT50_Sl2.2$LT50.CILower <- (PredictLT50_Sl2.2$fit - PredictLT50_Sl2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Sl2.2$Date <- Sl2.2$Date
#     # rename fit to LT50
#     PredictLT50_Sl2.2 <- PredictLT50_Sl2.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Sl2.2 <- PredictLT50_Sl2.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Sl2.2$Colour = "mediumblue"
#     
# PredictLT50_Sl2 <- rbind(PredictLT50_Sl2.1, PredictLT50_Sl2.2)
#     
#     # Slater LT90 Season 2 Model 1
# PredictLT90_Sl2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Sl2.1, se= TRUE))
#     PredictLT90_Sl2.1$LT90.CIUpper <- (PredictLT90_Sl2.1$fit + PredictLT90_Sl2.1$se.fit*1.96)
#     PredictLT90_Sl2.1$LT90.CILower <- (PredictLT90_Sl2.1$fit - PredictLT90_Sl2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Sl2.1$Date <- Sl2.1$Date
#     # rename fit to LT50
#     PredictLT90_Sl2.1 <- PredictLT90_Sl2.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_Sl2.1 <- PredictLT90_Sl2.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Sl2.1$Colour = "black"
#     
# # Slater LT90 Season 2 Model 2
# PredictLT90_Sl2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Sl2.2, se= TRUE))
#     PredictLT90_Sl2.2$LT90.CIUpper <- (PredictLT90_Sl2.2$fit + PredictLT90_Sl2.2$se.fit*1.96)
#     PredictLT90_Sl2.2$LT90.CILower <- (PredictLT90_Sl2.2$fit - PredictLT90_Sl2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Sl2.2$Date <- Sl2.2$Date
#     # rename fit to LT50
#     PredictLT90_Sl2.2 <- PredictLT90_Sl2.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Sl2.2 <- PredictLT90_Sl2.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Sl2.2$Colour = "mediumblue"
#     
#     
# PredictLT90_Sl2 <- rbind(PredictLT90_Sl2.1, PredictLT90_Sl2.2)

## Season 3
# Slater LT10 Season 3 Model 1
PredictLT10_Sl3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Sl3.1, se= TRUE))
    PredictLT10_Sl3.1$LT10.CIUpper <- (PredictLT10_Sl3.1$fit + PredictLT10_Sl3.1$se.fit*1.96)
    PredictLT10_Sl3.1$LT10.CILower <- (PredictLT10_Sl3.1$fit - PredictLT10_Sl3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sl3.1$Date <- Sl3.1$Date
    # rename fit to LT50
    PredictLT10_Sl3.1 <- PredictLT10_Sl3.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Sl3.1 <- PredictLT10_Sl3.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sl3.1$Colour = "black"
    
# Slater LT10 Season 3 Model 2
PredictLT10_Sl3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Sl3.2, se= TRUE))
    PredictLT10_Sl3.2$LT10.CIUpper <- (PredictLT10_Sl3.2$fit + PredictLT10_Sl3.2$se.fit*1.96)
    PredictLT10_Sl3.2$LT10.CILower <- (PredictLT10_Sl3.2$fit - PredictLT10_Sl3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Sl3.2$Date <- Sl3.2$Date
    # rename fit to LT50
    PredictLT10_Sl3.2 <- PredictLT10_Sl3.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_Sl3.2 <- PredictLT10_Sl3.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Sl3.2$Colour = "mediumblue"
    
    
PredictLT10_Sl3 <- rbind(PredictLT10_Sl3.1, PredictLT10_Sl3.2)


# Slater LT50 Season 3 Model 1
PredictLT50_Sl3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Sl3.1, se= TRUE))
    PredictLT50_Sl3.1$LT50.CIUpper <- (PredictLT50_Sl3.1$fit + PredictLT50_Sl3.1$se.fit*1.96)
    PredictLT50_Sl3.1$LT50.CILower <- (PredictLT50_Sl3.1$fit - PredictLT50_Sl3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sl3.1$Date <- Sl3.1$Date
    # rename fit to LT50
    PredictLT50_Sl3.1 <- PredictLT50_Sl3.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Sl3.1 <- PredictLT50_Sl3.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sl3.1$Colour = "black"
    
# Slater LT50 Season 3 Model 2
PredictLT50_Sl3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Sl3.2, se= TRUE))
    PredictLT50_Sl3.2$LT50.CIUpper <- (PredictLT50_Sl3.2$fit + PredictLT50_Sl3.2$se.fit*1.96)
    PredictLT50_Sl3.2$LT50.CILower <- (PredictLT50_Sl3.2$fit - PredictLT50_Sl3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Sl3.2$Date <- Sl3.2$Date
    # rename fit to LT50
    PredictLT50_Sl3.2 <- PredictLT50_Sl3.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_Sl3.2 <- PredictLT50_Sl3.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Sl3.2$Colour = "mediumblue"
    
PredictLT50_Sl3 <- rbind(PredictLT50_Sl3.1, PredictLT50_Sl3.2)
    
    # Slater LT90 Season 3 Model 1
PredictLT90_Sl3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Sl3.1, se= TRUE))
    PredictLT90_Sl3.1$LT90.CIUpper <- (PredictLT90_Sl3.1$fit + PredictLT90_Sl3.1$se.fit*1.96)
    PredictLT90_Sl3.1$LT90.CILower <- (PredictLT90_Sl3.1$fit - PredictLT90_Sl3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sl3.1$Date <- Sl3.1$Date
    # rename fit to LT50
    PredictLT90_Sl3.1 <- PredictLT90_Sl3.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Sl3.1 <- PredictLT90_Sl3.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sl3.1$Colour = "black"
    
# Slater LT90 Season 3 Model 2
PredictLT90_Sl3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Sl3.2, se= TRUE))
    PredictLT90_Sl3.2$LT90.CIUpper <- (PredictLT90_Sl3.2$fit + PredictLT90_Sl3.2$se.fit*1.96)
    PredictLT90_Sl3.2$LT90.CILower <- (PredictLT90_Sl3.2$fit - PredictLT90_Sl3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Sl3.2$Date <- Sl3.2$Date
    # rename fit to LT50
    PredictLT90_Sl3.2 <- PredictLT90_Sl3.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_Sl3.2 <- PredictLT90_Sl3.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Sl3.2$Colour = "mediumblue"

    
PredictLT90_Sl3 <- rbind(PredictLT90_Sl3.1, PredictLT90_Sl3.2)


    
# # Season 2
#     
# plot(Sl2$Date, Sl2$LT10,
#          main= "LT10 Model Validation: Slater 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_Sl2.1$Date, rev(PredictLT10_Sl2.1$Date)), c(PredictLT10_Sl2.1$LT10.CILower, rev(PredictLT10_Sl2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_Sl2.2$Date, rev(PredictLT10_Sl2.2$Date)), c(PredictLT10_Sl2.2$LT10.CILower, rev(PredictLT10_Sl2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_Sl2.1$Date, PredictLT10_Sl2.1$LT10, lty = 1, lwd=1, col = PredictLT10_Sl2.1$Colour)
#     lines(PredictLT10_Sl2.2$Date, PredictLT10_Sl2.2$LT10, lty = 1, lwd=1, col = PredictLT10_Sl2.2$Colour)
#     
#     
# plot(Sl2$Date, Sl2$LT50,
#          main= "LT50 Model Validation: Slater 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_Sl2.1$Date, rev(PredictLT50_Sl2.1$Date)), c(PredictLT50_Sl2.1$LT50.CILower, rev(PredictLT50_Sl2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_Sl2.2$Date, rev(PredictLT50_Sl2.2$Date)), c(PredictLT50_Sl2.2$LT50.CILower, rev(PredictLT50_Sl2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_Sl2.1$Date, PredictLT50_Sl2.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sl2.1$Colour)
#     lines(PredictLT50_Sl2.2$Date, PredictLT50_Sl2.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sl2.2$Colour)
#     
#     
# plot(Sl2$Date, Sl2$LT90,
#          main= "LT90 Model Validation: Slater 2020-2021",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2020-09-01", "2021-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_Sl2.1$Date, rev(PredictLT90_Sl2.1$Date)), c(PredictLT90_Sl2.1$LT90.CILower, rev(PredictLT90_Sl2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_Sl2.2$Date, rev(PredictLT90_Sl2.2$Date)), c(PredictLT90_Sl2.2$LT90.CILower, rev(PredictLT90_Sl2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_Sl2.1$Date, PredictLT90_Sl2.1$LT90, lty = 1, lwd=1, col = PredictLT90_Sl2.1$Colour)
#     lines(PredictLT90_Sl2.2$Date, PredictLT90_Sl2.2$LT90, lty = 1, lwd=1, col = PredictLT90_Sl2.2$Colour)
    
# Season 3
    
plot(Sl3$Date, Sl3$LT10,
         main= "LT10 Model Validation: Low Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Sl3.1$Date, rev(PredictLT10_Sl3.1$Date)), c(PredictLT10_Sl3.1$LT10.CILower, rev(PredictLT10_Sl3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sl3.2$Date, rev(PredictLT10_Sl3.2$Date)), c(PredictLT10_Sl3.2$LT10.CILower, rev(PredictLT10_Sl3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sl3.1$Date, PredictLT10_Sl3.1$LT10, lty = 1, lwd=1, col = PredictLT10_Sl3.1$Colour)
    lines(PredictLT10_Sl3.2$Date, PredictLT10_Sl3.2$LT10, lty = 1, lwd=1, col = PredictLT10_Sl3.2$Colour)
    lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -24, "0%", cex= 0.5)
    
plot(Sl3$Date, Sl3$LT50,
         main= "LT50 Model Validation: Low Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sl3.1$Date, rev(PredictLT50_Sl3.1$Date)), c(PredictLT50_Sl3.1$LT50.CILower, rev(PredictLT50_Sl3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sl3.2$Date, rev(PredictLT50_Sl3.2$Date)), c(PredictLT50_Sl3.2$LT50.CILower, rev(PredictLT50_Sl3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sl3.1$Date, PredictLT50_Sl3.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sl3.1$Colour)
    lines(PredictLT50_Sl3.2$Date, PredictLT50_Sl3.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sl3.2$Colour)
    lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2020-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -24, "0%", cex= 0.5)
    
    
    #without extra lines
    plot(Sl3$Date, Sl3$LT50,
         main= "LT50 Model Validation: Low Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Sl3.1$Date, rev(PredictLT50_Sl3.1$Date)), c(PredictLT50_Sl3.1$LT50.CILower, rev(PredictLT50_Sl3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sl3.2$Date, rev(PredictLT50_Sl3.2$Date)), c(PredictLT50_Sl3.2$LT50.CILower, rev(PredictLT50_Sl3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sl3.1$Date, PredictLT50_Sl3.1$LT50, lty = 1, lwd=1, col = PredictLT50_Sl3.1$Colour)
    lines(PredictLT50_Sl3.2$Date, PredictLT50_Sl3.2$LT50, lty = 1, lwd=1, col = PredictLT50_Sl3.2$Colour)

    
plot(Sl3$Date, Sl3$LT90,
         main= "LT90 Model Validation: Low Elevation 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Sl3.1$Date, rev(PredictLT90_Sl3.1$Date)), c(PredictLT90_Sl3.1$LT90.CILower, rev(PredictLT90_Sl3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sl3.2$Date, rev(PredictLT90_Sl3.2$Date)), c(PredictLT90_Sl3.2$LT90.CILower, rev(PredictLT90_Sl3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sl3.1$Date, PredictLT90_Sl3.1$LT90, lty = 1, lwd=1, col = PredictLT90_Sl3.1$Colour)
    lines(PredictLT90_Sl3.2$Date, PredictLT90_Sl3.2$LT90, lty = 1, lwd=1, col = PredictLT90_Sl3.2$Colour)
    lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.75, col = 'red4') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -24, "0%", cex= 0.5)
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -24, "0%", cex= 0.5)

    
    # 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Sl3 <- as.data.frame(predict(Model10.m, newdata= Sl3.1, se= TRUE))
Model10.m_Predict.Sl3 <- Model10.m_Predict.Sl3 %>% dplyr::rename("Model10.m_Predict.Sl3"="fit")
Model10.m_Predict.Sl3 <- Model10.m_Predict.Sl3 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Sl3 <- as.data.frame(predict(Model50.m, newdata= Sl3.1, se= TRUE))
Model50.m_Predict.Sl3 <- Model50.m_Predict.Sl3 %>% dplyr::rename("Model50.m_Predict.Sl3"="fit")
Model50.m_Predict.Sl3 <- Model50.m_Predict.Sl3 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Sl3 <- as.data.frame(predict(Model90.m, newdata= Sl3.1, se= TRUE))
Model90.m_Predict.Sl3 <- Model90.m_Predict.Sl3 %>% dplyr::rename("Model90.m_Predict.Sl3"="fit")
Model90.m_Predict.Sl3 <- Model90.m_Predict.Sl3 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sl3.1 <- cbind(Sl3.1, 
                         Model10.m_Predict.Sl3, 
                         Model50.m_Predict.Sl3, 
                         Model90.m_Predict.Sl3)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Sl3.2 <- as.data.frame(predict(Model10.m2, newdata= Sl3.2, se= TRUE))
Model10.m2_Predict.Sl3.2 <- Model10.m2_Predict.Sl3.2 %>% dplyr::rename("Model10.m_Predict.Sl3"="fit")
Model10.m2_Predict.Sl3.2 <- Model10.m2_Predict.Sl3.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Sl3.2 <- as.data.frame(predict(Model50.m2, newdata= Sl3.2, se= TRUE))
Model50.m2_Predict.Sl3.2 <- Model50.m2_Predict.Sl3.2 %>% dplyr::rename("Model50.m_Predict.Sl3"="fit")
Model50.m2_Predict.Sl3.2 <- Model50.m2_Predict.Sl3.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Sl3.2 <- as.data.frame(predict(Model90.m2, newdata= Sl3.2, se= TRUE))
Model90.m2_Predict.Sl3.2 <- Model90.m2_Predict.Sl3.2 %>% dplyr::rename("Model90.m_Predict.Sl3"="fit")
Model90.m2_Predict.Sl3.2 <- Model90.m2_Predict.Sl3.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sl3.2 <- cbind(Sl3.2, 
                         Model10.m2_Predict.Sl3.2, 
                         Model50.m2_Predict.Sl3.2, 
                         Model90.m2_Predict.Sl3.2)


Predict.Sl3 <- rbind(Predict.Sl3.1, Predict.Sl3.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Sl3~ LT10, data=Predict.Sl3)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Sl3~ LT10, data=Predict.Sl3))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Sl3 ~ LT10, data=Predict.Sl3,
     main="LT10: Low Elevation 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Sl3 ~ LT10, data=Predict.Sl3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Sl3~ LT50, data=Predict.Sl3)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Sl3~ LT50, data=Predict.Sl3))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Sl3 ~ LT50, data=Predict.Sl3,
     main="LT50: Low Elevation 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Sl3 ~ LT50, data=Predict.Sl3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Sl3~ LT90, data=Predict.Sl3)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Sl3~ LT90, data=Predict.Sl3))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Sl3 ~ LT90, data=Predict.Sl3,
     main="LT90: Low Elevation 2021-2022",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Sl3 ~ LT90, data=Predict.Sl3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


# for dates where the temp min falls below the predicted LT
subset(PredictLT10_Sl3.1, Date == "2021-12-26")
subset(PredictLT50_Sl3.1, Date == "2021-12-26")
subset(PredictLT90_Sl3.1, Date == "2021-12-26")

subset(PredictLT10_Sl3.1, Date == "2021-12-27")
subset(PredictLT50_Sl3.1, Date == "2021-12-27")
subset(PredictLT90_Sl3.1, Date == "2021-12-27")

subset(PredictLT10_Sl3.1, Date == "2022-02-23")
subset(PredictLT50_Sl3.1, Date == "2022-02-23")
subset(PredictLT90_Sl3.1, Date == "2022-02-23")
```

```{r, echo=FALSE, out.width="30%"}
# ## 13.3 Validation: AAFC SuRDC Site
# Sweetheart_all <- read.csv(file='Sweetheart_CH_CF_daily.csv')
# 
# Sweetheart_all$Date <- as.Date(Sweetheart_all$Date)
# 
# # Sl$Sweetheart_cherry_forcingBB_final.05 <- Sl$Sweetheart_cherry_forcingBB_final/4
# Sweetheart_all$Sweetheart_cherry_forcingBB_final.05 <- 0
# Sweetheart_all$Sweetheart_cherry_forcingBB_final <- ifelse(Sweetheart_all$cherry_model_final <= 2000, # if forcing units less than or equal to 5
#                                                           Sweetheart_all$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
#                                                           Sweetheart_all$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
# Sweetheart_all$Sweetheart_cherry_forcingBB_final_log <- log(Sweetheart_all$Sweetheart_cherry_forcingBB_final + 10)
# 
# 
# 
# # Seperate each site by season
# AAFC1 <- subset(Sweetheart_all, Date >= "2008-09-18" & Date <= "2009-04-30")
# AAFC2 <- subset(Sweetheart_all, Date >= "2009-09-15" & Date <= "2010-04-30")
# 
# AAFC1.1 <- subset(AAFC1, Sweetheart_cherry_forcingBB_final < 30)
# AAFC1.2 <- subset(AAFC1, Sweetheart_cherry_forcingBB_final >= 30)
# 
# AAFC2.1 <- subset(AAFC2, Sweetheart_cherry_forcingBB_final < 30)
# AAFC2.2 <- subset(AAFC2, Sweetheart_cherry_forcingBB_final >= 30)
# 
# 
# ## Season 1
# # AAFC SuRDC LT10 Season 1 Model 1
# PredictLT10_AAFC1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = AAFC1.1, se= TRUE))
#     PredictLT10_AAFC1.1$LT10.CIUpper <- (PredictLT10_AAFC1.1$fit + PredictLT10_AAFC1.1$se.fit*1.96)
#     PredictLT10_AAFC1.1$LT10.CILower <- (PredictLT10_AAFC1.1$fit - PredictLT10_AAFC1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_AAFC1.1$Date <- AAFC1.1$Date
#     # rename fit to LT50
#     PredictLT10_AAFC1.1 <- PredictLT10_AAFC1.1 %>% 
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_AAFC1.1 <- PredictLT10_AAFC1.1 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_AAFC1.1$Colour = "black"
#     
# # AAFC SuRDC LT10 Season 1 Model 2
# PredictLT10_AAFC1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = AAFC1.2, se= TRUE))
#     PredictLT10_AAFC1.2$LT10.CIUpper <- (PredictLT10_AAFC1.2$fit + PredictLT10_AAFC1.2$se.fit*1.96)
#     PredictLT10_AAFC1.2$LT10.CILower <- (PredictLT10_AAFC1.2$fit - PredictLT10_AAFC1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_AAFC1.2$Date <- AAFC1.2$Date
#     # rename fit to LT50
#     PredictLT10_AAFC1.2 <- PredictLT10_AAFC1.2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_AAFC1.2 <- PredictLT10_AAFC1.2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_AAFC1.2$Colour = "mediumblue"
#     
#     
# PredictLT10_AAFC1 <- rbind(PredictLT10_AAFC1.1, PredictLT10_AAFC1.2)
# 
# 
# # AAFC SuRDC LT50 Season 1 Model 1
# PredictLT50_AAFC1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = AAFC1.1, se= TRUE))
#     PredictLT50_AAFC1.1$LT50.CIUpper <- (PredictLT50_AAFC1.1$fit + PredictLT50_AAFC1.1$se.fit*1.96)
#     PredictLT50_AAFC1.1$LT50.CILower <- (PredictLT50_AAFC1.1$fit - PredictLT50_AAFC1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_AAFC1.1$Date <- AAFC1.1$Date
#     # rename fit to LT50
#     PredictLT50_AAFC1.1 <- PredictLT50_AAFC1.1 %>% 
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_AAFC1.1 <- PredictLT50_AAFC1.1 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_AAFC1.1$Colour = "black"
#     
# # AAFC SuRDC LT50 Season 1 Model 2
# PredictLT50_AAFC1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = AAFC1.2, se= TRUE))
#     PredictLT50_AAFC1.2$LT50.CIUpper <- (PredictLT50_AAFC1.2$fit + PredictLT50_AAFC1.2$se.fit*1.96)
#     PredictLT50_AAFC1.2$LT50.CILower <- (PredictLT50_AAFC1.2$fit - PredictLT50_AAFC1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_AAFC1.2$Date <- AAFC1.2$Date
#     # rename fit to LT50
#     PredictLT50_AAFC1.2 <- PredictLT50_AAFC1.2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_AAFC1.2 <- PredictLT50_AAFC1.2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_AAFC1.2$Colour = "mediumblue"
#     
# PredictLT50_AAFC1 <- rbind(PredictLT50_AAFC1.1, PredictLT50_AAFC1.2)
#     
#     # AAFC SuRDC LT90 Season 1 Model 1
# PredictLT90_AAFC1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = AAFC1.1, se= TRUE))
#     PredictLT90_AAFC1.1$LT90.CIUpper <- (PredictLT90_AAFC1.1$fit + PredictLT90_AAFC1.1$se.fit*1.96)
#     PredictLT90_AAFC1.1$LT90.CILower <- (PredictLT90_AAFC1.1$fit - PredictLT90_AAFC1.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_AAFC1.1$Date <- AAFC1.1$Date
#     # rename fit to LT50
#     PredictLT90_AAFC1.1 <- PredictLT90_AAFC1.1 %>% 
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_AAFC1.1 <- PredictLT90_AAFC1.1 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_AAFC1.1$Colour = "black"
#     
# # AAFC SuRDC LT90 Season 1 Model 2
# PredictLT90_AAFC1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = AAFC1.2, se= TRUE))
#     PredictLT90_AAFC1.2$LT90.CIUpper <- (PredictLT90_AAFC1.2$fit + PredictLT90_AAFC1.2$se.fit*1.96)
#     PredictLT90_AAFC1.2$LT90.CILower <- (PredictLT90_AAFC1.2$fit - PredictLT90_AAFC1.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_AAFC1.2$Date <- AAFC1.2$Date
#     # rename fit to LT50
#     PredictLT90_AAFC1.2 <- PredictLT90_AAFC1.2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_AAFC1.2 <- PredictLT90_AAFC1.2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_AAFC1.2$Colour = "mediumblue"
#     
#     
# PredictLT90_AAFC1 <- rbind(PredictLT90_AAFC1.1, PredictLT90_AAFC1.2)
# 
# 
# ## Season 2
# # AAFC SuRDC LT10 Season 2 Model 1
# PredictLT10_AAFC2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = AAFC2.1, se= TRUE))
#     PredictLT10_AAFC2.1$LT10.CIUpper <- (PredictLT10_AAFC2.1$fit + PredictLT10_AAFC2.1$se.fit*1.96)
#     PredictLT10_AAFC2.1$LT10.CILower <- (PredictLT10_AAFC2.1$fit - PredictLT10_AAFC2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_AAFC2.1$Date <- AAFC2.1$Date
#     # rename fit to LT50
#     PredictLT10_AAFC2.1 <- PredictLT10_AAFC2.1 %>%
#       dplyr::rename(LT10 = "fit")
# # rename se.fit to LT10_standard_error
#     PredictLT10_AAFC2.1 <- PredictLT10_AAFC2.1 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_AAFC2.1$Colour = "black"
# 
# # AAFC SuRDC LT10 Season 2 Model 2
# PredictLT10_AAFC2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = AAFC2.2, se= TRUE))
#     PredictLT10_AAFC2.2$LT10.CIUpper <- (PredictLT10_AAFC2.2$fit + PredictLT10_AAFC2.2$se.fit*1.96)
#     PredictLT10_AAFC2.2$LT10.CILower <- (PredictLT10_AAFC2.2$fit - PredictLT10_AAFC2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_AAFC2.2$Date <- AAFC2.2$Date
#     # rename fit to LT50
#     PredictLT10_AAFC2.2 <- PredictLT10_AAFC2.2 %>%
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_AAFC2.2 <- PredictLT10_AAFC2.2 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_AAFC2.2$Colour = "mediumblue"
# 
# 
# PredictLT10_AAFC2 <- rbind(PredictLT10_AAFC2.1, PredictLT10_AAFC2.2)
# 
# 
# # AAFC SuRDC LT50 Season 2 Model 1
# PredictLT50_AAFC2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = AAFC2.1, se= TRUE))
#     PredictLT50_AAFC2.1$LT50.CIUpper <- (PredictLT50_AAFC2.1$fit + PredictLT50_AAFC2.1$se.fit*1.96)
#     PredictLT50_AAFC2.1$LT50.CILower <- (PredictLT50_AAFC2.1$fit - PredictLT50_AAFC2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_AAFC2.1$Date <- AAFC2.1$Date
#     # rename fit to LT50
#     PredictLT50_AAFC2.1 <- PredictLT50_AAFC2.1 %>%
#       dplyr::rename(LT50 = "fit")
# # rename se.fit to LT50_standard_error
#     PredictLT50_AAFC2.1 <- PredictLT50_AAFC2.1 %>%
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_AAFC2.1$Colour = "black"
# 
# # AAFC SuRDC LT50 Season 2 Model 2
# PredictLT50_AAFC2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = AAFC2.2, se= TRUE))
#     PredictLT50_AAFC2.2$LT50.CIUpper <- (PredictLT50_AAFC2.2$fit + PredictLT50_AAFC2.2$se.fit*1.96)
#     PredictLT50_AAFC2.2$LT50.CILower <- (PredictLT50_AAFC2.2$fit - PredictLT50_AAFC2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_AAFC2.2$Date <- AAFC2.2$Date
#     # rename fit to LT50
#     PredictLT50_AAFC2.2 <- PredictLT50_AAFC2.2 %>%
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_AAFC2.2 <- PredictLT50_AAFC2.2 %>%
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_AAFC2.2$Colour = "mediumblue"
# 
# PredictLT50_AAFC2 <- rbind(PredictLT50_AAFC2.1, PredictLT50_AAFC2.2)
# 
#     # AAFC SuRDC LT90 Season 2 Model 1
# PredictLT90_AAFC2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = AAFC2.1, se= TRUE))
#     PredictLT90_AAFC2.1$LT90.CIUpper <- (PredictLT90_AAFC2.1$fit + PredictLT90_AAFC2.1$se.fit*1.96)
#     PredictLT90_AAFC2.1$LT90.CILower <- (PredictLT90_AAFC2.1$fit - PredictLT90_AAFC2.1$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_AAFC2.1$Date <- AAFC2.1$Date
#     # rename fit to LT50
#     PredictLT90_AAFC2.1 <- PredictLT90_AAFC2.1 %>%
#       dplyr::rename(LT90 = "fit")
# # rename se.fit to LT90_standard_error
#     PredictLT90_AAFC2.1 <- PredictLT90_AAFC2.1 %>%
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_AAFC2.1$Colour = "black"
# 
# # AAFC SuRDC LT90 Season 2 Model 2
# PredictLT90_AAFC2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = AAFC2.2, se= TRUE))
#     PredictLT90_AAFC2.2$LT90.CIUpper <- (PredictLT90_AAFC2.2$fit + PredictLT90_AAFC2.2$se.fit*1.96)
#     PredictLT90_AAFC2.2$LT90.CILower <- (PredictLT90_AAFC2.2$fit - PredictLT90_AAFC2.2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_AAFC2.2$Date <- AAFC2.2$Date
#     # rename fit to LT50
#     PredictLT90_AAFC2.2 <- PredictLT90_AAFC2.2 %>%
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_AAFC2.2 <- PredictLT90_AAFC2.2 %>%
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_AAFC2.2$Colour = "mediumblue"
# 
# 
# PredictLT90_AAFC2 <- rbind(PredictLT90_AAFC2.1, PredictLT90_AAFC2.2)
# 
# 
# 
# 
#     
# # Season 1
# 
# plot(AAFC1$Date, AAFC1$LT10,
#          main= "LT10 Model Validation: AAFC SuRDC 2008-2009",
#          pch= 20,
#          xlab="",
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2008-09-01", "2009-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_AAFC1.1$Date, rev(PredictLT10_AAFC1.1$Date)), c(PredictLT10_AAFC1.1$LT10.CILower, rev(PredictLT10_AAFC1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_AAFC1.2$Date, rev(PredictLT10_AAFC1.2$Date)), c(PredictLT10_AAFC1.2$LT10.CILower, rev(PredictLT10_AAFC1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_AAFC1.1$Date, PredictLT10_AAFC1.1$LT10, lty = 1, lwd=1, col = PredictLT10_AAFC1.1$Colour)
#     lines(PredictLT10_AAFC1.2$Date, PredictLT10_AAFC1.2$LT10, lty = 1, lwd=1, col = PredictLT10_AAFC1.2$Colour)
# 
# 
# plot(AAFC1$Date, AAFC1$LT50,
#          main= "LT50 Model Validation: AAFC SuRDC 2008-2009",
#          pch= 20,
#          xlab="",
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2008-09-01", "2009-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_AAFC1.1$Date, rev(PredictLT50_AAFC1.1$Date)), c(PredictLT50_AAFC1.1$LT50.CILower, rev(PredictLT50_AAFC1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_AAFC1.2$Date, rev(PredictLT50_AAFC1.2$Date)), c(PredictLT50_AAFC1.2$LT50.CILower, rev(PredictLT50_AAFC1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_AAFC1.1$Date, PredictLT50_AAFC1.1$LT50, lty = 1, lwd=1, col = PredictLT50_AAFC1.1$Colour)
#     lines(PredictLT50_AAFC1.2$Date, PredictLT50_AAFC1.2$LT50, lty = 1, lwd=1, col = PredictLT50_AAFC1.2$Colour)
# 
# 
# plot(AAFC1$Date, AAFC1$LT90,
#          main= "LT90 Model Validation: AAFC SuRDC 2008-2009",
#          pch= 20,
#          xlab="",
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2008-09-01", "2009-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_AAFC1.1$Date, rev(PredictLT90_AAFC1.1$Date)), c(PredictLT90_AAFC1.1$LT90.CILower, rev(PredictLT90_AAFC1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_AAFC1.2$Date, rev(PredictLT90_AAFC1.2$Date)), c(PredictLT90_AAFC1.2$LT90.CILower, rev(PredictLT90_AAFC1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_AAFC1.1$Date, PredictLT90_AAFC1.1$LT90, lty = 1, lwd=1, col = PredictLT90_AAFC1.1$Colour)
#     lines(PredictLT90_AAFC1.2$Date, PredictLT90_AAFC1.2$LT90, lty = 1, lwd=1, col = PredictLT90_AAFC1.2$Colour)
#     
# # Season 2
#     
# plot(AAFC2$Date, AAFC2$LT10,
#          main= "LT10 Model Validation: AAFC SuRDC 2009-2010",
#          pch= 20,
#          xlab="", 
#          ylab="LT10 (˚C)",
#          xlim = as.Date(c("2009-09-01", "2010-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT10_AAFC2.1$Date, rev(PredictLT10_AAFC2.1$Date)), c(PredictLT10_AAFC2.1$LT10.CILower, rev(PredictLT10_AAFC2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT10_AAFC2.2$Date, rev(PredictLT10_AAFC2.2$Date)), c(PredictLT10_AAFC2.2$LT10.CILower, rev(PredictLT10_AAFC2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT10_AAFC2.1$Date, PredictLT10_AAFC2.1$LT10, lty = 1, lwd=1, col = PredictLT10_AAFC2.1$Colour)
#     lines(PredictLT10_AAFC2.2$Date, PredictLT10_AAFC2.2$LT10, lty = 1, lwd=1, col = PredictLT10_AAFC2.2$Colour)
#     
#     
# plot(AAFC2$Date, AAFC2$LT50,
#          main= "LT50 Model Validation: AAFC SuRDC 2009-2010",
#          pch= 20,
#          xlab="", 
#          ylab="LT50 (˚C)",
#          xlim = as.Date(c("2009-09-01", "2010-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT50_AAFC2.1$Date, rev(PredictLT50_AAFC2.1$Date)), c(PredictLT50_AAFC2.1$LT50.CILower, rev(PredictLT50_AAFC2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT50_AAFC2.2$Date, rev(PredictLT50_AAFC2.2$Date)), c(PredictLT50_AAFC2.2$LT50.CILower, rev(PredictLT50_AAFC2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT50_AAFC2.1$Date, PredictLT50_AAFC2.1$LT50, lty = 1, lwd=1, col = PredictLT50_AAFC2.1$Colour)
#     lines(PredictLT50_AAFC2.2$Date, PredictLT50_AAFC2.2$LT50, lty = 1, lwd=1, col = PredictLT50_AAFC2.2$Colour)
#     
#     
# plot(AAFC2$Date, AAFC2$LT90,
#          main= "LT90 Model Validation: AAFC SuRDC 2009-2010",
#          pch= 20,
#          xlab="", 
#          ylab="LT90 (˚C)",
#          xlim = as.Date(c("2009-09-01", "2010-04-25")),
#          ylim = c(-25, 0),
#          cex.axis=1,
#          cex = 0.75,
#          cex.lab=1,
#          cex.main=1.75)
#     polygon(c(PredictLT90_AAFC2.1$Date, rev(PredictLT90_AAFC2.1$Date)), c(PredictLT90_AAFC2.1$LT90.CILower, rev(PredictLT90_AAFC2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
#     polygon(c(PredictLT90_AAFC2.2$Date, rev(PredictLT90_AAFC2.2$Date)), c(PredictLT90_AAFC2.2$LT90.CILower, rev(PredictLT90_AAFC2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
#     lines(PredictLT90_AAFC2.1$Date, PredictLT90_AAFC2.1$LT90, lty = 1, lwd=1, col = PredictLT90_AAFC2.1$Colour)
#     lines(PredictLT90_AAFC2.2$Date, PredictLT90_AAFC2.2$LT90, lty = 1, lwd=1, col = PredictLT90_AAFC2.2$Colour)
```


* * *
# RMSE and d

```{R echo = FALSE}
# Calculate RMSE of the three models
# High Elevation Site
Predict.Sl3.1$residuals_LT10 <- Predict.Sl3.1$LT10 - Predict.Sl3.1$Model10.m_Predict.Sl3
Predict.Sl3.1$residuals_LT50 <- Predict.Sl3.1$LT50 - Predict.Sl3.1$Model50.m_Predict.Sl3
Predict.Sl3.1$residuals_LT90 <- Predict.Sl3.1$LT90 - Predict.Sl3.1$Model90.m_Predict.Sl3
Predict.Sl3.1$Time <- 't1'

Predict.Sl3.2$residuals_LT10 <- Predict.Sl3.2$LT10 - Predict.Sl3.2$Model10.m_Predict.Sl3
Predict.Sl3.2$residuals_LT50 <- Predict.Sl3.2$LT50 - Predict.Sl3.2$Model50.m_Predict.Sl3
Predict.Sl3.2$residuals_LT90 <- Predict.Sl3.2$LT90 - Predict.Sl3.2$Model90.m_Predict.Sl3
Predict.Sl3.2$Time <- 't2'

Sl_residuals <- rbind(Predict.Sl3.1, Predict.Sl3.2)
Sl_residuals <- subset(Sl_residuals, select=c(residuals_LT10, residuals_LT50, residuals_LT90, LT10, LT50, LT90, 
                                              Model10.m_Predict.Sl3, Model50.m_Predict.Sl3, Model90.m_Predict.Sl3, Time))

Sl_residuals <- Sl_residuals %>% 
  rename(Model10.m_Predict = Model10.m_Predict.Sl3)
Sl_residuals <- Sl_residuals %>% 
  rename(Model50.m_Predict = Model50.m_Predict.Sl3)
Sl_residuals <- Sl_residuals %>% 
  rename(Model90.m_Predict = Model90.m_Predict.Sl3)

Sl_residuals <- na.omit(Sl_residuals)

#Mid Elevation Site
Predict.M2.1$residuals_LT10 <- Predict.M2.1$LT10 - Predict.M2.1$Model10.m_Predict.M2
Predict.M2.1$residuals_LT50 <- Predict.M2.1$LT50 - Predict.M2.1$Model50.m_Predict.M2
Predict.M2.1$residuals_LT90 <- Predict.M2.1$LT90 - Predict.M2.1$Model90.m_Predict.M2
Predict.M2.1$Time <- 't1'

Predict.M2.2$residuals_LT10 <- Predict.M2.2$LT10 - Predict.M2.2$Model10.m_Predict.M2
Predict.M2.2$residuals_LT50 <- Predict.M2.2$LT50 - Predict.M2.2$Model50.m_Predict.M2
Predict.M2.2$residuals_LT90 <- Predict.M2.2$LT90 - Predict.M2.2$Model90.m_Predict.M2
Predict.M2.2$Time <- 't2'

M_residuals <- rbind(Predict.M2.1, Predict.M2.2)
M_residuals <- subset(M_residuals, select=c(residuals_LT10, residuals_LT50, residuals_LT90, LT10, LT50, LT90, 
                                              Model10.m_Predict.M2, Model50.m_Predict.M2, Model90.m_Predict.M2, Time))

M_residuals <- M_residuals %>% 
  rename(Model10.m_Predict = Model10.m_Predict.M2)
M_residuals <- M_residuals %>% 
  rename(Model50.m_Predict = Model50.m_Predict.M2)
M_residuals <- M_residuals %>% 
  rename(Model90.m_Predict = Model90.m_Predict.M2)

M_residuals <- na.omit(M_residuals)

#High Elevation Site
Predict.Sa2.1$residuals_LT10 <- Predict.Sa2.1$LT10 - Predict.Sa2.1$Model10.m_Predict.Sa2
Predict.Sa2.1$residuals_LT50 <- Predict.Sa2.1$LT50 - Predict.Sa2.1$Model50.m_Predict.Sa2
Predict.Sa2.1$residuals_LT90 <- Predict.Sa2.1$LT90 - Predict.Sa2.1$Model90.m_Predict.Sa2
Predict.Sa2.1$Time <- 't1'
    
Predict.Sa2.2$residuals_LT10 <- Predict.Sa2.2$LT10 - Predict.Sa2.2$Model10.m_Predict.Sa2
Predict.Sa2.2$residuals_LT50 <- Predict.Sa2.2$LT50 - Predict.Sa2.2$Model50.m_Predict.Sa2
Predict.Sa2.2$residuals_LT90 <- Predict.Sa2.2$LT90 - Predict.Sa2.2$Model90.m_Predict.Sa2
Predict.Sa2.2$Time <- 't2'

Sa_residuals <- rbind(Predict.Sa2.1, Predict.Sa2.2)
Sa_residuals <- subset(Sa_residuals, select=c(residuals_LT10, residuals_LT50, residuals_LT90, LT10, LT50, LT90, 
                                              Model10.m_Predict.Sa2, Model50.m_Predict.Sa2, Model90.m_Predict.Sa2, Time))

Sa_residuals <- Sa_residuals %>% 
  rename(Model10.m_Predict = Model10.m_Predict.Sa2)
Sa_residuals <- Sa_residuals %>% 
  rename(Model50.m_Predict = Model50.m_Predict.Sa2)
Sa_residuals <- Sa_residuals %>% 
  rename(Model90.m_Predict = Model90.m_Predict.Sa2)


Sa_residuals <- na.omit(Sa_residuals)

Validation_residuals <- rbind(Sl_residuals, M_residuals, Sa_residuals)
Validation_residuals$Time <- as.factor(Validation_residuals$Time)

Validation_residuals_t1 <- subset(Validation_residuals, Time == 't1')
Validation_residuals_t2 <- subset(Validation_residuals, Time == 't2')


LT10_validation_t1 <- sqrt(mean(Validation_residuals_t1$residuals_LT10^2))
LT50_validation_t1 <- sqrt(mean(Validation_residuals_t1$residuals_LT50^2))
LT90_validation_t1 <- sqrt(mean(Validation_residuals_t1$residuals_LT90^2))

LT10_validation <- sqrt(mean(Validation_residuals$residuals_LT10^2))
LT50_validation <- sqrt(mean(Validation_residuals$residuals_LT50^2))
LT90_validation <- sqrt(mean(Validation_residuals$residuals_LT90^2))

Model1RMSE_validation <- as.data.frame(rbind(LT10_validation, LT50_validation, LT90_validation))
Model1RMSE_validation <- Model1RMSE_validation %>% 
  rename(RMSE = V1)
Model1RMSE_validation <- Model1RMSE_validation %>% mutate_if(is.numeric, ~round(., 2))

Model1RMSE_validation_t1 <- as.data.frame(rbind(LT10_validation_t1, LT50_validation_t1, LT90_validation_t1))
Model1RMSE_validation_t1 <- Model1RMSE_validation_t1 %>% 
  rename(RMSE = V1)
Model1RMSE_validation_t1 <- Model1RMSE_validation_t1 %>% mutate_if(is.numeric, ~round(., 2))

# calculate Index of agreement (hydroGOF package fn d())
Model10.gls_predicted_validation <- Validation_residuals$Model10.m_Predict
Model10.gls_observed_validation <- Validation_residuals$LT10
d_gls10_validation <- d(Model10.gls_predicted_validation, Model10.gls_observed_validation)

Model50.gls_predicted_validation <- Validation_residuals$Model50.m_Predict
Model50.gls_observed_validation <- Validation_residuals$LT50
d_gls50_validation <- d(Model50.gls_predicted_validation, Model50.gls_observed_validation)

Model90.gls_predicted_validation <- Validation_residuals$Model90.m_Predict
Model90.gls_observed_validation <- Validation_residuals$LT90
d_gls90_validation <- d(Model90.gls_predicted_validation, Model90.gls_observed_validation)


Model1.d_validation <- as.data.frame(rbind(d_gls10_validation, d_gls50_validation, d_gls90_validation))
Model1.d_validation <- Model1.d_validation %>% 
  rename(d = V1)
Model1.d_validation <- Model1.d_validation %>% mutate_if(is.numeric, ~round(., 2))


# calculate Index of agreement (hydroGOF package fn d()) just t1
Model10.gls_predicted_validation_t1 <- Validation_residuals_t1$Model10.m_Predict
Model10.gls_observed_validation_t1 <- Validation_residuals_t1$LT10
d_gls10_validation_t1 <- d(Model10.gls_predicted_validation_t1, Model10.gls_observed_validation_t1)

Model50.gls_predicted_validation_t1 <- Validation_residuals_t1$Model50.m_Predict
Model50.gls_observed_validation_t1 <- Validation_residuals_t1$LT50
d_gls50_validation_t1 <- d(Model50.gls_predicted_validation_t1, Model50.gls_observed_validation_t1)

Model90.gls_predicted_validation_t1 <- Validation_residuals_t1$Model90.m_Predict
Model90.gls_observed_validation_t1 <- Validation_residuals_t1$LT90
d_gls90_validation_t1 <- d(Model90.gls_predicted_validation_t1, Model90.gls_observed_validation_t1)


Model1.d_validation_t1 <- as.data.frame(rbind(d_gls10_validation_t1, d_gls50_validation_t1, d_gls90_validation_t1))
Model1.d_validation_t1 <- Model1.d_validation_t1 %>% 
  rename(d = V1)
Model1.d_validation_t1 <- Model1.d_validation_t1 %>% mutate_if(is.numeric, ~round(., 2))

```

* * *
# (1:1): Publication Figures
Combine models for forcing units <30 and >=30

```{R, echo = FALSE}
par(pty="s")

# all seasons
Validation_residuals_t1$colour <- 'black'
Validation_residuals_t2$colour <- 'blue'
Validation_residuals <- rbind(Validation_residuals_t1, Validation_residuals_t2) 
Validation_residuals <- Validation_residuals %>% mutate_if(is.numeric, ~round(., 2))

par(mfrow=c(1,3)) 
par(pty="s")
Model10.split.AllSeasons <- lm(Model10.m_Predict ~ LT10, data=Validation_residuals)
Model10.split.AllSeasons.sum <- summary(lm(Model10.m_Predict ~ LT10, data=Validation_residuals))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict ~ LT10, data=Validation_residuals,
     # main="LT10",
     pch=20,
     font.main = 1, #removes bold title
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= expression("Predicted Temperature (" * degree * C *")"),
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Validation_residuals$colour)
abline(lm(Model10.m_Predict ~ LT10, data=Validation_residuals), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model50.split.AllSeasons <- lm(Model50.m_Predict ~ LT50, data=Validation_residuals)
Model50.split.AllSeasons.sum <- summary(lm(Model50.m_Predict ~ LT50, data=Validation_residuals))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict ~ LT50, data=Validation_residuals,
     # main="LT50",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Validation_residuals$colour)
abline(lm(Model50.m_Predict ~ LT50, data=Validation_residuals), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model90.split.AllSeasons <- lm(Model90.m_Predict ~ LT90, data=Validation_residuals)
Model90.split.AllSeasons.sum <- summary(lm(Model90.m_Predict ~ LT90, data=Validation_residuals))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict ~ LT90, data=Validation_residuals,
     # main="LT90",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Validation_residuals$colour)
abline(lm(Model90.m_Predict ~ LT90, data=Validation_residuals), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)


# save width as 4.5 x 11.5 inches
```


***
# Full Model Validation - SWEETHEART: Publication Figures (with damage)
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
par(mfrow=c(3,3))
par(pty="m") # resets par to old conditions

# Low-elevation (Slater)

plot(Sl3$Date, Sl3$LT10,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT10_Sl3.1$Date, rev(PredictLT10_Sl3.1$Date)), c(PredictLT10_Sl3.1$LT10.CILower, rev(PredictLT10_Sl3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sl3.2$Date, rev(PredictLT10_Sl3.2$Date)), c(PredictLT10_Sl3.2$LT10.CILower, rev(PredictLT10_Sl3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sl3.1$Date, PredictLT10_Sl3.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sl3.1$Colour)
    lines(PredictLT10_Sl3.2$Date, PredictLT10_Sl3.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sl3.2$Colour)
    lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -26, "0", cex= 1.45, col="grey20")

    
plot(Sl3$Date, Sl3$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT50_Sl3.1$Date, rev(PredictLT50_Sl3.1$Date)), c(PredictLT50_Sl3.1$LT50.CILower, rev(PredictLT50_Sl3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sl3.2$Date, rev(PredictLT50_Sl3.2$Date)), c(PredictLT50_Sl3.2$LT50.CILower, rev(PredictLT50_Sl3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sl3.1$Date, PredictLT50_Sl3.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sl3.1$Colour)
    lines(PredictLT50_Sl3.2$Date, PredictLT50_Sl3.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sl3.2$Colour)
    lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -26, "0", cex= 1.45, col="grey20")


    
plot(Sl3$Date, Sl3$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT90_Sl3.1$Date, rev(PredictLT90_Sl3.1$Date)), c(PredictLT90_Sl3.1$LT90.CILower, rev(PredictLT90_Sl3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sl3.2$Date, rev(PredictLT90_Sl3.2$Date)), c(PredictLT90_Sl3.2$LT90.CILower, rev(PredictLT90_Sl3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sl3.1$Date, PredictLT90_Sl3.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sl3.1$Colour)
    lines(PredictLT90_Sl3.2$Date, PredictLT90_Sl3.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sl3.2$Colour)
    lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
        abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    text(as.Date('2021-12-21'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    text(as.Date('2022-01-04'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    text(as.Date('2022-01-17'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    text(as.Date('2022-03-01'), -26, "0", cex= 1.45, col="grey20")
        # text(as.Date('2022-03-25'), -26, "2021-2022", cex = 1.65)
    # text(as.Date('2022-03-25'), -22, "Sweetheart", cex = 1.65)

    
# Mid-elevation (Martens)

plot(M2$Date, M2$LT10,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT10_M2.1$Date, rev(PredictLT10_M2.1$Date)), c(PredictLT10_M2.1$LT10.CILower, rev(PredictLT10_M2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_M2.2$Date, rev(PredictLT10_M2.2$Date)), c(PredictLT10_M2.2$LT10.CILower, rev(PredictLT10_M2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_M2.1$Date, PredictLT10_M2.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_M2.1$Colour)
    lines(PredictLT10_M2.2$Date, PredictLT10_M2.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_M2.2$Colour)
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3')
        abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -26, "0", cex= 1.45, col="grey20") # actual measure was 0.3 but will round to nearest decimal place
    
plot(M2$Date, M2$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT50_M2.1$Date, rev(PredictLT50_M2.1$Date)), c(PredictLT50_M2.1$LT50.CILower, rev(PredictLT50_M2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M2.2$Date, rev(PredictLT50_M2.2$Date)), c(PredictLT50_M2.2$LT50.CILower, rev(PredictLT50_M2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M2.1$Date, PredictLT50_M2.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_M2.1$Colour)
    lines(PredictLT50_M2.2$Date, PredictLT50_M2.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_M2.2$Colour)
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
               abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -26, "0", cex= 1.45, col="grey20")
    

    
    
plot(M2$Date, M2$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT90_M2.1$Date, rev(PredictLT90_M2.1$Date)), c(PredictLT90_M2.1$LT90.CILower, rev(PredictLT90_M2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_M2.2$Date, rev(PredictLT90_M2.2$Date)), c(PredictLT90_M2.2$LT90.CILower, rev(PredictLT90_M2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_M2.1$Date, PredictLT90_M2.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_M2.1$Colour)
    lines(PredictLT90_M2.2$Date, PredictLT90_M2.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_M2.2$Colour)
    lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3')
    abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    text(as.Date('2020-10-26'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    text(as.Date('2021-01-25'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -26, "0", cex= 1.45, col="grey20")
            # text(as.Date('2021-03-25'), -26, "2020-2021", cex = 1.65)
    # text(as.Date('2021-03-25'), -22, "Sweetheart", cex = 1.65)
    
    
# High-elevation (Savanna)
plot(Sa2$Date, Sa2$LT10,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT10_Sa2.1$Date, rev(PredictLT10_Sa2.1$Date)), c(PredictLT10_Sa2.1$LT10.CILower, rev(PredictLT10_Sa2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sa2.2$Date, rev(PredictLT10_Sa2.2$Date)), c(PredictLT10_Sa2.2$LT10.CILower, rev(PredictLT10_Sa2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sa2.1$Date, PredictLT10_Sa2.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sa2.1$Colour)
    lines(PredictLT10_Sa2.2$Date, PredictLT10_Sa2.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sa2.2$Colour)
          lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
        abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    text(as.Date('2020-10-27'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # text(as.Date('2021-01-25'), -26, "1", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -26, "6", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -26, "18", cex= 1.45, col="grey20")
   
    
plot(Sa2$Date, Sa2$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT50_Sa2.1$Date, rev(PredictLT50_Sa2.1$Date)), c(PredictLT50_Sa2.1$LT50.CILower, rev(PredictLT50_Sa2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa2.2$Date, rev(PredictLT50_Sa2.2$Date)), c(PredictLT50_Sa2.2$LT50.CILower, rev(PredictLT50_Sa2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa2.1$Date, PredictLT50_Sa2.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sa2.1$Colour)
    lines(PredictLT50_Sa2.2$Date, PredictLT50_Sa2.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sa2.2$Colour)
              lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
        abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    text(as.Date('2020-10-27'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # text(as.Date('2021-01-25'), -26, "1", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -26, "6", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -26, "18", cex= 1.45, col="grey20")
    
    
    
plot(Sa2$Date, Sa2$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT90_Sa2.1$Date, rev(PredictLT90_Sa2.1$Date)), c(PredictLT90_Sa2.1$LT90.CILower, rev(PredictLT90_Sa2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sa2.2$Date, rev(PredictLT90_Sa2.2$Date)), c(PredictLT90_Sa2.2$LT90.CILower, rev(PredictLT90_Sa2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sa2.1$Date, PredictLT90_Sa2.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sa2.1$Colour)
    lines(PredictLT90_Sa2.2$Date, PredictLT90_Sa2.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sa2.2$Colour)
              lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
        abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    text(as.Date('2020-10-27'), -26, "0", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # text(as.Date('2021-01-25'), -26, "1", cex= 1.45, col="grey20")
        abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    text(as.Date('2021-02-08'), -26, "0", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    text(as.Date('2021-02-22'), -26, "6", cex= 1.45, col="grey20")
            abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    text(as.Date('2021-03-09'), -26, "18", cex= 1.45, col="grey20")
        # text(as.Date('2021-03-25'), -26, "2020-2021", cex = 1.65)
    # text(as.Date('2021-03-25'), -22, "Sweetheart", cex = 1.65)
    
# save as 9x15s
```


***
# Full Model Validation - SWEETHEART: Publication Figures (without damage)
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
par(mfrow=c(3,3))
par(pty="m") # resets par to old conditions

# Low-elevation (Slater)

plot(Sl3$Date, Sl3$LT10,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT10_Sl3.1$Date, rev(PredictLT10_Sl3.1$Date)), c(PredictLT10_Sl3.1$LT10.CILower, rev(PredictLT10_Sl3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sl3.2$Date, rev(PredictLT10_Sl3.2$Date)), c(PredictLT10_Sl3.2$LT10.CILower, rev(PredictLT10_Sl3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sl3.1$Date, PredictLT10_Sl3.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sl3.1$Colour)
    lines(PredictLT10_Sl3.2$Date, PredictLT10_Sl3.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sl3.2$Colour)
    # lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #     abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    # text(as.Date('2021-12-21'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    # text(as.Date('2022-01-04'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    # text(as.Date('2022-01-17'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    # text(as.Date('2022-03-01'), -26, "0", cex= 1.45, col="grey20")

    
plot(Sl3$Date, Sl3$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT50_Sl3.1$Date, rev(PredictLT50_Sl3.1$Date)), c(PredictLT50_Sl3.1$LT50.CILower, rev(PredictLT50_Sl3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sl3.2$Date, rev(PredictLT50_Sl3.2$Date)), c(PredictLT50_Sl3.2$LT50.CILower, rev(PredictLT50_Sl3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sl3.1$Date, PredictLT50_Sl3.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sl3.1$Colour)
    lines(PredictLT50_Sl3.2$Date, PredictLT50_Sl3.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sl3.2$Colour)
    # lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #     abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    # text(as.Date('2021-12-21'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    # text(as.Date('2022-01-04'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    # text(as.Date('2022-01-17'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    # text(as.Date('2022-03-01'), -26, "0", cex= 1.45, col="grey20")


    
plot(Sl3$Date, Sl3$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT90_Sl3.1$Date, rev(PredictLT90_Sl3.1$Date)), c(PredictLT90_Sl3.1$LT90.CILower, rev(PredictLT90_Sl3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sl3.2$Date, rev(PredictLT90_Sl3.2$Date)), c(PredictLT90_Sl3.2$LT90.CILower, rev(PredictLT90_Sl3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sl3.1$Date, PredictLT90_Sl3.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sl3.1$Colour)
    lines(PredictLT90_Sl3.2$Date, PredictLT90_Sl3.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sl3.2$Colour)
    # lines(Sl3$Date, Sl3$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #     abline(v=as.Date('2021-12-21'), col="grey80", lty=2)
    # text(as.Date('2021-12-21'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-01-04'), col="grey80", lty=2)
    # text(as.Date('2022-01-04'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-01-17'), col="grey80", lty=2)
    # text(as.Date('2022-01-17'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2022-03-01'), col="grey80", lty=2)
    # text(as.Date('2022-03-01'), -26, "0", cex= 1.45, col="grey20")
    #     # text(as.Date('2022-03-25'), -26, "2021-2022", cex = 1.65)
    # # text(as.Date('2022-03-25'), -22, "Sweetheart", cex = 1.65)

    
# Mid-elevation (Martens)

plot(M2$Date, M2$LT10,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT10_M2.1$Date, rev(PredictLT10_M2.1$Date)), c(PredictLT10_M2.1$LT10.CILower, rev(PredictLT10_M2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_M2.2$Date, rev(PredictLT10_M2.2$Date)), c(PredictLT10_M2.2$LT10.CILower, rev(PredictLT10_M2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_M2.1$Date, PredictLT10_M2.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_M2.1$Colour)
    lines(PredictLT10_M2.2$Date, PredictLT10_M2.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_M2.2$Colour)
    # lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3')
    #     abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    # text(as.Date('2020-10-26'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    # text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # text(as.Date('2021-01-25'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    # text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    # text(as.Date('2021-02-22'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    # text(as.Date('2021-03-09'), -26, "0", cex= 1.45, col="grey20") # actual measure was 0.3 but will round to nearest decimal place
    
plot(M2$Date, M2$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT50_M2.1$Date, rev(PredictLT50_M2.1$Date)), c(PredictLT50_M2.1$LT50.CILower, rev(PredictLT50_M2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M2.2$Date, rev(PredictLT50_M2.2$Date)), c(PredictLT50_M2.2$LT50.CILower, rev(PredictLT50_M2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M2.1$Date, PredictLT50_M2.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_M2.1$Colour)
    lines(PredictLT50_M2.2$Date, PredictLT50_M2.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_M2.2$Colour)
    # lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #            abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    # text(as.Date('2020-10-26'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    # text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # text(as.Date('2021-01-25'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    # text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    # text(as.Date('2021-02-22'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    # text(as.Date('2021-03-09'), -26, "0", cex= 1.45, col="grey20")
    

    
    
plot(M2$Date, M2$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT90_M2.1$Date, rev(PredictLT90_M2.1$Date)), c(PredictLT90_M2.1$LT90.CILower, rev(PredictLT90_M2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_M2.2$Date, rev(PredictLT90_M2.2$Date)), c(PredictLT90_M2.2$LT90.CILower, rev(PredictLT90_M2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_M2.1$Date, PredictLT90_M2.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_M2.1$Colour)
    lines(PredictLT90_M2.2$Date, PredictLT90_M2.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_M2.2$Colour)
    # lines(M2$Date, M2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3')
    # abline(v=as.Date('2020-10-26'), col="grey80", lty=2)
    # text(as.Date('2020-10-26'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    # text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # text(as.Date('2021-01-25'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    # text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    # text(as.Date('2021-02-22'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    # text(as.Date('2021-03-09'), -26, "0", cex= 1.45, col="grey20")
    #         # text(as.Date('2021-03-25'), -26, "2020-2021", cex = 1.65)
    # # text(as.Date('2021-03-25'), -22, "Sweetheart", cex = 1.65)
    
    
# High-elevation (Savanna)
plot(Sa2$Date, Sa2$LT10,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT10_Sa2.1$Date, rev(PredictLT10_Sa2.1$Date)), c(PredictLT10_Sa2.1$LT10.CILower, rev(PredictLT10_Sa2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_Sa2.2$Date, rev(PredictLT10_Sa2.2$Date)), c(PredictLT10_Sa2.2$LT10.CILower, rev(PredictLT10_Sa2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Sa2.1$Date, PredictLT10_Sa2.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sa2.1$Colour)
    lines(PredictLT10_Sa2.2$Date, PredictLT10_Sa2.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_Sa2.2$Colour)
    #       lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #     abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    # text(as.Date('2020-10-27'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    # text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    # #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # # text(as.Date('2021-01-25'), -26, "1", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    # text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    # text(as.Date('2021-02-22'), -26, "6", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    # text(as.Date('2021-03-09'), -26, "18", cex= 1.45, col="grey20")
   
    
plot(Sa2$Date, Sa2$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT50_Sa2.1$Date, rev(PredictLT50_Sa2.1$Date)), c(PredictLT50_Sa2.1$LT50.CILower, rev(PredictLT50_Sa2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_Sa2.2$Date, rev(PredictLT50_Sa2.2$Date)), c(PredictLT50_Sa2.2$LT50.CILower, rev(PredictLT50_Sa2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Sa2.1$Date, PredictLT50_Sa2.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sa2.1$Colour)
    lines(PredictLT50_Sa2.2$Date, PredictLT50_Sa2.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_Sa2.2$Colour)
    #           lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #     abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    # text(as.Date('2020-10-27'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    # text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    # #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # # text(as.Date('2021-01-25'), -26, "1", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    # text(as.Date('2021-02-10'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    # text(as.Date('2021-02-22'), -26, "6", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    # text(as.Date('2021-03-09'), -26, "18", cex= 1.45, col="grey20")
    
    
    
plot(Sa2$Date, Sa2$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3))
    polygon(c(PredictLT90_Sa2.1$Date, rev(PredictLT90_Sa2.1$Date)), c(PredictLT90_Sa2.1$LT90.CILower, rev(PredictLT90_Sa2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_Sa2.2$Date, rev(PredictLT90_Sa2.2$Date)), c(PredictLT90_Sa2.2$LT90.CILower, rev(PredictLT90_Sa2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Sa2.1$Date, PredictLT90_Sa2.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sa2.1$Colour)
    lines(PredictLT90_Sa2.2$Date, PredictLT90_Sa2.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_Sa2.2$Colour)
    #           lines(Sa2$Date, Sa2$Temp_min, lty = 1, lwd=0.9, col = 'tomato3') 
    #     abline(v=as.Date('2020-10-27'), col="grey80", lty=2)
    # text(as.Date('2020-10-27'), -26, "0", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-01-18'), col="grey80", lty=2)
    # text(as.Date('2021-01-18'), -26, "0", cex= 1.45, col="grey20")
    # #     abline(v=as.Date('2021-01-25'), col="grey80", lty=2)
    # # text(as.Date('2021-01-25'), -26, "1", cex= 1.45, col="grey20")
    #     abline(v=as.Date('2021-02-10'), col="grey80", lty=2)
    # text(as.Date('2021-02-08'), -26, "0", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-02-22'), col="grey80", lty=2)
    # text(as.Date('2021-02-22'), -26, "6", cex= 1.45, col="grey20")
    #         abline(v=as.Date('2021-03-09'), col="grey80", lty=2)
    # text(as.Date('2021-03-09'), -26, "18", cex= 1.45, col="grey20")
    #     # text(as.Date('2021-03-25'), -26, "2020-2021", cex = 1.65)
    # # text(as.Date('2021-03-25'), -22, "Sweetheart", cex = 1.65)
    
# save as 9x15s
```


***
# Look at low temperature events where damage was expected to occur

```{R echo = FALSE}
# Low Elevation (Slater)

Sl_low_temps <- merge(PredictLT10_Sl3.1, Sl3, by = c('Date'))
Sl_low_temps <- merge(PredictLT50_Sl3.1, Sl_low_temps, by = c('Date'))
Sl_low_temps <- merge(PredictLT90_Sl3.1, Sl_low_temps, by = c('Date'))

Sl_low_temps <- Sl_low_temps %>% mutate_if(is.numeric, ~round(., 0))

# if Temp_min is lower than LT10.x, assign Below_LT10 to 'yes' # the .x are the predicted values, .y are the observed values
# if Temp_min is lower than LT50.x, assign Below_LT50 to 'yes'
# if Temp_min is lower than LT90.x, assign Below_LT90 to 'yes'

Sl_low_temps$Below_LT10 <- ifelse(Sl_low_temps$LT10.x > Sl_low_temps$Temp_min, 'yes', 'no')
Sl_low_temps$Below_LT50 <- ifelse(Sl_low_temps$LT50.x > Sl_low_temps$Temp_min, 'yes', 'no')
Sl_low_temps$Below_LT90 <- ifelse(Sl_low_temps$LT90.x > Sl_low_temps$Temp_min, 'yes', 'no')

Sl_low_temps_yes <- subset(Sl_low_temps, Below_LT10 == "yes" |  Below_LT50 == "yes" | Below_LT90 == "yes")


Sl_low_temps_yes = subset(Sl_low_temps_yes, select = c(LT10.x, LT50.x, LT90.x, LT10.y, LT50.y, LT90.y, Temp_min, Below_LT10, Below_LT50, Below_LT90, Date))

Sl_low_temps_yes

# Mid Elevation (Martens)
PredictLT10_M2.1
M2NA <- na.omit(M2)
M_low_temps <- merge(PredictLT10_M2.1, M2, by = c('Date'))
M_low_temps <- merge(PredictLT50_M2.1, M_low_temps, by = c('Date'))
M_low_temps <- merge(PredictLT90_M2.1, M_low_temps, by = c('Date'))

M_low_temps <- M_low_temps %>% mutate_if(is.numeric, ~round(., 0))

# if Temp_min is lower than LT10.x, assign Below_LT10 to 'yes' # the .x are the predicted values, .y are the observed values
# if Temp_min is lower than LT50.x, assign Below_LT50 to 'yes'
# if Temp_min is lower than LT90.x, assign Below_LT90 to 'yes'

M_low_temps$Below_LT10 <- ifelse(M_low_temps$LT10.x > M_low_temps$Temp_min, 'yes', 'no')
M_low_temps$Below_LT50 <- ifelse(M_low_temps$LT50.x > M_low_temps$Temp_min, 'yes', 'no')
M_low_temps$Below_LT90 <- ifelse(M_low_temps$LT90.x > M_low_temps$Temp_min, 'yes', 'no')

M_low_temps_yes <- subset(M_low_temps, Below_LT10 == "yes" |  Below_LT50 == "yes" | Below_LT90 == "yes")


M_low_temps_yes = subset(M_low_temps_yes, select = c(LT10.x, LT50.x, LT90.x, LT10.y, LT50.y, LT90.y, Temp_min, Below_LT10, Below_LT50, Below_LT90, Date))

M_low_temps_yes
# High Elevation (Savanna)
PredictLT10_Sa2.1
Sa2NA <- na.omit(Sa2)
Sa_low_temps <- merge(PredictLT10_Sa2.1, Sa2, by = c('Date'))
Sa_low_temps <- merge(PredictLT50_Sa2.1, Sa_low_temps, by = c('Date'))
Sa_low_temps <- merge(PredictLT90_Sa2.1, Sa_low_temps, by = c('Date'))

Sa_low_temps <- Sa_low_temps %>% mutate_if(is.numeric, ~round(., 0))

# if Temp_min is lower than LT10.x, assign Below_LT10 to 'yes' # the .x are the predicted values, .y are the observed values
# if Temp_min is lower than LT50.x, assign Below_LT50 to 'yes'
# if Temp_min is lower than LT90.x, assign Below_LT90 to 'yes'

Sa_low_temps$Below_LT10 <- ifelse(Sa_low_temps$LT10.x > Sa_low_temps$Temp_min, 'yes', 'no')
Sa_low_temps$Below_LT50 <- ifelse(Sa_low_temps$LT50.x > Sa_low_temps$Temp_min, 'yes', 'no')
Sa_low_temps$Below_LT90 <- ifelse(Sa_low_temps$LT90.x > Sa_low_temps$Temp_min, 'yes', 'no')

Sa_low_temps_yes <- subset(Sa_low_temps, Below_LT10 == "yes" |  Below_LT50 == "yes" | Below_LT90 == "yes")


Sa_low_temps_yes = subset(Sa_low_temps_yes, select = c(LT10.x, LT50.x, LT90.x, LT10.y, LT50.y, LT90.y, Temp_min, Below_LT10, Below_LT50, Below_LT90, Date))

Sa_low_temps_yes
```

***
# Publication LEGEND
Combine models for forcing units <30 and >=30

```{R echo = FALSE}

par(mfrow=c(1,1))
par(pty="m") # resets par to old conditions
# Plot Season4

 
plot(Sa2$Date, Sa2$LT90,
         main= "",
         pch= 20,
         xlab="", 
         ylab=expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27, -3), 
     col= "white")
legend(x = as.Date("2020-08-24"), y = -20,         # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("   Observed LT"),  # Legend texts
       pch = c(20),           # dot
       col  = c("black"))

legend(x = as.Date("2020-10-20"), y = -20,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("Daily Minimum Temperature"),  # Legend texts
       lty = 1,
       lwd=1.25,
       col  = c("tomato 3"),
       seg.len = 1.75) #line length



legend(x = as.Date("2020-08-20"), y = -22,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t1 Predicted LT"),  # Legend texts
       lty = 1,
       lwd=1.25,
       col  = c("black"),
       seg.len = 1.75) #line length
legend(x = as.Date("2020-08-20"), y = -24,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t2 Predicted LT"),  # Legend texts
       lty = 1,
       lwd=1.25,
       col  = c("blue"),
       seg.len = 1.75) #line length
legend(x = as.Date("2020-10-20"), y = -22,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t1 95% Confidence Limit"),  # Legend texts
       lty = 1,
       lwd=8,
       col=rgb(0, 0, 0,0.20),
       seg.len = 1.75) #line length
legend(x = as.Date("2020-10-20"), y = -24,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t2 95% Confidence Limit"),  # Legend texts
       lty = 1,
       lwd=8,
       col=rgb(0, 0, 1,0.15),
       seg.len = 1.75) #line length
par(mar = c(3, 5, 1, 1.5)) 

# save as 6x11
```

***
# 14.0 Full Model Application to Other Varieties
Apply 'Sweetheart' models for LT10, LT50, and LT90 to the varieties 'Staccato', 'Sonata', and 'Skeena'

***
## 14.1 Staccato
```{r, echo=FALSE, out.width="30%"}
Stac1 <- subset(Staccato, Sweetheart_cherry_forcingBB_final < 30)
Stac2 <- subset(Staccato, Sweetheart_cherry_forcingBB_final >= 30)

## Staccato
# Staccato LT10 Season 1 Model 1
PredictLT10_Stac1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Stac1, se= TRUE))
    PredictLT10_Stac1$LT10.CIUpper <- (PredictLT10_Stac1$fit + PredictLT10_Stac1$se.fit*1.96)
    PredictLT10_Stac1$LT10.CILower <- (PredictLT10_Stac1$fit - PredictLT10_Stac1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Stac1$Date <- Stac1$Date
    # rename fit to LT50
    PredictLT10_Stac1 <- PredictLT10_Stac1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Stac1 <- PredictLT10_Stac1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Stac1$Colour = "black"
    
# # Staccato LT10 Season 1 Model 2
# PredictLT10_Stac2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Stac2, se= TRUE))
#     PredictLT10_Stac2$LT10.CIUpper <- (PredictLT10_Stac2$fit + PredictLT10_Stac2$se.fit*1.96)
#     PredictLT10_Stac2$LT10.CILower <- (PredictLT10_Stac2$fit - PredictLT10_Stac2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Stac2$Date <- Stac2$Date
#     # rename fit to LT50
#     PredictLT10_Stac2 <- PredictLT10_Stac2 %>%
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Stac2 <- PredictLT10_Stac2 %>%
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Stac2$Colour = "mediumblue"
    
PredictLT10_Stac1 <- PredictLT10_Stac1


# Staccato LT50 Season 1 Model 1
PredictLT50_Stac1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Stac1, se= TRUE))
    PredictLT50_Stac1$LT50.CIUpper <- (PredictLT50_Stac1$fit + PredictLT50_Stac1$se.fit*1.96)
    PredictLT50_Stac1$LT50.CILower <- (PredictLT50_Stac1$fit - PredictLT50_Stac1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Stac1$Date <- Stac1$Date
    # rename fit to LT50
    PredictLT50_Stac1 <- PredictLT50_Stac1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Stac1 <- PredictLT50_Stac1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Stac1$Colour = "black"
    
# Staccato LT50 Season 1 Model 2
# PredictLT50_Stac2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Stac2, se= TRUE))
#     PredictLT50_Stac2$LT50.CIUpper <- (PredictLT50_Stac2$fit + PredictLT50_Stac2$se.fit*1.96)
#     PredictLT50_Stac2$LT50.CILower <- (PredictLT50_Stac2$fit - PredictLT50_Stac2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Stac2$Date <- Stac2$Date
#     # rename fit to LT50
#     PredictLT50_Stac2 <- PredictLT50_Stac2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Stac2 <- PredictLT50_Stac2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Stac2$Colour = "mediumblue"
    
PredictLT50_Stac1 <- PredictLT50_Stac1
    
    # Staccato LT90 Season 1 Model 1
PredictLT90_Stac1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Stac1, se= TRUE))
    PredictLT90_Stac1$LT90.CIUpper <- (PredictLT90_Stac1$fit + PredictLT90_Stac1$se.fit*1.96)
    PredictLT90_Stac1$LT90.CILower <- (PredictLT90_Stac1$fit - PredictLT90_Stac1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Stac1$Date <- Stac1$Date
    # rename fit to LT50
    PredictLT90_Stac1 <- PredictLT90_Stac1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Stac1 <- PredictLT90_Stac1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Stac1$Colour = "black"
    
# Staccato LT90 Season 1 Model 2
# PredictLT90_Stac2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Stac2, se= TRUE))
#     PredictLT90_Stac2$LT90.CIUpper <- (PredictLT90_Stac2$fit + PredictLT90_Stac2$se.fit*1.96)
#     PredictLT90_Stac2$LT90.CILower <- (PredictLT90_Stac2$fit - PredictLT90_Stac2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Stac2$Date <- Stac2$Date
#     # rename fit to LT50
#     PredictLT90_Stac2 <- PredictLT90_Stac2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Stac2 <- PredictLT90_Stac2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Stac2$Colour = "mediumblue"
    
    
PredictLT90_Stac1 <- PredictLT90_Stac1



plot(Staccato$Date, Staccato$LT10,
         main= "LT10 Model Validation: Staccato 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Stac1$Date, rev(PredictLT10_Stac1$Date)), c(PredictLT10_Stac1$LT10.CILower, rev(PredictLT10_Stac1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Stac2$Date, rev(PredictLT10_Stac2$Date)), c(PredictLT10_Stac2$LT10.CILower, rev(PredictLT10_Stac2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Stac1$Date, PredictLT10_Stac1$LT10, lty = 1, lwd=1, col = PredictLT10_Stac1$Colour)
    # lines(PredictLT10_Stac2$Date, PredictLT10_Stac2$LT10, lty = 1, lwd=1, col = PredictLT10_Stac2$Colour)
    
    
plot(Staccato$Date, Staccato$LT50,
         main= "LT50 Model Validation: Staccato 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Stac1$Date, rev(PredictLT50_Stac1$Date)), c(PredictLT50_Stac1$LT50.CILower, rev(PredictLT50_Stac1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Stac2$Date, rev(PredictLT50_Stac2$Date)), c(PredictLT50_Stac2$LT50.CILower, rev(PredictLT50_Stac2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Stac1$Date, PredictLT50_Stac1$LT50, lty = 1, lwd=1, col = PredictLT50_Stac1$Colour)
    # lines(PredictLT50_Stac2$Date, PredictLT50_Stac2$LT50, lty = 1, lwd=1, col = PredictLT50_Stac2$Colour)
    
    
plot(Staccato$Date, Staccato$LT90,
         main= "LT90 Model Validation: Staccato 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Stac1$Date, rev(PredictLT90_Stac1$Date)), c(PredictLT90_Stac1$LT90.CILower, rev(PredictLT90_Stac1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Stac2$Date, rev(PredictLT90_Stac2$Date)), c(PredictLT90_Stac2$LT90.CILower, rev(PredictLT90_Stac2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Stac1$Date, PredictLT90_Stac1$LT90, lty = 1, lwd=1, col = PredictLT90_Stac1$Colour)
    # lines(PredictLT90_Stac2$Date, PredictLT90_Stac2$LT90, lty = 1, lwd=1, col = PredictLT90_Stac2$Colour)
    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Staccato <- as.data.frame(predict(Model10.m, newdata= Stac1, se= TRUE))
Model10.m_Predict.Staccato <- Model10.m_Predict.Staccato %>% dplyr::rename("Model10.m_Predict.Staccato"="fit")
Model10.m_Predict.Staccato <- Model10.m_Predict.Staccato %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Staccato <- as.data.frame(predict(Model50.m, newdata= Stac1, se= TRUE))
Model50.m_Predict.Staccato <- Model50.m_Predict.Staccato %>% dplyr::rename("Model50.m_Predict.Staccato"="fit")
Model50.m_Predict.Staccato <- Model50.m_Predict.Staccato %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Staccato <- as.data.frame(predict(Model90.m, newdata= Stac1, se= TRUE))
Model90.m_Predict.Staccato <- Model90.m_Predict.Staccato %>% dplyr::rename("Model90.m_Predict.Staccato"="fit")
Model90.m_Predict.Staccato <- Model90.m_Predict.Staccato %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Staccato.1 <- cbind(Stac1, 
                         Model10.m_Predict.Staccato, 
                         Model50.m_Predict.Staccato, 
                         Model90.m_Predict.Staccato)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Staccato.2 <- as.data.frame(predict(Model10.m2, newdata= Stac2, se= TRUE))
Model10.m2_Predict.Staccato.2 <- Model10.m2_Predict.Staccato.2 %>% dplyr::rename("Model10.m_Predict.Staccato"="fit")
Model10.m2_Predict.Staccato.2 <- Model10.m2_Predict.Staccato.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Staccato.2 <- as.data.frame(predict(Model50.m2, newdata= Stac2, se= TRUE))
Model50.m2_Predict.Staccato.2 <- Model50.m2_Predict.Staccato.2 %>% dplyr::rename("Model50.m_Predict.Staccato"="fit")
Model50.m2_Predict.Staccato.2 <- Model50.m2_Predict.Staccato.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Staccato.2 <- as.data.frame(predict(Model90.m2, newdata= Stac2, se= TRUE))
Model90.m2_Predict.Staccato.2 <- Model90.m2_Predict.Staccato.2 %>% dplyr::rename("Model90.m_Predict.Staccato"="fit")
Model90.m2_Predict.Staccato.2 <- Model90.m2_Predict.Staccato.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Staccato.2 <- cbind(Stac2, 
                         Model10.m2_Predict.Staccato.2, 
                         Model50.m2_Predict.Staccato.2, 
                         Model90.m2_Predict.Staccato.2)


Predict.Staccato <- rbind(Predict.Staccato.1, Predict.Staccato.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Staccato~ LT10, data=Predict.Staccato)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Staccato~ LT10, data=Predict.Staccato))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Staccato ~ LT10, data=Predict.Staccato,
     main="LT10: Staccato 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Staccato ~ LT10, data=Predict.Staccato), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Staccato~ LT50, data=Predict.Staccato)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Staccato~ LT50, data=Predict.Staccato))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Staccato ~ LT50, data=Predict.Staccato,
     main="LT50: Staccato 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Staccato ~ LT50, data=Predict.Staccato), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Staccato~ LT90, data=Predict.Staccato)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Staccato~ LT90, data=Predict.Staccato))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Staccato ~ LT90, data=Predict.Staccato,
     main="LT90: Staccato 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Staccato ~ LT90, data=Predict.Staccato), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

***
## 14.2 Sonata
```{r, echo=FALSE, out.width="30%"}
Son1 <- subset(Sonata, Sweetheart_cherry_forcingBB_final < 30)
Son2 <- subset(Sonata, Sweetheart_cherry_forcingBB_final >= 30)

## Sonata
# Sonata LT10 Season 1 Model 1
PredictLT10_Son1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Son1, se= TRUE))
    PredictLT10_Son1$LT10.CIUpper <- (PredictLT10_Son1$fit + PredictLT10_Son1$se.fit*1.96)
    PredictLT10_Son1$LT10.CILower <- (PredictLT10_Son1$fit - PredictLT10_Son1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Son1$Date <- Son1$Date
    # rename fit to LT50
    PredictLT10_Son1 <- PredictLT10_Son1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Son1 <- PredictLT10_Son1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Son1$Colour = "black"
    
# Sonata LT10 Season 1 Model 2
# PredictLT10_Son2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Son2, se= TRUE))
#     PredictLT10_Son2$LT10.CIUpper <- (PredictLT10_Son2$fit + PredictLT10_Son2$se.fit*1.96)
#     PredictLT10_Son2$LT10.CILower <- (PredictLT10_Son2$fit - PredictLT10_Son2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Son2$Date <- Son2$Date
#     # rename fit to LT50
#     PredictLT10_Son2 <- PredictLT10_Son2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Son2 <- PredictLT10_Son2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Son2$Colour = "mediumblue"
    
    
PredictLT10_Son1 <- PredictLT10_Son1


# Sonata LT50 Season 1 Model 1
PredictLT50_Son1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Son1, se= TRUE))
    PredictLT50_Son1$LT50.CIUpper <- (PredictLT50_Son1$fit + PredictLT50_Son1$se.fit*1.96)
    PredictLT50_Son1$LT50.CILower <- (PredictLT50_Son1$fit - PredictLT50_Son1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Son1$Date <- Son1$Date
    # rename fit to LT50
    PredictLT50_Son1 <- PredictLT50_Son1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Son1 <- PredictLT50_Son1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Son1$Colour = "black"
    
# Sonata LT50 Season 1 Model 2
# PredictLT50_Son2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Son2, se= TRUE))
#     PredictLT50_Son2$LT50.CIUpper <- (PredictLT50_Son2$fit + PredictLT50_Son2$se.fit*1.96)
#     PredictLT50_Son2$LT50.CILower <- (PredictLT50_Son2$fit - PredictLT50_Son2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Son2$Date <- Son2$Date
#     # rename fit to LT50
#     PredictLT50_Son2 <- PredictLT50_Son2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Son2 <- PredictLT50_Son2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Son2$Colour = "mediumblue"
    
PredictLT50_Son1 <- PredictLT50_Son1
    
    # Sonata LT90 Season 1 Model 1
PredictLT90_Son1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Son1, se= TRUE))
    PredictLT90_Son1$LT90.CIUpper <- (PredictLT90_Son1$fit + PredictLT90_Son1$se.fit*1.96)
    PredictLT90_Son1$LT90.CILower <- (PredictLT90_Son1$fit - PredictLT90_Son1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Son1$Date <- Son1$Date
    # rename fit to LT50
    PredictLT90_Son1 <- PredictLT90_Son1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Son1 <- PredictLT90_Son1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Son1$Colour = "black"
    
# Sonata LT90 Season 1 Model 2
# PredictLT90_Son2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Son2, se= TRUE))
#     PredictLT90_Son2$LT90.CIUpper <- (PredictLT90_Son2$fit + PredictLT90_Son2$se.fit*1.96)
#     PredictLT90_Son2$LT90.CILower <- (PredictLT90_Son2$fit - PredictLT90_Son2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Son2$Date <- Son2$Date
#     # rename fit to LT50
#     PredictLT90_Son2 <- PredictLT90_Son2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Son2 <- PredictLT90_Son2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Son2$Colour = "mediumblue"
    
    
PredictLT90_Son1 <- PredictLT90_Son1



plot(Sonata$Date, Sonata$LT10,
         main= "LT10 Model Validation: Sonata 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Son1$Date, rev(PredictLT10_Son1$Date)), c(PredictLT10_Son1$LT10.CILower, rev(PredictLT10_Son1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Son2$Date, rev(PredictLT10_Son2$Date)), c(PredictLT10_Son2$LT10.CILower, rev(PredictLT10_Son2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Son1$Date, PredictLT10_Son1$LT10, lty = 1, lwd=1, col = PredictLT10_Son1$Colour)
    # lines(PredictLT10_Son2$Date, PredictLT10_Son2$LT10, lty = 1, lwd=1, col = PredictLT10_Son2$Colour)
    
    
plot(Sonata$Date, Sonata$LT50,
         main= "LT50 Model Validation: Sonata 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Son1$Date, rev(PredictLT50_Son1$Date)), c(PredictLT50_Son1$LT50.CILower, rev(PredictLT50_Son1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Son2$Date, rev(PredictLT50_Son2$Date)), c(PredictLT50_Son2$LT50.CILower, rev(PredictLT50_Son2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Son1$Date, PredictLT50_Son1$LT50, lty = 1, lwd=1, col = PredictLT50_Son1$Colour)
    # lines(PredictLT50_Son2$Date, PredictLT50_Son2$LT50, lty = 1, lwd=1, col = PredictLT50_Son2$Colour)
    
    
plot(Sonata$Date, Sonata$LT90,
         main= "LT90 Model Validation: Sonata 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Son1$Date, rev(PredictLT90_Son1$Date)), c(PredictLT90_Son1$LT90.CILower, rev(PredictLT90_Son1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Son2$Date, rev(PredictLT90_Son2$Date)), c(PredictLT90_Son2$LT90.CILower, rev(PredictLT90_Son2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Son1$Date, PredictLT90_Son1$LT90, lty = 1, lwd=1, col = PredictLT90_Son1$Colour)
    # lines(PredictLT90_Son2$Date, PredictLT90_Son2$LT90, lty = 1, lwd=1, col = PredictLT90_Son2$Colour)
    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Sonata <- as.data.frame(predict(Model10.m, newdata= Son1, se= TRUE))
Model10.m_Predict.Sonata <- Model10.m_Predict.Sonata %>% dplyr::rename("Model10.m_Predict.Sonata"="fit")
Model10.m_Predict.Sonata <- Model10.m_Predict.Sonata %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Sonata <- as.data.frame(predict(Model50.m, newdata= Son1, se= TRUE))
Model50.m_Predict.Sonata <- Model50.m_Predict.Sonata %>% dplyr::rename("Model50.m_Predict.Sonata"="fit")
Model50.m_Predict.Sonata <- Model50.m_Predict.Sonata %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Sonata <- as.data.frame(predict(Model90.m, newdata= Son1, se= TRUE))
Model90.m_Predict.Sonata <- Model90.m_Predict.Sonata %>% dplyr::rename("Model90.m_Predict.Sonata"="fit")
Model90.m_Predict.Sonata <- Model90.m_Predict.Sonata %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sonata.1 <- cbind(Son1, 
                         Model10.m_Predict.Sonata, 
                         Model50.m_Predict.Sonata, 
                         Model90.m_Predict.Sonata)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Sonata.2 <- as.data.frame(predict(Model10.m2, newdata= Son2, se= TRUE))
Model10.m2_Predict.Sonata.2 <- Model10.m2_Predict.Sonata.2 %>% dplyr::rename("Model10.m_Predict.Sonata"="fit")
Model10.m2_Predict.Sonata.2 <- Model10.m2_Predict.Sonata.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Sonata.2 <- as.data.frame(predict(Model50.m2, newdata= Son2, se= TRUE))
Model50.m2_Predict.Sonata.2 <- Model50.m2_Predict.Sonata.2 %>% dplyr::rename("Model50.m_Predict.Sonata"="fit")
Model50.m2_Predict.Sonata.2 <- Model50.m2_Predict.Sonata.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Sonata.2 <- as.data.frame(predict(Model90.m2, newdata= Son2, se= TRUE))
Model90.m2_Predict.Sonata.2 <- Model90.m2_Predict.Sonata.2 %>% dplyr::rename("Model90.m_Predict.Sonata"="fit")
Model90.m2_Predict.Sonata.2 <- Model90.m2_Predict.Sonata.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Sonata.2 <- cbind(Son2, 
                         Model10.m2_Predict.Sonata.2, 
                         Model50.m2_Predict.Sonata.2, 
                         Model90.m2_Predict.Sonata.2)


Predict.Sonata <- rbind(Predict.Sonata.1, Predict.Sonata.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Sonata~ LT10, data=Predict.Sonata)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Sonata~ LT10, data=Predict.Sonata))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Sonata ~ LT10, data=Predict.Sonata,
     main="LT10: Sonata 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Sonata ~ LT10, data=Predict.Sonata), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Sonata~ LT50, data=Predict.Sonata)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Sonata~ LT50, data=Predict.Sonata))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Sonata ~ LT50, data=Predict.Sonata,
     main="LT50: Sonata 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Sonata ~ LT50, data=Predict.Sonata), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Sonata~ LT90, data=Predict.Sonata)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Sonata~ LT90, data=Predict.Sonata))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Sonata ~ LT90, data=Predict.Sonata,
     main="LT90: Sonata 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Sonata ~ LT90, data=Predict.Sonata), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```


***
## 14.3 Skeena
```{r, echo=FALSE, out.width="30%"}
Ske1Gi31 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final < 30)
Ske1Gi32 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final >= 30)

## Skeena1Gi3
# Skeena1Gi3 LT10 Season 1 Model 1
PredictLT10_Ske1Gi31 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske1Gi31, se= TRUE))
    PredictLT10_Ske1Gi31$LT10.CIUpper <- (PredictLT10_Ske1Gi31$fit + PredictLT10_Ske1Gi31$se.fit*1.96)
    PredictLT10_Ske1Gi31$LT10.CILower <- (PredictLT10_Ske1Gi31$fit - PredictLT10_Ske1Gi31$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske1Gi31$Date <- Ske1Gi31$Date
    # rename fit to LT50
    PredictLT10_Ske1Gi31 <- PredictLT10_Ske1Gi31 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske1Gi31 <- PredictLT10_Ske1Gi31 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske1Gi31$Colour = "black"
    
# Skeena1Gi3 LT10 Season 1 Model 2
# PredictLT10_Ske1Gi32 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske1Gi32, se= TRUE))
#     PredictLT10_Ske1Gi32$LT10.CIUpper <- (PredictLT10_Ske1Gi32$fit + PredictLT10_Ske1Gi32$se.fit*1.96)
#     PredictLT10_Ske1Gi32$LT10.CILower <- (PredictLT10_Ske1Gi32$fit - PredictLT10_Ske1Gi32$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske1Gi32$Date <- Ske1Gi32$Date
#     # rename fit to LT50
#     PredictLT10_Ske1Gi32 <- PredictLT10_Ske1Gi32 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske1Gi32 <- PredictLT10_Ske1Gi32 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske1Gi32$Colour = "mediumblue"
    
    
PredictLT10_Ske1Gi31 <- PredictLT10_Ske1Gi31


# Skeena1Gi3 LT50 Season 1 Model 1
PredictLT50_Ske1Gi31 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske1Gi31, se= TRUE))
    PredictLT50_Ske1Gi31$LT50.CIUpper <- (PredictLT50_Ske1Gi31$fit + PredictLT50_Ske1Gi31$se.fit*1.96)
    PredictLT50_Ske1Gi31$LT50.CILower <- (PredictLT50_Ske1Gi31$fit - PredictLT50_Ske1Gi31$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske1Gi31$Date <- Ske1Gi31$Date
    # rename fit to LT50
    PredictLT50_Ske1Gi31 <- PredictLT50_Ske1Gi31 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske1Gi31 <- PredictLT50_Ske1Gi31 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske1Gi31$Colour = "black"
    
# Skeena1Gi3 LT50 Season 1 Model 2
# PredictLT50_Ske1Gi32 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske1Gi32, se= TRUE))
#     PredictLT50_Ske1Gi32$LT50.CIUpper <- (PredictLT50_Ske1Gi32$fit + PredictLT50_Ske1Gi32$se.fit*1.96)
#     PredictLT50_Ske1Gi32$LT50.CILower <- (PredictLT50_Ske1Gi32$fit - PredictLT50_Ske1Gi32$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske1Gi32$Date <- Ske1Gi32$Date
#     # rename fit to LT50
#     PredictLT50_Ske1Gi32 <- PredictLT50_Ske1Gi32 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske1Gi32 <- PredictLT50_Ske1Gi32 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske1Gi32$Colour = "mediumblue"
    
PredictLT50_Ske1Gi31 <- PredictLT50_Ske1Gi31
    
    # Skeena1Gi3 LT90 Season 1 Model 1
PredictLT90_Ske1Gi31 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske1Gi31, se= TRUE))
    PredictLT90_Ske1Gi31$LT90.CIUpper <- (PredictLT90_Ske1Gi31$fit + PredictLT90_Ske1Gi31$se.fit*1.96)
    PredictLT90_Ske1Gi31$LT90.CILower <- (PredictLT90_Ske1Gi31$fit - PredictLT90_Ske1Gi31$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske1Gi31$Date <- Ske1Gi31$Date
    # rename fit to LT50
    PredictLT90_Ske1Gi31 <- PredictLT90_Ske1Gi31 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske1Gi31 <- PredictLT90_Ske1Gi31 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske1Gi31$Colour = "black"
    
# Skeena1Gi3 LT90 Season 1 Model 2
# PredictLT90_Ske1Gi32 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske1Gi32, se= TRUE))
#     PredictLT90_Ske1Gi32$LT90.CIUpper <- (PredictLT90_Ske1Gi32$fit + PredictLT90_Ske1Gi32$se.fit*1.96)
#     PredictLT90_Ske1Gi32$LT90.CILower <- (PredictLT90_Ske1Gi32$fit - PredictLT90_Ske1Gi32$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske1Gi32$Date <- Ske1Gi32$Date
#     # rename fit to LT50
#     PredictLT90_Ske1Gi32 <- PredictLT90_Ske1Gi32 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske1Gi32 <- PredictLT90_Ske1Gi32 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske1Gi32$Colour = "mediumblue"
    
    
PredictLT90_Ske1Gi31 <- PredictLT90_Ske1Gi31



plot(Skeena1.Gi3$Date, Skeena1.Gi3$LT10,
         main= "LT10 Model Validation: Skeena Gi3 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske1Gi31$Date, rev(PredictLT10_Ske1Gi31$Date)), c(PredictLT10_Ske1Gi31$LT10.CILower, rev(PredictLT10_Ske1Gi31$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske1Gi32$Date, rev(PredictLT10_Ske1Gi32$Date)), c(PredictLT10_Ske1Gi32$LT10.CILower, rev(PredictLT10_Ske1Gi32$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske1Gi31$Date, PredictLT10_Ske1Gi31$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi31$Colour)
    # lines(PredictLT10_Ske1Gi32$Date, PredictLT10_Ske1Gi32$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi32$Colour)
    
    
plot(Skeena1.Gi3$Date, Skeena1.Gi3$LT50,
         main= "LT50 Model Validation: Skeena Gi3 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske1Gi31$Date, rev(PredictLT50_Ske1Gi31$Date)), c(PredictLT50_Ske1Gi31$LT50.CILower, rev(PredictLT50_Ske1Gi31$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi32$Date, rev(PredictLT50_Ske1Gi32$Date)), c(PredictLT50_Ske1Gi32$LT50.CILower, rev(PredictLT50_Ske1Gi32$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi31$Date, PredictLT50_Ske1Gi31$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi31$Colour)
    # lines(PredictLT50_Ske1Gi32$Date, PredictLT50_Ske1Gi32$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi32$Colour)
    
    
plot(Skeena1.Gi3$Date, Skeena1.Gi3$LT90,
         main= "LT90 Model Validation: Skeena Gi3 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske1Gi31$Date, rev(PredictLT90_Ske1Gi31$Date)), c(PredictLT90_Ske1Gi31$LT90.CILower, rev(PredictLT90_Ske1Gi31$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske1Gi32$Date, rev(PredictLT90_Ske1Gi32$Date)), c(PredictLT90_Ske1Gi32$LT90.CILower, rev(PredictLT90_Ske1Gi32$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske1Gi31$Date, PredictLT90_Ske1Gi31$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi31$Colour)
    # lines(PredictLT90_Ske1Gi32$Date, PredictLT90_Ske1Gi32$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi32$Colour)
    
# 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Skeena1.Gi3 <- as.data.frame(predict(Model10.m, newdata= Ske1Gi31, se= TRUE))
Model10.m_Predict.Skeena1.Gi3 <- Model10.m_Predict.Skeena1.Gi3 %>% dplyr::rename("Model10.m_Predict.Skeena1.Gi3"="fit")
Model10.m_Predict.Skeena1.Gi3 <- Model10.m_Predict.Skeena1.Gi3 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Skeena1.Gi3 <- as.data.frame(predict(Model50.m, newdata= Ske1Gi31, se= TRUE))
Model50.m_Predict.Skeena1.Gi3 <- Model50.m_Predict.Skeena1.Gi3 %>% dplyr::rename("Model50.m_Predict.Skeena1.Gi3"="fit")
Model50.m_Predict.Skeena1.Gi3 <- Model50.m_Predict.Skeena1.Gi3 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Skeena1.Gi3 <- as.data.frame(predict(Model90.m, newdata= Ske1Gi31, se= TRUE))
Model90.m_Predict.Skeena1.Gi3 <- Model90.m_Predict.Skeena1.Gi3 %>% dplyr::rename("Model90.m_Predict.Skeena1.Gi3"="fit")
Model90.m_Predict.Skeena1.Gi3 <- Model90.m_Predict.Skeena1.Gi3 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena1.Gi3.1 <- cbind(Ske1Gi31, 
                         Model10.m_Predict.Skeena1.Gi3, 
                         Model50.m_Predict.Skeena1.Gi3, 
                         Model90.m_Predict.Skeena1.Gi3)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Skeena1.Gi3.2 <- as.data.frame(predict(Model10.m2, newdata= Ske1Gi32, se= TRUE))
Model10.m2_Predict.Skeena1.Gi3.2 <- Model10.m2_Predict.Skeena1.Gi3.2 %>% dplyr::rename("Model10.m_Predict.Skeena1.Gi3"="fit")
Model10.m2_Predict.Skeena1.Gi3.2 <- Model10.m2_Predict.Skeena1.Gi3.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Skeena1.Gi3.2 <- as.data.frame(predict(Model50.m2, newdata= Ske1Gi32, se= TRUE))
Model50.m2_Predict.Skeena1.Gi3.2 <- Model50.m2_Predict.Skeena1.Gi3.2 %>% dplyr::rename("Model50.m_Predict.Skeena1.Gi3"="fit")
Model50.m2_Predict.Skeena1.Gi3.2 <- Model50.m2_Predict.Skeena1.Gi3.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Skeena1.Gi3.2 <- as.data.frame(predict(Model90.m2, newdata= Ske1Gi32, se= TRUE))
Model90.m2_Predict.Skeena1.Gi3.2 <- Model90.m2_Predict.Skeena1.Gi3.2 %>% dplyr::rename("Model90.m_Predict.Skeena1.Gi3"="fit")
Model90.m2_Predict.Skeena1.Gi3.2 <- Model90.m2_Predict.Skeena1.Gi3.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena1.Gi3.2 <- cbind(Ske1Gi32, 
                         Model10.m2_Predict.Skeena1.Gi3.2, 
                         Model50.m2_Predict.Skeena1.Gi3.2, 
                         Model90.m2_Predict.Skeena1.Gi3.2)


Predict.Skeena1.Gi3 <- rbind(Predict.Skeena1.Gi3.1, Predict.Skeena1.Gi3.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Skeena1.Gi3~ LT10, data=Predict.Skeena1.Gi3)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Skeena1.Gi3~ LT10, data=Predict.Skeena1.Gi3))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Skeena1.Gi3 ~ LT10, data=Predict.Skeena1.Gi3,
     main="LT10: Skeena1.Gi3 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Skeena1.Gi3 ~ LT10, data=Predict.Skeena1.Gi3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Skeena1.Gi3~ LT50, data=Predict.Skeena1.Gi3)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Skeena1.Gi3~ LT50, data=Predict.Skeena1.Gi3))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Skeena1.Gi3 ~ LT50, data=Predict.Skeena1.Gi3,
     main="LT50: Skeena1.Gi3 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Skeena1.Gi3 ~ LT50, data=Predict.Skeena1.Gi3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Skeena1.Gi3~ LT90, data=Predict.Skeena1.Gi3)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Skeena1.Gi3~ LT90, data=Predict.Skeena1.Gi3))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Skeena1.Gi3 ~ LT90, data=Predict.Skeena1.Gi3,
     main="LT90: Skeena1.Gi3 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Skeena1.Gi3 ~ LT90, data=Predict.Skeena1.Gi3), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

```{r, echo=FALSE, out.width="30%"}
Ske1Gi51 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final < 30)
Ske1Gi52 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final >= 30)

## Skeena1Gi5
# Skeena1Gi5 LT10 Season 1 Model 1
PredictLT10_Ske1Gi51 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske1Gi51, se= TRUE))
    PredictLT10_Ske1Gi51$LT10.CIUpper <- (PredictLT10_Ske1Gi51$fit + PredictLT10_Ske1Gi51$se.fit*1.96)
    PredictLT10_Ske1Gi51$LT10.CILower <- (PredictLT10_Ske1Gi51$fit - PredictLT10_Ske1Gi51$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske1Gi51$Date <- Ske1Gi51$Date
    # rename fit to LT50
    PredictLT10_Ske1Gi51 <- PredictLT10_Ske1Gi51 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske1Gi51 <- PredictLT10_Ske1Gi51 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske1Gi51$Colour = "black"
    
# Skeena1Gi5 LT10 Season 1 Model 2
# PredictLT10_Ske1Gi52 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske1Gi52, se= TRUE))
#     PredictLT10_Ske1Gi52$LT10.CIUpper <- (PredictLT10_Ske1Gi52$fit + PredictLT10_Ske1Gi52$se.fit*1.96)
#     PredictLT10_Ske1Gi52$LT10.CILower <- (PredictLT10_Ske1Gi52$fit - PredictLT10_Ske1Gi52$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske1Gi52$Date <- Ske1Gi52$Date
#     # rename fit to LT50
#     PredictLT10_Ske1Gi52 <- PredictLT10_Ske1Gi52 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske1Gi52 <- PredictLT10_Ske1Gi52 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske1Gi52$Colour = "mediumblue"
    
    
PredictLT10_Ske1Gi51 <- PredictLT10_Ske1Gi51


# Skeena1Gi5 LT50 Season 1 Model 1
PredictLT50_Ske1Gi51 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske1Gi51, se= TRUE))
    PredictLT50_Ske1Gi51$LT50.CIUpper <- (PredictLT50_Ske1Gi51$fit + PredictLT50_Ske1Gi51$se.fit*1.96)
    PredictLT50_Ske1Gi51$LT50.CILower <- (PredictLT50_Ske1Gi51$fit - PredictLT50_Ske1Gi51$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske1Gi51$Date <- Ske1Gi51$Date
    # rename fit to LT50
    PredictLT50_Ske1Gi51 <- PredictLT50_Ske1Gi51 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske1Gi51 <- PredictLT50_Ske1Gi51 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske1Gi51$Colour = "black"
    
# Skeena1Gi5 LT50 Season 1 Model 2
# PredictLT50_Ske1Gi52 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske1Gi52, se= TRUE))
#     PredictLT50_Ske1Gi52$LT50.CIUpper <- (PredictLT50_Ske1Gi52$fit + PredictLT50_Ske1Gi52$se.fit*1.96)
#     PredictLT50_Ske1Gi52$LT50.CILower <- (PredictLT50_Ske1Gi52$fit - PredictLT50_Ske1Gi52$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske1Gi52$Date <- Ske1Gi52$Date
#     # rename fit to LT50
#     PredictLT50_Ske1Gi52 <- PredictLT50_Ske1Gi52 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske1Gi52 <- PredictLT50_Ske1Gi52 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske1Gi52$Colour = "mediumblue"
    
PredictLT50_Ske1Gi51 <- PredictLT50_Ske1Gi51
    
    # Skeena1Gi5 LT90 Season 1 Model 1
PredictLT90_Ske1Gi51 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske1Gi51, se= TRUE))
    PredictLT90_Ske1Gi51$LT90.CIUpper <- (PredictLT90_Ske1Gi51$fit + PredictLT90_Ske1Gi51$se.fit*1.96)
    PredictLT90_Ske1Gi51$LT90.CILower <- (PredictLT90_Ske1Gi51$fit - PredictLT90_Ske1Gi51$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske1Gi51$Date <- Ske1Gi51$Date
    # rename fit to LT50
    PredictLT90_Ske1Gi51 <- PredictLT90_Ske1Gi51 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske1Gi51 <- PredictLT90_Ske1Gi51 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske1Gi51$Colour = "black"
    
# Skeena1Gi5 LT90 Season 1 Model 2
# PredictLT90_Ske1Gi52 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske1Gi52, se= TRUE))
#     PredictLT90_Ske1Gi52$LT90.CIUpper <- (PredictLT90_Ske1Gi52$fit + PredictLT90_Ske1Gi52$se.fit*1.96)
#     PredictLT90_Ske1Gi52$LT90.CILower <- (PredictLT90_Ske1Gi52$fit - PredictLT90_Ske1Gi52$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske1Gi52$Date <- Ske1Gi52$Date
#     # rename fit to LT50
#     PredictLT90_Ske1Gi52 <- PredictLT90_Ske1Gi52 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske1Gi52 <- PredictLT90_Ske1Gi52 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske1Gi52$Colour = "mediumblue"
    
    
PredictLT90_Ske1Gi51 <- PredictLT90_Ske1Gi51



plot(Skeena1.Gi5$Date, Skeena1.Gi5$LT10,
         main= "LT10 Model Validation: Skeena Gi5 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske1Gi51$Date, rev(PredictLT10_Ske1Gi51$Date)), c(PredictLT10_Ske1Gi51$LT10.CILower, rev(PredictLT10_Ske1Gi51$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske1Gi52$Date, rev(PredictLT10_Ske1Gi52$Date)), c(PredictLT10_Ske1Gi52$LT10.CILower, rev(PredictLT10_Ske1Gi52$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske1Gi51$Date, PredictLT10_Ske1Gi51$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi51$Colour)
    # lines(PredictLT10_Ske1Gi52$Date, PredictLT10_Ske1Gi52$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi52$Colour)
    
    
plot(Skeena1.Gi5$Date, Skeena1.Gi5$LT50,
         main= "LT50 Model Validation: Skeena Gi5 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske1Gi51$Date, rev(PredictLT50_Ske1Gi51$Date)), c(PredictLT50_Ske1Gi51$LT50.CILower, rev(PredictLT50_Ske1Gi51$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi52$Date, rev(PredictLT50_Ske1Gi52$Date)), c(PredictLT50_Ske1Gi52$LT50.CILower, rev(PredictLT50_Ske1Gi52$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi51$Date, PredictLT50_Ske1Gi51$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi51$Colour)
    # lines(PredictLT50_Ske1Gi52$Date, PredictLT50_Ske1Gi52$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi52$Colour)
    
    
plot(Skeena1.Gi5$Date, Skeena1.Gi5$LT90,
         main= "LT90 Model Validation: Skeena Gi5 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske1Gi51$Date, rev(PredictLT90_Ske1Gi51$Date)), c(PredictLT90_Ske1Gi51$LT90.CILower, rev(PredictLT90_Ske1Gi51$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske1Gi52$Date, rev(PredictLT90_Ske1Gi52$Date)), c(PredictLT90_Ske1Gi52$LT90.CILower, rev(PredictLT90_Ske1Gi52$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske1Gi51$Date, PredictLT90_Ske1Gi51$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi51$Colour)
    # lines(PredictLT90_Ske1Gi52$Date, PredictLT90_Ske1Gi52$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi52$Colour)
    
    # 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Skeena1.Gi5 <- as.data.frame(predict(Model10.m, newdata= Ske1Gi51, se= TRUE))
Model10.m_Predict.Skeena1.Gi5 <- Model10.m_Predict.Skeena1.Gi5 %>% dplyr::rename("Model10.m_Predict.Skeena1.Gi5"="fit")
Model10.m_Predict.Skeena1.Gi5 <- Model10.m_Predict.Skeena1.Gi5 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Skeena1.Gi5 <- as.data.frame(predict(Model50.m, newdata= Ske1Gi51, se= TRUE))
Model50.m_Predict.Skeena1.Gi5 <- Model50.m_Predict.Skeena1.Gi5 %>% dplyr::rename("Model50.m_Predict.Skeena1.Gi5"="fit")
Model50.m_Predict.Skeena1.Gi5 <- Model50.m_Predict.Skeena1.Gi5 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Skeena1.Gi5 <- as.data.frame(predict(Model90.m, newdata= Ske1Gi51, se= TRUE))
Model90.m_Predict.Skeena1.Gi5 <- Model90.m_Predict.Skeena1.Gi5 %>% dplyr::rename("Model90.m_Predict.Skeena1.Gi5"="fit")
Model90.m_Predict.Skeena1.Gi5 <- Model90.m_Predict.Skeena1.Gi5 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena1.Gi5.1 <- cbind(Ske1Gi51, 
                         Model10.m_Predict.Skeena1.Gi5, 
                         Model50.m_Predict.Skeena1.Gi5, 
                         Model90.m_Predict.Skeena1.Gi5)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Skeena1.Gi5.2 <- as.data.frame(predict(Model10.m2, newdata= Ske1Gi52, se= TRUE))
Model10.m2_Predict.Skeena1.Gi5.2 <- Model10.m2_Predict.Skeena1.Gi5.2 %>% dplyr::rename("Model10.m_Predict.Skeena1.Gi5"="fit")
Model10.m2_Predict.Skeena1.Gi5.2 <- Model10.m2_Predict.Skeena1.Gi5.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Skeena1.Gi5.2 <- as.data.frame(predict(Model50.m2, newdata= Ske1Gi52, se= TRUE))
Model50.m2_Predict.Skeena1.Gi5.2 <- Model50.m2_Predict.Skeena1.Gi5.2 %>% dplyr::rename("Model50.m_Predict.Skeena1.Gi5"="fit")
Model50.m2_Predict.Skeena1.Gi5.2 <- Model50.m2_Predict.Skeena1.Gi5.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Skeena1.Gi5.2 <- as.data.frame(predict(Model90.m2, newdata= Ske1Gi52, se= TRUE))
Model90.m2_Predict.Skeena1.Gi5.2 <- Model90.m2_Predict.Skeena1.Gi5.2 %>% dplyr::rename("Model90.m_Predict.Skeena1.Gi5"="fit")
Model90.m2_Predict.Skeena1.Gi5.2 <- Model90.m2_Predict.Skeena1.Gi5.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena1.Gi5.2 <- cbind(Ske1Gi52, 
                         Model10.m2_Predict.Skeena1.Gi5.2, 
                         Model50.m2_Predict.Skeena1.Gi5.2, 
                         Model90.m2_Predict.Skeena1.Gi5.2)


Predict.Skeena1.Gi5 <- rbind(Predict.Skeena1.Gi5.1, Predict.Skeena1.Gi5.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Skeena1.Gi5~ LT10, data=Predict.Skeena1.Gi5)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Skeena1.Gi5~ LT10, data=Predict.Skeena1.Gi5))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Skeena1.Gi5 ~ LT10, data=Predict.Skeena1.Gi5,
     main="LT10: Skeena1.Gi5 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Skeena1.Gi5 ~ LT10, data=Predict.Skeena1.Gi5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Skeena1.Gi5~ LT50, data=Predict.Skeena1.Gi5)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Skeena1.Gi5~ LT50, data=Predict.Skeena1.Gi5))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Skeena1.Gi5 ~ LT50, data=Predict.Skeena1.Gi5,
     main="LT50: Skeena1.Gi5 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Skeena1.Gi5 ~ LT50, data=Predict.Skeena1.Gi5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Skeena1.Gi5~ LT90, data=Predict.Skeena1.Gi5)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Skeena1.Gi5~ LT90, data=Predict.Skeena1.Gi5))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Skeena1.Gi5 ~ LT90, data=Predict.Skeena1.Gi5,
     main="LT90: Skeena1.Gi5 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Skeena1.Gi5 ~ LT90, data=Predict.Skeena1.Gi5), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

```{r, echo=FALSE, out.width="30%"}
Ske1Gi61 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final < 30)
Ske1Gi62 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final >= 30)

## Skeena1Gi6
# Skeena1Gi6 LT10 Season 1 Model 1
PredictLT10_Ske1Gi61 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske1Gi61, se= TRUE))
    PredictLT10_Ske1Gi61$LT10.CIUpper <- (PredictLT10_Ske1Gi61$fit + PredictLT10_Ske1Gi61$se.fit*1.96)
    PredictLT10_Ske1Gi61$LT10.CILower <- (PredictLT10_Ske1Gi61$fit - PredictLT10_Ske1Gi61$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske1Gi61$Date <- Ske1Gi61$Date
    # rename fit to LT50
    PredictLT10_Ske1Gi61 <- PredictLT10_Ske1Gi61 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske1Gi61 <- PredictLT10_Ske1Gi61 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske1Gi61$Colour = "black"
    
# Skeena1Gi6 LT10 Season 1 Model 2
# PredictLT10_Ske1Gi62 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske1Gi62, se= TRUE))
#     PredictLT10_Ske1Gi62$LT10.CIUpper <- (PredictLT10_Ske1Gi62$fit + PredictLT10_Ske1Gi62$se.fit*1.96)
#     PredictLT10_Ske1Gi62$LT10.CILower <- (PredictLT10_Ske1Gi62$fit - PredictLT10_Ske1Gi62$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske1Gi62$Date <- Ske1Gi62$Date
#     # rename fit to LT50
#     PredictLT10_Ske1Gi62 <- PredictLT10_Ske1Gi62 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske1Gi62 <- PredictLT10_Ske1Gi62 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske1Gi62$Colour = "mediumblue"
    
    
PredictLT10_Ske1Gi61 <- PredictLT10_Ske1Gi61


# Skeena1Gi6 LT50 Season 1 Model 1
PredictLT50_Ske1Gi61 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske1Gi61, se= TRUE))
    PredictLT50_Ske1Gi61$LT50.CIUpper <- (PredictLT50_Ske1Gi61$fit + PredictLT50_Ske1Gi61$se.fit*1.96)
    PredictLT50_Ske1Gi61$LT50.CILower <- (PredictLT50_Ske1Gi61$fit - PredictLT50_Ske1Gi61$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske1Gi61$Date <- Ske1Gi61$Date
    # rename fit to LT50
    PredictLT50_Ske1Gi61 <- PredictLT50_Ske1Gi61 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske1Gi61 <- PredictLT50_Ske1Gi61 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske1Gi61$Colour = "black"
    
# Skeena1Gi6 LT50 Season 1 Model 2
# PredictLT50_Ske1Gi62 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske1Gi62, se= TRUE))
#     PredictLT50_Ske1Gi62$LT50.CIUpper <- (PredictLT50_Ske1Gi62$fit + PredictLT50_Ske1Gi62$se.fit*1.96)
#     PredictLT50_Ske1Gi62$LT50.CILower <- (PredictLT50_Ske1Gi62$fit - PredictLT50_Ske1Gi62$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske1Gi62$Date <- Ske1Gi62$Date
#     # rename fit to LT50
#     PredictLT50_Ske1Gi62 <- PredictLT50_Ske1Gi62 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske1Gi62 <- PredictLT50_Ske1Gi62 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske1Gi62$Colour = "mediumblue"
    
PredictLT50_Ske1Gi61 <- PredictLT50_Ske1Gi61
    
    # Skeena1Gi6 LT90 Season 1 Model 1
PredictLT90_Ske1Gi61 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske1Gi61, se= TRUE))
    PredictLT90_Ske1Gi61$LT90.CIUpper <- (PredictLT90_Ske1Gi61$fit + PredictLT90_Ske1Gi61$se.fit*1.96)
    PredictLT90_Ske1Gi61$LT90.CILower <- (PredictLT90_Ske1Gi61$fit - PredictLT90_Ske1Gi61$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske1Gi61$Date <- Ske1Gi61$Date
    # rename fit to LT50
    PredictLT90_Ske1Gi61 <- PredictLT90_Ske1Gi61 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske1Gi61 <- PredictLT90_Ske1Gi61 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske1Gi61$Colour = "black"
    
# Skeena1Gi6 LT90 Season 1 Model 2
# PredictLT90_Ske1Gi62 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske1Gi62, se= TRUE))
#     PredictLT90_Ske1Gi62$LT90.CIUpper <- (PredictLT90_Ske1Gi62$fit + PredictLT90_Ske1Gi62$se.fit*1.96)
#     PredictLT90_Ske1Gi62$LT90.CILower <- (PredictLT90_Ske1Gi62$fit - PredictLT90_Ske1Gi62$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske1Gi62$Date <- Ske1Gi62$Date
#     # rename fit to LT50
#     PredictLT90_Ske1Gi62 <- PredictLT90_Ske1Gi62 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske1Gi62 <- PredictLT90_Ske1Gi62 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske1Gi62$Colour = "mediumblue"
    
    
PredictLT90_Ske1Gi61 <- PredictLT90_Ske1Gi61



plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT10,
         main= "LT10 Model Validation: Skeena Gi6 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske1Gi61$Date, rev(PredictLT10_Ske1Gi61$Date)), c(PredictLT10_Ske1Gi61$LT10.CILower, rev(PredictLT10_Ske1Gi61$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske1Gi62$Date, rev(PredictLT10_Ske1Gi62$Date)), c(PredictLT10_Ske1Gi62$LT10.CILower, rev(PredictLT10_Ske1Gi62$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske1Gi61$Date, PredictLT10_Ske1Gi61$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi61$Colour)
    # lines(PredictLT10_Ske1Gi62$Date, PredictLT10_Ske1Gi62$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi62$Colour)
    
    
plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT50,
         main= "LT50 Model Validation: Skeena Gi6 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske1Gi61$Date, rev(PredictLT50_Ske1Gi61$Date)), c(PredictLT50_Ske1Gi61$LT50.CILower, rev(PredictLT50_Ske1Gi61$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi62$Date, rev(PredictLT50_Ske1Gi62$Date)), c(PredictLT50_Ske1Gi62$LT50.CILower, rev(PredictLT50_Ske1Gi62$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi61$Date, PredictLT50_Ske1Gi61$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi61$Colour)
    # lines(PredictLT50_Ske1Gi62$Date, PredictLT50_Ske1Gi62$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi62$Colour)
    
    
plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT90,
         main= "LT90 Model Validation: Skeena Gi6 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske1Gi61$Date, rev(PredictLT90_Ske1Gi61$Date)), c(PredictLT90_Ske1Gi61$LT90.CILower, rev(PredictLT90_Ske1Gi61$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske1Gi62$Date, rev(PredictLT90_Ske1Gi62$Date)), c(PredictLT90_Ske1Gi62$LT90.CILower, rev(PredictLT90_Ske1Gi62$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske1Gi61$Date, PredictLT90_Ske1Gi61$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi61$Colour)
    # lines(PredictLT90_Ske1Gi62$Date, PredictLT90_Ske1Gi62$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi62$Colour)
    
    # 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Skeena1.Gi6 <- as.data.frame(predict(Model10.m, newdata= Ske1Gi61, se= TRUE))
Model10.m_Predict.Skeena1.Gi6 <- Model10.m_Predict.Skeena1.Gi6 %>% dplyr::rename("Model10.m_Predict.Skeena1.Gi6"="fit")
Model10.m_Predict.Skeena1.Gi6 <- Model10.m_Predict.Skeena1.Gi6 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Skeena1.Gi6 <- as.data.frame(predict(Model50.m, newdata= Ske1Gi61, se= TRUE))
Model50.m_Predict.Skeena1.Gi6 <- Model50.m_Predict.Skeena1.Gi6 %>% dplyr::rename("Model50.m_Predict.Skeena1.Gi6"="fit")
Model50.m_Predict.Skeena1.Gi6 <- Model50.m_Predict.Skeena1.Gi6 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Skeena1.Gi6 <- as.data.frame(predict(Model90.m, newdata= Ske1Gi61, se= TRUE))
Model90.m_Predict.Skeena1.Gi6 <- Model90.m_Predict.Skeena1.Gi6 %>% dplyr::rename("Model90.m_Predict.Skeena1.Gi6"="fit")
Model90.m_Predict.Skeena1.Gi6 <- Model90.m_Predict.Skeena1.Gi6 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena1.Gi6.1 <- cbind(Ske1Gi61, 
                         Model10.m_Predict.Skeena1.Gi6, 
                         Model50.m_Predict.Skeena1.Gi6, 
                         Model90.m_Predict.Skeena1.Gi6)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Skeena1.Gi6.2 <- as.data.frame(predict(Model10.m2, newdata= Ske1Gi62, se= TRUE))
Model10.m2_Predict.Skeena1.Gi6.2 <- Model10.m2_Predict.Skeena1.Gi6.2 %>% dplyr::rename("Model10.m_Predict.Skeena1.Gi6"="fit")
Model10.m2_Predict.Skeena1.Gi6.2 <- Model10.m2_Predict.Skeena1.Gi6.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Skeena1.Gi6.2 <- as.data.frame(predict(Model50.m2, newdata= Ske1Gi62, se= TRUE))
Model50.m2_Predict.Skeena1.Gi6.2 <- Model50.m2_Predict.Skeena1.Gi6.2 %>% dplyr::rename("Model50.m_Predict.Skeena1.Gi6"="fit")
Model50.m2_Predict.Skeena1.Gi6.2 <- Model50.m2_Predict.Skeena1.Gi6.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Skeena1.Gi6.2 <- as.data.frame(predict(Model90.m2, newdata= Ske1Gi62, se= TRUE))
Model90.m2_Predict.Skeena1.Gi6.2 <- Model90.m2_Predict.Skeena1.Gi6.2 %>% dplyr::rename("Model90.m_Predict.Skeena1.Gi6"="fit")
Model90.m2_Predict.Skeena1.Gi6.2 <- Model90.m2_Predict.Skeena1.Gi6.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena1.Gi6.2 <- cbind(Ske1Gi62, 
                         Model10.m2_Predict.Skeena1.Gi6.2, 
                         Model50.m2_Predict.Skeena1.Gi6.2, 
                         Model90.m2_Predict.Skeena1.Gi6.2)


Predict.Skeena1.Gi6 <- rbind(Predict.Skeena1.Gi6.1, Predict.Skeena1.Gi6.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Skeena1.Gi6~ LT10, data=Predict.Skeena1.Gi6)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Skeena1.Gi6~ LT10, data=Predict.Skeena1.Gi6))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Skeena1.Gi6 ~ LT10, data=Predict.Skeena1.Gi6,
     main="LT10: Skeena1.Gi6 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Skeena1.Gi6 ~ LT10, data=Predict.Skeena1.Gi6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Skeena1.Gi6~ LT50, data=Predict.Skeena1.Gi6)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Skeena1.Gi6~ LT50, data=Predict.Skeena1.Gi6))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Skeena1.Gi6 ~ LT50, data=Predict.Skeena1.Gi6,
     main="LT50: Skeena1.Gi6 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Skeena1.Gi6 ~ LT50, data=Predict.Skeena1.Gi6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Skeena1.Gi6~ LT90, data=Predict.Skeena1.Gi6)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Skeena1.Gi6~ LT90, data=Predict.Skeena1.Gi6))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Skeena1.Gi6 ~ LT90, data=Predict.Skeena1.Gi6,
     main="LT90: Skeena1.Gi6 2015-2016",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Skeena1.Gi6 ~ LT90, data=Predict.Skeena1.Gi6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

```{r, echo=FALSE, out.width="30%"}
Ske21 <- subset(Skeena, Sweetheart_cherry_forcingBB_final < 30)
Ske22 <- subset(Skeena, Sweetheart_cherry_forcingBB_final >= 30)

## Skeena
# Skeena LT10 Season 1 Model 1
PredictLT10_Ske21 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske21, se= TRUE))
    PredictLT10_Ske21$LT10.CIUpper <- (PredictLT10_Ske21$fit + PredictLT10_Ske21$se.fit*1.96)
    PredictLT10_Ske21$LT10.CILower <- (PredictLT10_Ske21$fit - PredictLT10_Ske21$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske21$Date <- Ske21$Date
    # rename fit to LT50
    PredictLT10_Ske21 <- PredictLT10_Ske21 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske21 <- PredictLT10_Ske21 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske21$Colour = "black"
    
# Skeena LT10 Season 1 Model 2
# PredictLT10_Ske22 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske22, se= TRUE))
#     PredictLT10_Ske22$LT10.CIUpper <- (PredictLT10_Ske22$fit + PredictLT10_Ske22$se.fit*1.96)
#     PredictLT10_Ske22$LT10.CILower <- (PredictLT10_Ske22$fit - PredictLT10_Ske22$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske22$Date <- Ske22$Date
#     # rename fit to LT50
#     PredictLT10_Ske22 <- PredictLT10_Ske22 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske22 <- PredictLT10_Ske22 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske22$Colour = "mediumblue"
    
    
PredictLT10_Ske21 <- PredictLT10_Ske21


# Skeena LT50 Season 1 Model 1
PredictLT50_Ske21 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske21, se= TRUE))
    PredictLT50_Ske21$LT50.CIUpper <- (PredictLT50_Ske21$fit + PredictLT50_Ske21$se.fit*1.96)
    PredictLT50_Ske21$LT50.CILower <- (PredictLT50_Ske21$fit - PredictLT50_Ske21$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske21$Date <- Ske21$Date
    # rename fit to LT50
    PredictLT50_Ske21 <- PredictLT50_Ske21 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske21 <- PredictLT50_Ske21 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske21$Colour = "black"
    
# Skeena LT50 Season 1 Model 2
# PredictLT50_Ske22 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske22, se= TRUE))
#     PredictLT50_Ske22$LT50.CIUpper <- (PredictLT50_Ske22$fit + PredictLT50_Ske22$se.fit*1.96)
#     PredictLT50_Ske22$LT50.CILower <- (PredictLT50_Ske22$fit - PredictLT50_Ske22$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske22$Date <- Ske22$Date
#     # rename fit to LT50
#     PredictLT50_Ske22 <- PredictLT50_Ske22 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske22 <- PredictLT50_Ske22 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske22$Colour = "mediumblue"
    
PredictLT50_Ske21 <- PredictLT50_Ske21
    
    # Skeena LT90 Season 1 Model 1
PredictLT90_Ske21 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske21, se= TRUE))
    PredictLT90_Ske21$LT90.CIUpper <- (PredictLT90_Ske21$fit + PredictLT90_Ske21$se.fit*1.96)
    PredictLT90_Ske21$LT90.CILower <- (PredictLT90_Ske21$fit - PredictLT90_Ske21$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske21$Date <- Ske21$Date
    # rename fit to LT50
    PredictLT90_Ske21 <- PredictLT90_Ske21 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske21 <- PredictLT90_Ske21 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske21$Colour = "black"
    
# Skeena LT90 Season 1 Model 2
# PredictLT90_Ske22 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske22, se= TRUE))
#     PredictLT90_Ske22$LT90.CIUpper <- (PredictLT90_Ske22$fit + PredictLT90_Ske22$se.fit*1.96)
#     PredictLT90_Ske22$LT90.CILower <- (PredictLT90_Ske22$fit - PredictLT90_Ske22$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske22$Date <- Ske22$Date
#     # rename fit to LT50
#     PredictLT90_Ske22 <- PredictLT90_Ske22 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske22 <- PredictLT90_Ske22 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske22$Colour = "mediumblue"
    
    
PredictLT90_Ske21 <- PredictLT90_Ske21



plot(Skeena$Date, Skeena$LT10,
         main= "LT10 Model Validation: Skeena 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske21$Date, rev(PredictLT10_Ske21$Date)), c(PredictLT10_Ske21$LT10.CILower, rev(PredictLT10_Ske21$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske22$Date, rev(PredictLT10_Ske22$Date)), c(PredictLT10_Ske22$LT10.CILower, rev(PredictLT10_Ske22$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske21$Date, PredictLT10_Ske21$LT10, lty = 1, lwd=1, col = PredictLT10_Ske21$Colour)
    # lines(PredictLT10_Ske22$Date, PredictLT10_Ske22$LT10, lty = 1, lwd=1, col = PredictLT10_Ske22$Colour)
    
    
plot(Skeena$Date, Skeena$LT50,
         main= "LT50 Model Validation: Skeena 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske21$Date, rev(PredictLT50_Ske21$Date)), c(PredictLT50_Ske21$LT50.CILower, rev(PredictLT50_Ske21$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske22$Date, rev(PredictLT50_Ske22$Date)), c(PredictLT50_Ske22$LT50.CILower, rev(PredictLT50_Ske22$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske21$Date, PredictLT50_Ske21$LT50, lty = 1, lwd=1, col = PredictLT50_Ske21$Colour)
    # lines(PredictLT50_Ske22$Date, PredictLT50_Ske22$LT50, lty = 1, lwd=1, col = PredictLT50_Ske22$Colour)
    
    
plot(Skeena$Date, Skeena$LT90,
         main= "LT90 Model Validation: Skeena 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske21$Date, rev(PredictLT90_Ske21$Date)), c(PredictLT90_Ske21$LT90.CILower, rev(PredictLT90_Ske21$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske22$Date, rev(PredictLT90_Ske22$Date)), c(PredictLT90_Ske22$LT90.CILower, rev(PredictLT90_Ske22$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske21$Date, PredictLT90_Ske21$LT90, lty = 1, lwd=1, col = PredictLT90_Ske21$Colour)
    # lines(PredictLT90_Ske22$Date, PredictLT90_Ske22$LT90, lty = 1, lwd=1, col = PredictLT90_Ske22$Colour)
    
    # 1:1 regression

# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Skeena <- as.data.frame(predict(Model10.m, newdata= Ske21, se= TRUE))
Model10.m_Predict.Skeena <- Model10.m_Predict.Skeena %>% dplyr::rename("Model10.m_Predict.Skeena"="fit")
Model10.m_Predict.Skeena <- Model10.m_Predict.Skeena %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Skeena <- as.data.frame(predict(Model50.m, newdata= Ske21, se= TRUE))
Model50.m_Predict.Skeena <- Model50.m_Predict.Skeena %>% dplyr::rename("Model50.m_Predict.Skeena"="fit")
Model50.m_Predict.Skeena <- Model50.m_Predict.Skeena %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Skeena <- as.data.frame(predict(Model90.m, newdata= Ske21, se= TRUE))
Model90.m_Predict.Skeena <- Model90.m_Predict.Skeena %>% dplyr::rename("Model90.m_Predict.Skeena"="fit")
Model90.m_Predict.Skeena <- Model90.m_Predict.Skeena %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena.1 <- cbind(Ske21, 
                         Model10.m_Predict.Skeena, 
                         Model50.m_Predict.Skeena, 
                         Model90.m_Predict.Skeena)


# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Skeena.2 <- as.data.frame(predict(Model10.m2, newdata= Ske22, se= TRUE))
Model10.m2_Predict.Skeena.2 <- Model10.m2_Predict.Skeena.2 %>% dplyr::rename("Model10.m_Predict.Skeena"="fit")
Model10.m2_Predict.Skeena.2 <- Model10.m2_Predict.Skeena.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Skeena.2 <- as.data.frame(predict(Model50.m2, newdata= Ske22, se= TRUE))
Model50.m2_Predict.Skeena.2 <- Model50.m2_Predict.Skeena.2 %>% dplyr::rename("Model50.m_Predict.Skeena"="fit")
Model50.m2_Predict.Skeena.2 <- Model50.m2_Predict.Skeena.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Skeena.2 <- as.data.frame(predict(Model90.m2, newdata= Ske22, se= TRUE))
Model90.m2_Predict.Skeena.2 <- Model90.m2_Predict.Skeena.2 %>% dplyr::rename("Model90.m_Predict.Skeena"="fit")
Model90.m2_Predict.Skeena.2 <- Model90.m2_Predict.Skeena.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Skeena.2 <- cbind(Ske22, 
                         Model10.m2_Predict.Skeena.2, 
                         Model50.m2_Predict.Skeena.2, 
                         Model90.m2_Predict.Skeena.2)


Predict.Skeena <- rbind(Predict.Skeena.1, Predict.Skeena.2)


# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Skeena~ LT10, data=Predict.Skeena)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Skeena~ LT10, data=Predict.Skeena))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Skeena ~ LT10, data=Predict.Skeena,
     main="LT10: Skeena 2021-22",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Skeena ~ LT10, data=Predict.Skeena), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Skeena~ LT50, data=Predict.Skeena)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Skeena~ LT50, data=Predict.Skeena))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Skeena ~ LT50, data=Predict.Skeena,
     main="LT50: Skeena 2021-22",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Skeena ~ LT50, data=Predict.Skeena), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Skeena~ LT90, data=Predict.Skeena)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Skeena~ LT90, data=Predict.Skeena))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Skeena ~ LT90, data=Predict.Skeena,
     main="LT90: Skeena 2021-22",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Skeena ~ LT90, data=Predict.Skeena), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```


***
# Full Model Validation- OTHER VARIETIES: Publication Figures
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# need to run above sections for prediction dataframes
par(mfrow=c(1,3))
par(pty="m") # resets par to old conditions
#Staccato
plot(Staccato$Date, Staccato$LT50,
         main= "",
         pch= 20,
         xlab="", 
              ylab= expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_Stac1$Date, rev(PredictLT50_Stac1$Date)), c(PredictLT50_Stac1$LT50.CILower, rev(PredictLT50_Stac1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Stac2$Date, rev(PredictLT50_Stac2$Date)), c(PredictLT50_Stac2$LT50.CILower, rev(PredictLT50_Stac2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Stac1$Date, PredictLT50_Stac1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Stac1$Colour)
    # lines(PredictLT50_Stac2$Date, PredictLT50_Stac2$LT50, lty = 1, lwd=1, col = PredictLT50_Stac2$Colour)
    text(as.Date('2016-02-15'), -24, "2015-2016", cex = 1.65)
    
    
# Sonata
plot(Sonata$Date, Sonata$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab="",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_Son1$Date, rev(PredictLT50_Son1$Date)), c(PredictLT50_Son1$LT50.CILower, rev(PredictLT50_Son1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Son2$Date, rev(PredictLT50_Son2$Date)), c(PredictLT50_Son2$LT50.CILower, rev(PredictLT50_Son2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Son1$Date, PredictLT50_Son1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Son1$Colour)
    # lines(PredictLT50_Son2$Date, PredictLT50_Son2$LT50, lty = 1, lwd=1, col = PredictLT50_Son2$Colour)
    text(as.Date('2016-02-15'), -24, "2015-2016", cex = 1.65)

# Skeena Gi6
plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab="",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_Ske1Gi61$Date, rev(PredictLT50_Ske1Gi61$Date)), c(PredictLT50_Ske1Gi61$LT50.CILower, rev(PredictLT50_Ske1Gi61$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi62$Date, rev(PredictLT50_Ske1Gi62$Date)), c(PredictLT50_Ske1Gi62$LT50.CILower, rev(PredictLT50_Ske1Gi62$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi61$Date, PredictLT50_Ske1Gi61$LT50, lty = 1, lwd=1.15, col = PredictLT50_Ske1Gi61$Colour)
    # lines(PredictLT50_Ske1Gi62$Date, PredictLT50_Ske1Gi62$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi62$Colour)
    text(as.Date('2016-02-15'), -24, "2015-2016", cex = 1.65)
    

   
# save as 3x15s
```