---
title: "Modelling Cold Hardiness in 'Lapins' Sweet Cherries 2022"
author: "Elizabeth Houghton"
output:
  html_document:
    
    toc: true
    toc_float: true
    theme: cerulean
    highlight: kate
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(echo = TRUE)
```

This page was last updated on `r format(Sys.time(), '%B %d, %Y')`.

* * *
# Initial set up and calculations

```{r, results="hide", message=FALSE}
# import required packages
library(plyr)
library(zoo)
library(lubridate)
library(tidyverse)
library(MuMIn)
library(nlme)
library(report)
library(nlstools)
library(Metrics)
library(geosphere)
library(chillR)
library(ChillModels)
```

```{R}
cite_packages()
```

* * *
## Example code for chill unit calculations

```{R, eval=F}
# # Chill units (CU) were calculated using hourly air temperatures and the temperature effectiveness curve for chilling from Neilsen et al. 2015 as shown in the following function. 
# 
# Temp.df <- Temp.df %>% mutate(cherry_model_raw = case_when(Temp < -2 ~ 0, 
#                                Temp >= 18 ~ -1, 
#                                Temp >= 16 & Temp < 18 ~ -0.5,
#                                Temp < 16 & Temp >= -2 ~
#                                  1-((46.8012*exp(-exp(-(Temp-9.8275)/2.1401)))/42.80757)))
# 
# # Make a new column (Sweetheart_cherry_model) that is the accumulation of all the calculated chill units
# #   
# Temp.df <- data.frame(Temp.df, accumulated_cherry_model=cumsum(Temp.df$cherry_model_raw))
# 
# # Chill inception was found by determining when the accumulated chill units are reach a minimum, and at this time chill accumulation is set to zero, start accumulating chill the day after the minimum value is reached
#       # Anything after the minimum Sweetheart_cherry_model value (accumulated chill units), assign the accumulated chill units (Sweetheart_cherry_model),   everything before assign 0
#       # If the length of the data frame when selecting for values after the minimum Sweetheart_cherry_model value is greater than 0, assign      Sweetheart_cherry_model_final to be the cumulative sum of CU, if it is shorter than 1, assign Sweetheart_cherry_model_final a value of zero
# 
# if (nrow(Temp.df[(which.min(Temp.df$cherry_model) + 1 ):nrow(Temp.df), ]) > 1){ # + 1 must be removed in the Shiny app to account for data that                                                                                       is imported for the day of
#     Temp.df_2 <- Temp.df[(which.min(Temp.df$cherry_model) + 1 ):nrow(Temp.df), ]
#     Temp.df_2 <-  data.frame(Temp.df_2, cherry_model_final=cumsum(Temp.df_2$cherry_model_raw))
#     Temp.df <- merge(Temp.df, Temp.df_2, by = c("Date", "Year", "Month", "Day", "Time","Temp", "cherry_model_raw", "cherry_model", "Site"), all = TRUE) # these columns need to be exactly the columns in your data fame in order to run properly (no extras, no less)
#   } else {
#   Temp.df <- Temp.df %>% dplyr::mutate(cherry_model_final = 0)
#   }
# 
# # Neilsen et al. 2015 determined that approximately 1119 accumulated chilling units are optimal for Sweetheart
# 
# # Add column for sweetheart chill accumulation completion
# 
# # if chill units have not yet started accumulating, assign value of zero
# Temp.df$cherry_model_final[is.na(Temp.df$cherry_model_final)] <- 0
# 
# # create new column to indicate optimal forcing units, column Sweetheart_cherry_model (FU < 1119, assign 0, FU >= 1119, assign 1)
# Temp.df <- Temp.df %>% dplyr::mutate(Sweetheart_cherry_model = case_when(cherry_model_final < 1119 ~ 0, cherry_model_final >= 1119 ~ 1))
# 
# # We will assign any accumulated forcing unit over 1119 the value of 1119 as optimal chill has been accumulated by this point and forcing accumulation begins
# Temp.df$cherry_model_final[Temp.df$cherry_model_final >= 1119] <- 1119
```

* * *
## Example code for forcing unit calculations

```{R, eval=F}
# # 'Forcing units' were calculated using hourly air temperatures and the temperature effectiveness curve for forcing from Neilsen et al. 2015 with the bud break coefficients
# 
# Temp.df <- Temp.df %>% dplyr::mutate(Sweetheart_cherry_forcingBB = case_when(Temp < 5 ~ 0, 
#                                                                   Temp >= 5 ~ 1.5/(1+exp(-(Temp-22.8)/5.7))))
# 
# # If Sweetheart_cherry_model = 0 (FU < 1119) assign all Sweetheart_cherry_forcingBB to zero
# Temp.df$Sweetheart_cherry_forcingBB[Temp.df$Sweetheart_cherry_model == '0'] <- 0
# 
# # determine the accumulated values for the forcing units
# Temp.df <-  data.frame(Temp.df, Sweetheart_cherry_forcingBB_final=cumsum(Temp.df$Sweetheart_cherry_forcingBB))
# 
# # We will also be working with log transform chilling units
# Temp.df$Sweetheart_cherry_forcingBB_final_log <- log(Temp.df$Sweetheart_cherry_forcingBB_final + 10)
# 
# # Neilsen et al. 2015 determined that once approximately 68 forcing units (calculated using bud break coefficients) were accumulated, bud break will occur
# 
# # create column for forcing units not yet accumulating (CU < 1119, assign 0), forcing units accumulating (CU >=1119, assign 1), and forcing units complete (FU >=68, assign 2)
# 
# Temp.df <- Temp.df %>% dplyr::mutate(Sweetheart_cherry_model_forcingBB = case_when(cherry_model_final < 1119 ~ 0, cherry_model_final >= 1119 ~ 1, Sweetheart_cherry_forcingBB_final >= 68 ~ 2))
```

* * *
## Example code for temperature and temperature lag calculations

```{R, eval=F}
# # calculate max, min, and mean temperature from Temp.df that has hourly_temp, Year, Month, and Day columns
# 
# Temp_max <- aggregate(hourly_temp ~ Year + Month + Day, Temp.df, max)
# Temp_min <- aggregate(hourly_temp ~ Year + Month + Day, Temp.df, min)
# Temp_mean <- aggregate(hourly_temp ~ Year + Month + Day, Temp.df, mean)
# 
# # add column for temperature lags for 1, 2, and 3 days prior
# 
# Temp_max.lag1.df <- data.frame(Temp.df, Temp_max.lag1 = dplyr::lag(Temp.df$Temp_max))
# Temp_max.lag2.df <- data.frame(Temp.df, Temp_max.lag2 = dplyr::lag(Temp.df$Temp_max,2))
# Temp_max.lag3.df <- data.frame(Temp.df, Temp_max.lag3 = dplyr::lag(Temp.df$Temp_max,3))
# 
# Temp_min.lag1.df <- data.frame(Temp.df, Temp_min.lag1 = dplyr::lag(Temp.df$Temp_min))
# Temp_min.lag2.df <- data.frame(Temp.df, Temp_min.lag2 = dplyr::lag(Temp.df$Temp_min,2))
# Temp_min.lag3.df <- data.frame(Temp.df, Temp_min.lag3 = dplyr::lag(Temp.df$Temp_min,3))
# 
# Temp_mean.lag1.df <- data.frame(Temp.df, Temp_mean.lag1 = dplyr::lag(Temp.df$Temp_mean))
# Temp_mean.lag2.df <- data.frame(Temp.df, Temp_mean.lag2 = dplyr::lag(Temp.df$Temp_mean,2))
# Temp_mean.lag3.df <- data.frame(Temp.df, Temp_mean.lag3 = dplyr::lag(Temp.df$Temp_mean,3))
```

* * *
## Example code for photoperiod calculations

```{R, eval=F}
# # Example latitude = 49.6
# # Jday is the Julian day
# Photoperiod.df <- as.data.frame(daylength(49.6, Temp.df$Jday))
# Temp.df$Photoperiod <- Photoperiod.df$Daylength
```

* * *
# Import required data

```{R}
# This dataframe includes six seasons of 'Sweetheart' sweet cherry lethal temperature data (LT10, LT50, LT90) collected in Summerland, BC Canada from 2014-15, 2015-16, 2016-17, 2017-18, 2019-20, 2020-21
# This dataframe also includes the calculates chill unit accumulation, forcing unit calculation, daily temperatures and lag temperatures, as well as Photoperiod as demonstrated above yearly form Sept 15 to April 30.
# dates with sample sizes less than n=10 were omitted

LapinsNEW <- read.csv(file='Summerland_Lapins_final_CUFU_LT_2023.csv')
LapinsNEW$Date <- as.Date(LapinsNEW$Date)

# drop LT_n and LT_stdev so it doesn't cause na.omit issues later on
LapinsNEW = subset(LapinsNEW, select = -c(LT_n, LT_stdev, Temp.x, Temp.y))

LapinsNEW <- LapinsNEW %>% mutate_if(is.numeric, ~round(., 2))

# remove dates with 7, 8 stages because we dont have enough data for this (only a few points in full bloom or bloom and these data were very off so will remove) and the sample size was too small

# Dates:2015-04-13, 2015-04-23, 2016-04-07, 2016-04-11
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2015-04-13", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2015-04-13", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2015-04-13", NA, LapinsNEW$LT90))
#
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2015-04-23", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2015-04-23", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2015-04-23", NA, LapinsNEW$LT90))
#
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2016-04-07", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2016-04-07", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2016-04-07", NA, LapinsNEW$LT90))
#
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2016-04-11", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2016-04-11", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2016-04-11", NA, LapinsNEW$LT90))

# add photoperiod
Photoperiod.df <- as.data.frame(daylength(49.6, LapinsNEW$Jday))
LapinsNEW$Photoperiod <- Photoperiod.df$Daylength

# cube photoperiod
LapinsNEW$Photoperiod_cube <- (LapinsNEW$Photoperiod)^3

# we will omit one season of data to be later used to validate the model (75/25% Split)
Lapins <- subset(LapinsNEW, Date < "2014-09-15" | Date > "2015-04-30")


Lapins_validation <- subset(LapinsNEW, Date >= "2014-09-15" & Date <= "2015-04-29")
```

* * *
## Seperate dataframe by forcing unit accumulation

A significant loss in hardiness is observed after approximately 20-30 forcing units have been accumulated

```{r, echo=FALSE}
# Based on your observations you are going to split the models after approximately 25 accumulated FU (this is when you're starting to see significant looses in hardiness)
forcing_test <- subset(Lapins, Sweetheart_cherry_forcingBB_final > 0 & cherry_model_accumulated >= 1119)
forcing_test2 <- subset(LapinsNEW, Sweetheart_cherry_forcingBB_final > 0 & cherry_model_accumulated >= 1119) #(with the validation data still in)

forcing_test2<- forcing_test2 %>% mutate(LT10 = ifelse(Date == "2015-03-02", NA, forcing_test2$LT10))
forcing_test2<- forcing_test2 %>% mutate(LT50 = ifelse(Date == "2015-03-02", NA, forcing_test2$LT50))
forcing_test2<- forcing_test2 %>% mutate(LT90 = ifelse(Date == "2015-03-02", NA, forcing_test2$LT90))

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT10,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT10 (˚C)",
     xlim=c(0,225),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT50,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT50 (˚C)",
     xlim=c(0,225),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT90,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT90 (˚C)",
     xlim=c(0,225),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)


# with validation data still in

plot(forcing_test2$Sweetheart_cherry_forcingBB_final, forcing_test2$LT10,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT10 (˚C)",
     xlim=c(0,225),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)
abline(v=20, col="red", lty=2)

plot(forcing_test2$Sweetheart_cherry_forcingBB_final, forcing_test2$LT50,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT50 (˚C)",
     xlim=c(0,225),
     cex.main=1.5, 
     cex.lab=1)
abline(v=27, col="red", lty=2)
abline(v=25, col="red", lty=2)
abline(v=20, col="red", lty=2)

plot(forcing_test2$Sweetheart_cherry_forcingBB_final, forcing_test2$LT90,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT90 (˚C)",
     xlim=c(0,225),
     cex.main=1.5, 
     cex.lab=1)
abline(v=27, col="red", lty=2)
abline(v=25, col="red", lty=2)
abline(v=20, col="red", lty=2)
```



```{r, echo=FALSE}
forcing_test <- subset(Lapins, Sweetheart_cherry_forcingBB_final > 0 & cherry_model_accumulated >= 1119)
plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT10,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT10 (˚C)",
     xlim=c(0,150),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT50,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT50 (˚C)",
     xlim=c(0,150),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)

plot(forcing_test$Sweetheart_cherry_forcingBB_final, forcing_test$LT90,
     main="",
     pch=20,
     xlab="Accumulated Forcing", 
     ylab="LT90 (˚C)",
     xlim=c(0,150),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)

```
To counteract contributions of early forcing unit accumulation, anything before 10 FU accumulation will be assigned a value of zero

```{r, echo=FALSE}
plot(forcing_test$Sweetheart_cherry_forcingBB_final,forcing_test$LT50,
     main="",
     pch=20,
     xlab="cherry_model_final", 
     ylab="Sweetheart_cherry_forcingBB_final",
     # xlim=c(1119,2000),
     # ylim=c(0,30),
     cex.main=1.5, 
     cex.lab=1)
abline(v=25, col="red", lty=2)

plot(forcing_test$cherry_model_final,forcing_test$LT50,
     main="",
     pch=20,
     xlab="cherry_model_final", 
     ylab="Sweetheart_cherry_forcingBB_final",
     # xlim=c(1119,2000),
     # ylim=c(0,30),
     cex.main=1.5, 
     cex.lab=1)
abline(v=2000, col="red", lty=2)
abline(v=2500, col="red", lty=2)

plot(forcing_test$cherry_model_accumulated, forcing_test$Sweetheart_cherry_forcingBB_final,
     main="",
     pch=20,
     xlab="cherry_model_final", 
     ylab="Sweetheart_cherry_forcingBB_final",
     # xlim=c(1119,2000),
     # ylim=c(0,30),
     cex.main=1.5, 
     cex.lab=1)
abline(h=25, col="red", lty=2)
abline(v=2500, col="red", lty=2)
abline(v=2000, col="red", lty=2)
```
```{r}
# Lapins$Sweetheart_cherry_forcingBB_final[Lapins$Sweetheart_cherry_forcingBB_final <= 5] <- 0
# Lapins$Sweetheart_cherry_forcingBB_final_log <- log(Lapins$Sweetheart_cherry_forcingBB_final + 10)


# assign forcing a value of 50% original value below 15 to giver early forcing accumulated during warm snaps in the winter less weight
# Lapins$Sweetheart_cherry_forcingBB_final.05 <- Lapins$Sweetheart_cherry_forcingBB_final/4
Lapins$Sweetheart_cherry_forcingBB_final.05 <- 0

Lapins$Sweetheart_cherry_forcingBB_final <- ifelse(Lapins$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Lapins$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/4 (which is now zero)
                                                          Lapins$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values


# calculate log values again based off this

Lapins$Sweetheart_cherry_forcingBB_final_log <- log(Lapins$Sweetheart_cherry_forcingBB_final + 10)

# add rows for lag 4, 5, 6, and 7 for mean daily air temperautures to calculate autocorrelation

Lapins <- data.frame(Lapins, Temp_mean.lag4 = dplyr::lag(Lapins$Temp_mean,4))
Lapins <- data.frame(Lapins, Temp_mean.lag5 = dplyr::lag(Lapins$Temp_mean,5))
Lapins <- data.frame(Lapins, Temp_mean.lag6 = dplyr::lag(Lapins$Temp_mean,6))
Lapins <- data.frame(Lapins, Temp_mean.lag7 = dplyr::lag(Lapins$Temp_mean,7))

#omit NA values
LapinsNA <- na.omit(Lapins)


# split dataframe based on this
Lapins1 <- subset(Lapins, Sweetheart_cherry_forcingBB_final < 25)
LapinsNA1 <- subset(LapinsNA, Sweetheart_cherry_forcingBB_final < 25)

Lapins2 <- subset(Lapins, Sweetheart_cherry_forcingBB_final >= 25)
LapinsNA2 <- subset(LapinsNA, Sweetheart_cherry_forcingBB_final >= 25)
```

```{r, echo=FALSE, results='hide'}
# add approximate bud stages to SweetheartNEWNA2 coded as numeric:

# 1 = side green
# 2 = green tip
# 3 = tight cluster
# 4 = open cluster
# 5 = first white
# 6 = first bloom
# 7 = full bloom
# 8 = petal fall

# "2015-03-16" 1
# "2015-03-19" 2
# "2015-03-26" 3
# "2015-03-31" 4
# "2015-04-09" 5
#### "2015-04-13" 7
#### "2015-04-23" 8

# "2016-03-08" 1
# "2016-03-21" 2
# "2016-04-04" 5
# "2016-04-07" 6
#### "2016-04-11" 7
# "2017-04-03" 1
# "2017-04-06" 2
# "2017-04-12" 3
# "2017-04-20" 4
# "2017-04-25" 5

# NOT NOW (BUT POSSIBLE FOR FUTURE) remove dates with 6, 7, 8 stages because we dont have enough data for this and buds were measured differently
# "2015-04-13" , "2015-04-23",  #"2016-04-11" 7

LapinsNA2$Date
stages <- c(1,2,5,1,2,3,4,5)
stages <- as.data.frame(stages)

# remove stages 7 and 8

LapinsNA2 <- cbind(LapinsNA2, stages)

sum_lm <- summary(lm(LT50~stages, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$stages,
     LapinsNA2$LT50,
     xlab="stages",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$stages) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)
```

* * *
# 3.0 Temperature lag correlations: FU < 25

```{R, fig.show='hide', echo=FALSE}
# LT10 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_max, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max,
     LapinsNA1$LT10,
     xlab="Temp_max",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared <- sum_lm$r.squared
LT10_r.squared <- as.data.frame(LT10_r.squared)
LT10_r.squared$Temp <- 'Temp_max'
LT10_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_max.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag1,
     LapinsNA1$LT10,
     xlab="Temp_max.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag1) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared1 <- LT10_r.squared1 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared1$Temp <- 'Temp_max.lag1'
LT10_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT10~Temp_max.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag2,
     LapinsNA1$LT10,
     xlab="Temp_max.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag2) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared2 <- LT10_r.squared2 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared2$Temp <- 'Temp_max.lag2'
LT10_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_max.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag3,
     LapinsNA1$LT10,
     xlab="Temp_max.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag3) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared3 <- LT10_r.squared3 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared3$Temp <- 'Temp_max.lag3'
LT10_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_min, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min,
     LapinsNA1$LT10,
     xlab="Temp_min",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared4 <- LT10_r.squared4 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared4$Temp <- 'Temp_min'
LT10_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_min.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag1,
     LapinsNA1$LT10,
     xlab="Temp_min.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag1) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared5 <- LT10_r.squared5 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared5$Temp <- 'Temp_min.lag1'
LT10_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_min.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag2,
     LapinsNA1$LT10,
     xlab="Temp_min.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag2) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared6 <- LT10_r.squared6 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared6$Temp <- 'Temp_min.lag2'
LT10_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_min.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag3,
     LapinsNA1$LT10,
     xlab="Temp_min.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag3) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared7 <- LT10_r.squared7 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared7$Temp <- 'Temp_min.lag3'
LT10_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_mean, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean,
     LapinsNA1$LT10,
     xlab="Temp_mean",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared8 <- LT10_r.squared8 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared8$Temp <- 'Temp_mean'
LT10_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_mean.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag1,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag1) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared9 <- LT10_r.squared9 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared9$Temp <- 'Temp_mean.lag1'
LT10_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_mean.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag2,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag2) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared10 <- LT10_r.squared10 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared10$Temp <- 'Temp_mean.lag2'
LT10_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_mean.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag3,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag3) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared11 <- LT10_r.squared11 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared11$Temp <- 'Temp_mean.lag3'
LT10_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT10~Temp_mean.lag4, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag4,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag4",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag4) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared12 <- LT10_r.squared12 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared12$Temp <- 'Temp_mean.lag4'
LT10_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT10~Temp_mean.lag5, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag5,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag5",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag5) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared13 <- LT10_r.squared13 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared13$Temp <- 'Temp_mean.lag5'
LT10_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT10~Temp_mean.lag6, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag6,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag6",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag6) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared14 <- LT10_r.squared14 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared14$Temp <- 'Temp_mean.lag6'
LT10_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT10~Temp_mean.lag7, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag7,
     LapinsNA1$LT10,
     xlab="Temp_mean.lag7",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag7) - 7, 
     y = min(LapinsNA1$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared15 <- LT10_r.squared15 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared15$Temp <- 'Temp_mean.lag7'
LT10_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT10_r.squared <- rbind(LT10_r.squared, LT10_r.squared1, LT10_r.squared2, LT10_r.squared3, LT10_r.squared4, LT10_r.squared5, LT10_r.squared6,
                        LT10_r.squared7, LT10_r.squared8, LT10_r.squared9, LT10_r.squared10, LT10_r.squared11, LT10_r.squared12, LT10_r.squared13, LT10_r.squared14, LT10_r.squared15)
LT10_r.squared$LT10_r.squared <- as.numeric(LT10_r.squared$LT10_r.squared)
LT10_r.squared$p <- as.character(LT10_r.squared$p)
LT10_r.squared <- LT10_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

```{R, fig.show='hide', echo=FALSE}
#LT50

# LT50 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_max, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max,
     LapinsNA1$LT50,
     xlab="Temp_max",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared <- sum_lm$r.squared
LT50_r.squared <- as.data.frame(LT50_r.squared)
LT50_r.squared$Temp <- 'Temp_max'
LT50_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_max.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag1,
     LapinsNA1$LT50,
     xlab="Temp_max.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag1) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared1 <- LT50_r.squared1 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared1$Temp <- 'Temp_max.lag1'
LT50_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT50~Temp_max.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag2,
     LapinsNA1$LT50,
     xlab="Temp_max.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag2) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared2 <- LT50_r.squared2 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared2$Temp <- 'Temp_max.lag2'
LT50_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_max.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag3,
     LapinsNA1$LT50,
     xlab="Temp_max.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag3) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared3 <- LT50_r.squared3 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared3$Temp <- 'Temp_max.lag3'
LT50_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_min, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min,
     LapinsNA1$LT50,
     xlab="Temp_min",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared4 <- LT50_r.squared4 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared4$Temp <- 'Temp_min'
LT50_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_min.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag1,
     LapinsNA1$LT50,
     xlab="Temp_min.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag1) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared5 <- LT50_r.squared5 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared5$Temp <- 'Temp_min.lag1'
LT50_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_min.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag2,
     LapinsNA1$LT50,
     xlab="Temp_min.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag2) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared6 <- LT50_r.squared6 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared6$Temp <- 'Temp_min.lag2'
LT50_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_min.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag3,
     LapinsNA1$LT50,
     xlab="Temp_min.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag3) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared7 <- LT50_r.squared7 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared7$Temp <- 'Temp_min.lag3'
LT50_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_mean, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean,
     LapinsNA1$LT50,
     xlab="Temp_mean",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared8 <- LT50_r.squared8 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared8$Temp <- 'Temp_mean'
LT50_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_mean.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag1,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag1) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared9 <- LT50_r.squared9 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared9$Temp <- 'Temp_mean.lag1'
LT50_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_mean.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag2,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag2) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared10 <- LT50_r.squared10 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared10$Temp <- 'Temp_mean.lag2'
LT50_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_mean.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag3,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag3) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared11 <- LT50_r.squared11 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared11$Temp <- 'Temp_mean.lag3'
LT50_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT50~Temp_mean.lag4, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag4,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag4",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag4) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared12 <- LT50_r.squared12 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared12$Temp <- 'Temp_mean.lag4'
LT50_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT50~Temp_mean.lag5, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag5,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag5",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag5) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared13 <- LT50_r.squared13 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared13$Temp <- 'Temp_mean.lag5'
LT50_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT50~Temp_mean.lag6, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag6,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag6",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag6) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared14 <- LT50_r.squared14 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared14$Temp <- 'Temp_mean.lag6'
LT50_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT50~Temp_mean.lag7, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag7,
     LapinsNA1$LT50,
     xlab="Temp_mean.lag7",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag7) - 7, 
     y = min(LapinsNA1$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared15 <- LT50_r.squared15 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared15$Temp <- 'Temp_mean.lag7'
LT50_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT50_r.squared <- rbind(LT50_r.squared, LT50_r.squared1, LT50_r.squared2, LT50_r.squared3, LT50_r.squared4, LT50_r.squared5, LT50_r.squared6,
                        LT50_r.squared7, LT50_r.squared8, LT50_r.squared9, LT50_r.squared10, LT50_r.squared11, LT50_r.squared12, LT50_r.squared13, LT50_r.squared14, LT50_r.squared15)
LT50_r.squared$LT50_r.squared <- as.numeric(LT50_r.squared$LT50_r.squared)
LT50_r.squared$p <- as.character(LT50_r.squared$p)
LT50_r.squared <- LT50_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

```{R, fig.show='hide', echo=FALSE}
#LT90

# LT90 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_max, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max,
     LapinsNA1$LT90,
     xlab="Temp_max",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared <- sum_lm$r.squared
LT90_r.squared <- as.data.frame(LT90_r.squared)
LT90_r.squared$Temp <- 'Temp_max'
LT90_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_max.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag1,
     LapinsNA1$LT90,
     xlab="Temp_max.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag1) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared1 <- LT90_r.squared1 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared1$Temp <- 'Temp_max.lag1'
LT90_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT90~Temp_max.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag2,
     LapinsNA1$LT90,
     xlab="Temp_max.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag2) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared2 <- LT90_r.squared2 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared2$Temp <- 'Temp_max.lag2'
LT90_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_max.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_max.lag3,
     LapinsNA1$LT90,
     xlab="Temp_max.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_max.lag3) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared3 <- LT90_r.squared3 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared3$Temp <- 'Temp_max.lag3'
LT90_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_min, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min,
     LapinsNA1$LT90,
     xlab="Temp_min",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared4 <- LT90_r.squared4 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared4$Temp <- 'Temp_min'
LT90_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_min.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag1,
     LapinsNA1$LT90,
     xlab="Temp_min.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag1) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared5 <- LT90_r.squared5 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared5$Temp <- 'Temp_min.lag1'
LT90_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_min.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag2,
     LapinsNA1$LT90,
     xlab="Temp_min.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag2) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared6 <- LT90_r.squared6 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared6$Temp <- 'Temp_min.lag2'
LT90_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_min.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_min.lag3,
     LapinsNA1$LT90,
     xlab="Temp_min.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_min.lag3) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared7 <- LT90_r.squared7 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared7$Temp <- 'Temp_min.lag3'
LT90_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_mean, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean,
     LapinsNA1$LT90,
     xlab="Temp_mean",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared8 <- LT90_r.squared8 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared8$Temp <- 'Temp_mean'
LT90_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_mean.lag1, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag1,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag1) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared9 <- LT90_r.squared9 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared9$Temp <- 'Temp_mean.lag1'
LT90_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_mean.lag2, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag2,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag2) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared10 <- LT90_r.squared10 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared10$Temp <- 'Temp_mean.lag2'
LT90_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_mean.lag3, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag3,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag3) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared11 <- LT90_r.squared11 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared11$Temp <- 'Temp_mean.lag3'
LT90_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT90~Temp_mean.lag4, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag4,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag4",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag4) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared12 <- LT90_r.squared12 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared12$Temp <- 'Temp_mean.lag4'
LT90_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT90~Temp_mean.lag5, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag5,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag5",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag5) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared13 <- LT90_r.squared13 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared13$Temp <- 'Temp_mean.lag5'
LT90_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT90~Temp_mean.lag6, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag6,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag6",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag6) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared14 <- LT90_r.squared14 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared14$Temp <- 'Temp_mean.lag6'
LT90_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT90~Temp_mean.lag7, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Temp_mean.lag7,
     LapinsNA1$LT90,
     xlab="Temp_mean.lag7",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Temp_mean.lag7) - 7, 
     y = min(LapinsNA1$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared15 <- LT90_r.squared15 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared15$Temp <- 'Temp_mean.lag7'
LT90_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT90_r.squared <- rbind(LT90_r.squared, LT90_r.squared1, LT90_r.squared2, LT90_r.squared3, LT90_r.squared4, LT90_r.squared5, LT90_r.squared6,
                        LT90_r.squared7, LT90_r.squared8, LT90_r.squared9, LT90_r.squared10, LT90_r.squared11, LT90_r.squared12, LT90_r.squared13, LT90_r.squared14, LT90_r.squared15)
LT90_r.squared$LT90_r.squared <- as.numeric(LT90_r.squared$LT90_r.squared)
LT90_r.squared$p <- as.character(LT90_r.squared$p)
LT90_r.squared <- LT90_r.squared %>% mutate_if(is.numeric, ~round(., 2))


```

```{R, echo=FALSE}

LT10_r.squared<- LT10_r.squared %>% 
  dplyr::rename(LT10_p = "p")
LT50_r.squared<- LT50_r.squared %>% 
  dplyr::rename(LT50_p = "p")
LT90_r.squared<- LT90_r.squared %>% 
  dplyr::rename(LT90_p = "p")

Temp_r.squared <- merge(LT10_r.squared, LT50_r.squared, by= c("Temp"), all = TRUE)
Temp_r.squared <- merge(Temp_r.squared, LT90_r.squared, by= c("Temp"), all = TRUE)

Temp_r.squared

write.csv(Temp_r.squared, file = "./outputs/Temp.Lag.T1.Lapins_r.squared.csv", row.names = FALSE)
```

* * *
# 4.0 Temperature lag correlations: FU  >= 25
```{R, fig.show='hide', echo=FALSE}
#LT10

# LT10 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_max, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max,
     LapinsNA2$LT10,
     xlab="Temp_max",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared <- sum_lm$r.squared
LT10_r.squared <- as.data.frame(LT10_r.squared)
LT10_r.squared$Temp <- 'Temp_max'
LT10_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_max.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag1,
     LapinsNA2$LT10,
     xlab="Temp_max.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag1) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared1 <- LT10_r.squared1 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared1$Temp <- 'Temp_max.lag1'
LT10_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT10~Temp_max.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag2,
     LapinsNA2$LT10,
     xlab="Temp_max.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag2) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared2 <- LT10_r.squared2 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared2$Temp <- 'Temp_max.lag2'
LT10_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_max.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag3,
     LapinsNA2$LT10,
     xlab="Temp_max.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag3) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared3 <- LT10_r.squared3 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared3$Temp <- 'Temp_max.lag3'
LT10_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_min, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min,
     LapinsNA2$LT10,
     xlab="Temp_min",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared4 <- LT10_r.squared4 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared4$Temp <- 'Temp_min'
LT10_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_min.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag1,
     LapinsNA2$LT10,
     xlab="Temp_min.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag1) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared5 <- LT10_r.squared5 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared5$Temp <- 'Temp_min.lag1'
LT10_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_min.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag2,
     LapinsNA2$LT10,
     xlab="Temp_min.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag2) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared6 <- LT10_r.squared6 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared6$Temp <- 'Temp_min.lag2'
LT10_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_min.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag3,
     LapinsNA2$LT10,
     xlab="Temp_min.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag3) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared7 <- LT10_r.squared7 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared7$Temp <- 'Temp_min.lag3'
LT10_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT10 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT10~Temp_mean, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean,
     LapinsNA2$LT10,
     xlab="Temp_mean",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared8 <- LT10_r.squared8 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared8$Temp <- 'Temp_mean'
LT10_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT10~Temp_mean.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag1,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag1",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag1) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared9 <- LT10_r.squared9 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared9$Temp <- 'Temp_mean.lag1'
LT10_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT10~Temp_mean.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag2,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag2",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag2) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT10_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared10 <- LT10_r.squared10 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared10$Temp <- 'Temp_mean.lag2'
LT10_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT10~Temp_mean.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag3,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag3",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag3) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared11 <- LT10_r.squared11 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared11$Temp <- 'Temp_mean.lag3'
LT10_r.squared11$p <- sum_lm$coefficients[1,4] 

# lag 4
sum_lm <- summary(lm(LT10~Temp_mean.lag4, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag4,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag4",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag4) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared12 <- LT10_r.squared12 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared12$Temp <- 'Temp_mean.lag4'
LT10_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT10~Temp_mean.lag5, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag5,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag5",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag5) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared13 <- LT10_r.squared13 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared13$Temp <- 'Temp_mean.lag5'
LT10_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT10~Temp_mean.lag6, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag6,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag6",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag6) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared14 <- LT10_r.squared14 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared14$Temp <- 'Temp_mean.lag6'
LT10_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT10~Temp_mean.lag7, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag7,
     LapinsNA2$LT10,
     xlab="Temp_mean.lag7",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag7) - 7, 
     y = min(LapinsNA2$LT10) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT10_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT10_r.squared15 <- LT10_r.squared15 %>% 
  dplyr::rename(LT10_r.squared = "c(sum_lm$r.squared)")
LT10_r.squared15$Temp <- 'Temp_mean.lag7'
LT10_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT10_r.squared <- rbind(LT10_r.squared, LT10_r.squared1, LT10_r.squared2, LT10_r.squared3, LT10_r.squared4, LT10_r.squared5, LT10_r.squared6,
                        LT10_r.squared7, LT10_r.squared8, LT10_r.squared9, LT10_r.squared10, LT10_r.squared11, LT10_r.squared12, LT10_r.squared13, LT10_r.squared14, LT10_r.squared15)
LT10_r.squared$LT10_r.squared <- as.numeric(LT10_r.squared$LT10_r.squared)
LT10_r.squared$p <- as.character(LT10_r.squared$p)
LT10_r.squared <- LT10_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

```{R, fig.show='hide', echo=FALSE}
#LT50

# LT50 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_max, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max,
     LapinsNA2$LT50,
     xlab="Temp_max",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared <- sum_lm$r.squared
LT50_r.squared <- as.data.frame(LT50_r.squared)
LT50_r.squared$Temp <- 'Temp_max'
LT50_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_max.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag1,
     LapinsNA2$LT50,
     xlab="Temp_max.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag1) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared1 <- LT50_r.squared1 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared1$Temp <- 'Temp_max.lag1'
LT50_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT50~Temp_max.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag2,
     LapinsNA2$LT50,
     xlab="Temp_max.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag2) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared2 <- LT50_r.squared2 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared2$Temp <- 'Temp_max.lag2'
LT50_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_max.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag3,
     LapinsNA2$LT50,
     xlab="Temp_max.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag3) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared3 <- LT50_r.squared3 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared3$Temp <- 'Temp_max.lag3'
LT50_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_min, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min,
     LapinsNA2$LT50,
     xlab="Temp_min",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared4 <- LT50_r.squared4 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared4$Temp <- 'Temp_min'
LT50_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_min.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag1,
     LapinsNA2$LT50,
     xlab="Temp_min.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag1) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared5 <- LT50_r.squared5 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared5$Temp <- 'Temp_min.lag1'
LT50_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_min.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag2,
     LapinsNA2$LT50,
     xlab="Temp_min.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag2) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared6 <- LT50_r.squared6 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared6$Temp <- 'Temp_min.lag2'
LT50_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_min.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag3,
     LapinsNA2$LT50,
     xlab="Temp_min.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag3) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared7 <- LT50_r.squared7 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared7$Temp <- 'Temp_min.lag3'
LT50_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT50 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT50~Temp_mean, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean,
     LapinsNA2$LT50,
     xlab="Temp_mean",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared8 <- LT50_r.squared8 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared8$Temp <- 'Temp_mean'
LT50_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT50~Temp_mean.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag1,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag1",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag1) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared9 <- LT50_r.squared9 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared9$Temp <- 'Temp_mean.lag1'
LT50_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT50~Temp_mean.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag2,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag2",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag2) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT50_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared10 <- LT50_r.squared10 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared10$Temp <- 'Temp_mean.lag2'
LT50_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT50~Temp_mean.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag3,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag3",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag3) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared11 <- LT50_r.squared11 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared11$Temp <- 'Temp_mean.lag3'
LT50_r.squared11$p <- sum_lm$coefficients[1,4] 


# lag 4
sum_lm <- summary(lm(LT50~Temp_mean.lag4, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag4,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag4",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag4) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared12 <- LT50_r.squared12 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared12$Temp <- 'Temp_mean.lag4'
LT50_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT50~Temp_mean.lag5, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag5,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag5",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag5) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared13 <- LT50_r.squared13 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared13$Temp <- 'Temp_mean.lag5'
LT50_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT50~Temp_mean.lag6, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag6,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag6",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag6) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared14 <- LT50_r.squared14 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared14$Temp <- 'Temp_mean.lag6'
LT50_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT50~Temp_mean.lag7, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag7,
     LapinsNA2$LT50,
     xlab="Temp_mean.lag7",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag7) - 7, 
     y = min(LapinsNA2$LT50) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT50_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT50_r.squared15 <- LT50_r.squared15 %>% 
  dplyr::rename(LT50_r.squared = "c(sum_lm$r.squared)")
LT50_r.squared15$Temp <- 'Temp_mean.lag7'
LT50_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT50_r.squared <- rbind(LT50_r.squared, LT50_r.squared1, LT50_r.squared2, LT50_r.squared3, LT50_r.squared4, LT50_r.squared5, LT50_r.squared6,
                        LT50_r.squared7, LT50_r.squared8, LT50_r.squared9, LT50_r.squared10, LT50_r.squared11, LT50_r.squared12, LT50_r.squared13, LT50_r.squared14, LT50_r.squared15)
LT50_r.squared$LT50_r.squared <- as.numeric(LT50_r.squared$LT50_r.squared)
LT50_r.squared$p <- as.character(LT50_r.squared$p)
LT50_r.squared <- LT50_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

```{R, fig.show='hide', echo=FALSE}
#LT90

# LT90 Temp_max  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_max, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max,
     LapinsNA2$LT90,
     xlab="Temp_max",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared <- sum_lm$r.squared
LT90_r.squared <- as.data.frame(LT90_r.squared)
LT90_r.squared$Temp <- 'Temp_max'
LT90_r.squared$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_max.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag1,
     LapinsNA2$LT90,
     xlab="Temp_max.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag1) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared1 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared1 <- LT90_r.squared1 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared1$Temp <- 'Temp_max.lag1'
LT90_r.squared1$p <- sum_lm$coefficients[1,4] 


# lag 2
sum_lm <- summary(lm(LT90~Temp_max.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag2,
     LapinsNA2$LT90,
     xlab="Temp_max.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag2) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared2 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared2 <- LT90_r.squared2 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared2$Temp <- 'Temp_max.lag2'
LT90_r.squared2$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_max.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_max.lag3,
     LapinsNA2$LT90,
     xlab="Temp_max.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_max.lag3) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared3 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared3 <- LT90_r.squared3 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared3$Temp <- 'Temp_max.lag3'
LT90_r.squared3$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_min  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_min, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min,
     LapinsNA2$LT90,
     xlab="Temp_min",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared4 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared4 <- LT90_r.squared4 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared4$Temp <- 'Temp_min'
LT90_r.squared4$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_min.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag1,
     LapinsNA2$LT90,
     xlab="Temp_min.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag1) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared5 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared5 <- LT90_r.squared5 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared5$Temp <- 'Temp_min.lag1'
LT90_r.squared5$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_min.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag2,
     LapinsNA2$LT90,
     xlab="Temp_min.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag2) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared6 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared6 <- LT90_r.squared6 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared6$Temp <- 'Temp_min.lag2'
LT90_r.squared6$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_min.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_min.lag3,
     LapinsNA2$LT90,
     xlab="Temp_min.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_min.lag3) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared7 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared7 <- LT90_r.squared7 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared7$Temp <- 'Temp_min.lag3'
LT90_r.squared7$p <- sum_lm$coefficients[1,4] 


# LT90 Temp_mean  correlations:
# no lag
sum_lm <- summary(lm(LT90~Temp_mean, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean,
     LapinsNA2$LT90,
     xlab="Temp_mean",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared8 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared8 <- LT90_r.squared8 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared8$Temp <- 'Temp_mean'
LT90_r.squared8$p <- sum_lm$coefficients[1,4] 

# lag 1
sum_lm <- summary(lm(LT90~Temp_mean.lag1, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag1,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag1",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag1) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared9 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared9 <- LT90_r.squared9 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared9$Temp <- 'Temp_mean.lag1'
LT90_r.squared9$p <- sum_lm$coefficients[1,4] 

# lag 2
sum_lm <- summary(lm(LT90~Temp_mean.lag2, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag2,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag2",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag2) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LT90_r.squared10 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared10 <- LT90_r.squared10 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared10$Temp <- 'Temp_mean.lag2'
LT90_r.squared10$p <- sum_lm$coefficients[1,4] 

# lag 3
sum_lm <- summary(lm(LT90~Temp_mean.lag3, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag3,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag3",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag3) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared11 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared11 <- LT90_r.squared11 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared11$Temp <- 'Temp_mean.lag3'
LT90_r.squared11$p <- sum_lm$coefficients[1,4] 


# lag 4
sum_lm <- summary(lm(LT90~Temp_mean.lag4, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag4,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag4",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag4) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared12 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared12 <- LT90_r.squared12 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared12$Temp <- 'Temp_mean.lag4'
LT90_r.squared12$p <- sum_lm$coefficients[1,4] 

# lag 5
sum_lm <- summary(lm(LT90~Temp_mean.lag5, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag5,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag5",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag5) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared13 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared13 <- LT90_r.squared13 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared13$Temp <- 'Temp_mean.lag5'
LT90_r.squared13$p <- sum_lm$coefficients[1,4] 

# lag 6
sum_lm <- summary(lm(LT90~Temp_mean.lag6, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag6,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag6",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag6) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared14 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared14 <- LT90_r.squared14 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared14$Temp <- 'Temp_mean.lag6'
LT90_r.squared14$p <- sum_lm$coefficients[1,4] 

# lag 7
sum_lm <- summary(lm(LT90~Temp_mean.lag7, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Temp_mean.lag7,
     LapinsNA2$LT90,
     xlab="Temp_mean.lag7",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Temp_mean.lag7) - 7, 
     y = min(LapinsNA2$LT90) + 5, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

LT90_r.squared15 <- as.data.frame(c(sum_lm$r.squared))
LT90_r.squared15 <- LT90_r.squared15 %>% 
  dplyr::rename(LT90_r.squared = "c(sum_lm$r.squared)")
LT90_r.squared15$Temp <- 'Temp_mean.lag7'
LT90_r.squared15$p <- sum_lm$coefficients[1,4] 

# round columns to 2 decimals
LT90_r.squared <- rbind(LT90_r.squared, LT90_r.squared1, LT90_r.squared2, LT90_r.squared3, LT90_r.squared4, LT90_r.squared5, LT90_r.squared6,
                        LT90_r.squared7, LT90_r.squared8, LT90_r.squared9, LT90_r.squared10, LT90_r.squared11, LT90_r.squared12, LT90_r.squared13, LT90_r.squared14, LT90_r.squared15)
LT90_r.squared$LT90_r.squared <- as.numeric(LT90_r.squared$LT90_r.squared)
LT90_r.squared$p <- as.character(LT90_r.squared$p)
LT90_r.squared <- LT90_r.squared %>% mutate_if(is.numeric, ~round(., 2))
```

There is no correlation between LT10, LT50, LT90 or any ambient temperature measurement or lag.

```{R, echo=FALSE}

LT10_r.squared<- LT10_r.squared %>% 
  dplyr::rename(LT10_p = "p")
LT50_r.squared<- LT50_r.squared %>% 
  dplyr::rename(LT50_p = "p")
LT90_r.squared<- LT90_r.squared %>% 
  dplyr::rename(LT90_p = "p")

Temp_r.squared <- merge(LT10_r.squared, LT50_r.squared, by= c("Temp"), all = TRUE)
Temp_r.squared <- merge(Temp_r.squared, LT90_r.squared, by= c("Temp"), all = TRUE)

Temp_r.squared

write.csv(Temp_r.squared, file = "./outputs/Temp.Lag.T2.Lapins_r.squared.csv", row.names = FALSE)

# Remove extra columns that we've added mean temp lag 4, 5, 6, and 7:

Lapins <- subset(Lapins, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
Lapins1 <- subset(Lapins1, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
Lapins2 <- subset(Lapins2, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
LapinsNA1 <- subset(LapinsNA1, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
LapinsNA2 <- subset(LapinsNA2, select=-c(Temp_mean.lag4, Temp_mean.lag5, Temp_mean.lag6, Temp_mean.lag7))
```

Check correlation between FU: there is no correlation between forcing units and LT
```{R, echo=FALSE}
sum_lm <- summary(lm(LT10~Sweetheart_cherry_forcingBB_final, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Sweetheart_cherry_forcingBB_final,
     LapinsNA2$LT10,
     xlab="Sweetheart_cherry_forcingBB_final",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Sweetheart_cherry_forcingBB_final) - 15, 
     y = min(LapinsNA2$LT10) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT50~Sweetheart_cherry_forcingBB_final, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Sweetheart_cherry_forcingBB_final,
     LapinsNA2$LT50,
     xlab="Sweetheart_cherry_forcingBB_final",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Sweetheart_cherry_forcingBB_final) - 15, 
     y = min(LapinsNA2$LT50) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT90~Sweetheart_cherry_forcingBB_final, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Sweetheart_cherry_forcingBB_final,
     LapinsNA2$LT90,
     xlab="Sweetheart_cherry_forcingBB_final",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Sweetheart_cherry_forcingBB_final) - 15, 
     y = min(LapinsNA2$LT90) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

# try log transformed
sum_lm <- summary(lm(LT10~Sweetheart_cherry_forcingBB_final_log, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Sweetheart_cherry_forcingBB_final_log,
     LapinsNA2$LT10,
     xlab="Sweetheart_cherry_forcingBB_final_log",
     ylab="LT10",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Sweetheart_cherry_forcingBB_final_log) - 1, 
     y = min(LapinsNA2$LT10) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT50~Sweetheart_cherry_forcingBB_final_log, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Sweetheart_cherry_forcingBB_final_log,
     LapinsNA2$LT50,
     xlab="Sweetheart_cherry_forcingBB_final_log",
     ylab="LT50",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Sweetheart_cherry_forcingBB_final_log) - 1, 
     y = min(LapinsNA2$LT50) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT90~Sweetheart_cherry_forcingBB_final_log, data = LapinsNA2))
coef_lm<-sum_lm$coefficients
plot(LapinsNA2$Sweetheart_cherry_forcingBB_final_log,
     LapinsNA2$LT90,
     xlab="Sweetheart_cherry_forcingBB_final_log",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA2$Sweetheart_cherry_forcingBB_final_log) - 1, 
     y = min(LapinsNA2$LT90) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)
```

* * *
# Photoperiod correlation < 25

```{r, echo = hide}
##

sum_lm <- summary(lm(LT10~Photoperiod, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Photoperiod,
     LapinsNA1$LT10,
     xlab="Photoperiod",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Photoperiod) - 1, 
     y = min(LapinsNA1$LT10) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT50~Photoperiod, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Photoperiod,
     LapinsNA1$LT50,
     xlab="Photoperiod",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Photoperiod) - 1, 
     y = min(LapinsNA1$LT50) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)
sum_lm <- summary(lm(LT90~Photoperiod, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Photoperiod,
     LapinsNA1$LT90,
     xlab="Photoperiod",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Photoperiod) - 1, 
     y = min(LapinsNA1$LT90) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)


LapinsNA1$Photoperiod_cube <- (LapinsNA1$Photoperiod)^3

### cubed photoperiod
sum_lm <- summary(lm(LT10~Photoperiod_cube, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Photoperiod_cube,
     LapinsNA1$LT10,
     xlab="Photoperiod_cube",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Photoperiod_cube) - 500, 
     y = min(LapinsNA1$LT10) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT50~Photoperiod_cube, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Photoperiod_cube,
     LapinsNA1$LT50,
     xlab="Photoperiod_cube",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Photoperiod_cube) - 500, 
     y = min(LapinsNA1$LT50) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

sum_lm <- summary(lm(LT90~Photoperiod_cube, data = LapinsNA1))
coef_lm<-sum_lm$coefficients
plot(LapinsNA1$Photoperiod_cube,
     LapinsNA1$LT90,
     xlab="Photoperiod_cube",
     ylab="LT90",
     main= "",
     pch=20)
abline(a = coef_lm[1,1], 
       b = coef_lm[2,1], 
       col = "lightblue",
       lwd = 2)
text(x = max(LapinsNA1$Photoperiod_cube) - 500, 
     y = min(LapinsNA1$LT90) + 2, 
     labels = paste0("r.squared = ",
                     #Round r.squared to 2 decimals
                     round(sum_lm$r.squared,2)),
     adj = 0,
     cex=0.75)

```
# Looking at solar position and Photoperiod
```{R, echo=FALSE}
library('solarPos')

Solar <- as.data.frame(solarPosition(LapinsNA1$Jday, -119.7, 49.6, delta_t = 32.184, elev = 500, temp = LapinsNA1$Temp_mean, pres = 1013.25))
LapinsNA1$solar <- Solar$azimuth

plot(LapinsNA1$Photoperiod,
     LapinsNA1$LT10,
     xlab="Photoperiod",
     ylab="LT10",
     main= "",
     pch=20)

plot(LapinsNA1$solar,
     LapinsNA1$LT10,
     xlab="solar",
     ylab="LT10",
     main= "",
     pch=20)

plot(LapinsNA1$Photoperiod,
     LapinsNA1$LT50,
     xlab="Photoperiod",
     ylab="LT50",
     main= "",
     pch=20)

plot(LapinsNA1$solar,
     LapinsNA1$LT50,
     xlab="solar",
     ylab="LT50",
     main= "",
     pch=20)

plot(LapinsNA1$Photoperiod,
     LapinsNA1$LT90,
     xlab="Photoperiod",
     ylab="LT90",
     main= "",
     pch=20)

plot(LapinsNA1$solar,
     LapinsNA1$LT90,
     xlab="solar",
     ylab="LT90",
     main= "",
     pch=20)

```

* * *
# Initial Modelling: Lapins cherry forcingBB < 25

```{r}
#WITH PHOTOPERIOD
# Initial model fit with corCAR1 temporal autocorrelation structure (to account for uneven sampling dates)
Model10.corCAR1 <- gls(LT10 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final # accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log  # log transformed forcing units
                                 + Photoperiod + solar,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="ML")

Model50.corCAR1 <- gls(LT50 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log  # log transformed forcing units
                                  + Photoperiod+ solar,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="ML")

Model90.corCAR1 <- gls(LT90 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log  # log transformed forcing units
                                  + Photoperiod+ solar,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="ML")

dredge(Model10.corCAR1)
dredge(Model50.corCAR1)
dredge(Model90.corCAR1)

# Photoperiod and solar aziumuth are both in the top models selected by AIC. This was not the case for Sweetheart models which I suspect is an artifact of the fact we have significantly less data for Lapins meaning the LT predictions are trying more heavily to lean on the temporal aspect of photoperiod

```


```{r}
# WITHOUT PHOTOPERIOD
# Initial model fit with corCAR1 temporal autocorrelation structure (to account for uneven sampling dates)
Model10.corCAR1 <- gls(LT10 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final # accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                                  # + Photoperiod_cube,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="ML")

Model50.corCAR1 <- gls(LT50 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                                  # + Photoperiod_cube,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="ML")

Model90.corCAR1 <- gls(LT90 ~ Temp_mean.lag1 + Temp_mean.lag2 + Temp_mean.lag3
                                  + cherry_model_final #accumulated chill 
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                                   #  + Photoperiod_cube,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="ML")

dredge(Model10.corCAR1)
dredge(Model50.corCAR1)
dredge(Model90.corCAR1)
```


```{r}

# Refit top reduced model with REML
S_Model10_cherry_forcingBB <- gls(LT10 ~ Temp_mean.lag1
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="REML")

S_Model50_cherry_forcingBB <- gls(LT50 ~ Temp_mean.lag1 
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="REML")

S_Model90_cherry_forcingBB <- gls(LT90 ~ Temp_mean.lag1 
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="REML")

# Check to see if these variables are significant
summary(S_Model10_cherry_forcingBB)
summary(S_Model50_cherry_forcingBB)
summary(S_Model90_cherry_forcingBB)

# all variables are significant

# Check coefficients and their confidence intervals 
coef(S_Model10_cherry_forcingBB)
coef(S_Model50_cherry_forcingBB)
coef(S_Model90_cherry_forcingBB)
confint(S_Model10_cherry_forcingBB)
confint(S_Model50_cherry_forcingBB)
confint(S_Model90_cherry_forcingBB)

# Plot final model parameter estimates and their confidence intervals
plot(coef(S_Model10_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT10 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model10_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model10_cherry_forcingBB)[,1], y1 = confint(S_Model10_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model50_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT50 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model50_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model50_cherry_forcingBB)[,1], y1 = confint(S_Model50_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model90_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT90 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model90_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model90_cherry_forcingBB)[,1], y1 = confint(S_Model90_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

# Check residuals:
S_Model10_cherry_forcingBB_residuals <- residuals(S_Model10_cherry_forcingBB, type="normalized")
S_Model10_cherry_forcingBB_fitted <- fitted(S_Model10_cherry_forcingBB)

plot(S_Model10_cherry_forcingBB_residuals ~ S_Model10_cherry_forcingBB_fitted,
     main="LT10: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model50_cherry_forcingBB_residuals <- residuals(S_Model50_cherry_forcingBB, type="normalized")
S_Model50_cherry_forcingBB_fitted <- fitted(S_Model50_cherry_forcingBB)

plot(S_Model50_cherry_forcingBB_residuals ~ S_Model50_cherry_forcingBB_fitted,
     main="LT50: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model90_cherry_forcingBB_residuals <- residuals(S_Model90_cherry_forcingBB, type="normalized")
S_Model90_cherry_forcingBB_fitted <- fitted(S_Model90_cherry_forcingBB)

plot(S_Model90_cherry_forcingBB_residuals ~ S_Model90_cherry_forcingBB_fitted,
     main="LT90: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

acf(S_Model10_cherry_forcingBB_residuals)
acf(S_Model50_cherry_forcingBB_residuals)
acf(S_Model90_cherry_forcingBB_residuals)
```

```{r}
# export data frame of the p values, coefficients, and confidence intervals
# Check to see if these variables are significant
  
Model10_p <- as.data.frame(summary(S_Model10_cherry_forcingBB)$tTable[,4])
colnames(Model10_p)[1] = "p"

Model50_p <- as.data.frame(summary(S_Model50_cherry_forcingBB)$tTable[,4])
colnames(Model50_p)[1] = "p"

Model90_p <- as.data.frame(summary(S_Model90_cherry_forcingBB)$tTable[,4])
colnames(Model90_p)[1] = "p"

# all variables are significant

# Check coefficients and their confidence intervals 
Model10_coef <- as.data.frame(coef(S_Model10_cherry_forcingBB))
colnames(Model10_coef)[1] = "coef"
Model10_coef  <- Model10_coef %>% mutate_if(is.numeric, ~round(., 3))
Model50_coef <- as.data.frame(coef(S_Model50_cherry_forcingBB))
colnames(Model50_coef)[1] = "coef"
Model50_coef  <- Model50_coef %>% mutate_if(is.numeric, ~round(., 3))
Model90_coef <- as.data.frame(coef(S_Model90_cherry_forcingBB))
colnames(Model90_coef)[1] = "coef"
Model90_coef  <- Model90_coef %>% mutate_if(is.numeric, ~round(., 3))

Model10_confint <- as.data.frame(confint(S_Model10_cherry_forcingBB))
Model10_confint  <- Model10_confint %>% mutate_if(is.numeric, ~round(., 3))
Model50_confint <- as.data.frame(confint(S_Model50_cherry_forcingBB))
Model50_confint  <- Model50_confint %>% mutate_if(is.numeric, ~round(., 3))
Model90_confint <- as.data.frame(confint(S_Model90_cherry_forcingBB))
Model90_confint  <- Model90_confint %>% mutate_if(is.numeric, ~round(., 3))

Model10_summary <- cbind(Model10_p, Model10_coef, Model10_confint)

Model50_summary <- cbind(Model50_p, Model50_coef, Model50_confint)

Model90_summary <- cbind(Model90_p, Model90_coef, Model90_confint)


Model10_summary$CI <- paste(Model10_summary$'2.5 %', Model10_summary$'97.5 %', sep = ", ")
Model10_summary$coef_CI <- paste(Model10_summary$coef, Model10_summary$CI, sep = " [")
Model10_summary$coef_CI <- paste(Model10_summary$coef_CI,"]", sep = "") # sep for no space
Model10_summary$parameter <- c('Intercept', 'Temp_mean.lag1', 'CU', 'logFU')

Model50_summary$CI <- paste(Model50_summary$'2.5 %', Model50_summary$'97.5 %', sep = ", ")
Model50_summary$coef_CI <- paste(Model50_summary$coef, Model50_summary$CI, sep = " [")
Model50_summary$coef_CI <- paste(Model50_summary$coef_CI,"]", sep = "") # sep for no space
Model50_summary$parameter <- c('Intercept', 'Temp_mean.lag1', 'CU', 'logFU')

Model90_summary$CI <- paste(Model90_summary$'2.5 %', Model90_summary$'97.5 %', sep = ", ")
Model90_summary$coef_CI <- paste(Model90_summary$coef, Model90_summary$CI, sep = " [")
Model90_summary$coef_CI <- paste(Model90_summary$coef_CI,"]", sep = "") # sep for no space
Model90_summary$parameter <- c('Intercept', 'Temp_mean.lag1', 'CU', 'logFU')

write.csv(Model10_summary, file = "./outputs/Model10.Lapins.T1_summary.csv", row.names = FALSE)
write.csv(Model50_summary, file = "./outputs/Model50.Lapins.T1_summary.csv", row.names = FALSE)
write.csv(Model90_summary, file = "./outputs/Model90.Lapins.T1_summary.csv", row.names = FALSE)
```

***
# Model Evaluation: Lapins cherry forcingBB < 25

```{R echo=FALSE, out.width="30%"}
# Separate temperatures by season so that you can make predictions from fit model
Predict.Season4 <- subset(Lapins1, Date >= "2013-09-15" & Date <= "2014-04-29")
# Predict.Season5 <- subset(Lapins1, Date >= "2014-09-15" & Date <= "2015-04-29")
Predict.Season6 <- subset(Lapins1, Date >= "2015-09-15" & Date <= "2016-04-29")
Predict.Season7 <- subset(Lapins1, Date >= "2016-09-15" & Date <= "2017-04-29")




Model10.m <- gls(LT10 ~ Temp_mean.lag1 
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="REML")

Model50.m <- gls(LT50 ~ Temp_mean.lag1 
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="REML")

Model90.m <- gls(LT90 ~ Temp_mean.lag1 
                                  + cherry_model_final #accumulated chill
                                  + Sweetheart_cherry_forcingBB_final_log,  # log transformed forcing units
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA1,
                       method="REML")



# Save models as RData files to be used to make predictions later on or in other .R or .Rmd files more easily
# save(Model10.m, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model10_Lapins1.RData")
# save(Model50.m, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model50_Lapins1.RData")
# save(Model90.m, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model90_Lapins1.RData")

## Season4
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season4 <- as.data.frame(predict(Model10.m, newdata= Predict.Season4, se= TRUE))
Model10.m_Predict.Season4 <- Model10.m_Predict.Season4 %>% dplyr::rename("Model10.m_Predict.Season4"="fit")
Model10.m_Predict.Season4 <- Model10.m_Predict.Season4 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season4 <- as.data.frame(predict(Model50.m, newdata= Predict.Season4, se= TRUE))
Model50.m_Predict.Season4 <- Model50.m_Predict.Season4 %>% dplyr::rename("Model50.m_Predict.Season4"="fit")
Model50.m_Predict.Season4 <- Model50.m_Predict.Season4 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season4 <- as.data.frame(predict(Model90.m, newdata= Predict.Season4, se= TRUE))
Model90.m_Predict.Season4 <- Model90.m_Predict.Season4 %>% dplyr::rename("Model90.m_Predict.Season4"="fit")
Model90.m_Predict.Season4 <- Model90.m_Predict.Season4 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season4 <- cbind(Predict.Season4, 
                         Model10.m_Predict.Season4, 
                         Model50.m_Predict.Season4, 
                         Model90.m_Predict.Season4)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season4~ LT10, data=Predict.Season4)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season4~ LT10, data=Predict.Season4))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season4 ~ LT10, data=Predict.Season4,
     main="Season4 LT10: 2013-2014",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season4 ~ LT10, data=Predict.Season4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season4~ LT50, data=Predict.Season4)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season4~ LT50, data=Predict.Season4))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season4 ~ LT50, data=Predict.Season4,
     main="Season4 LT50: 2013-2014",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season4 ~ LT50, data=Predict.Season4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season4~ LT90, data=Predict.Season4)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season4~ LT90, data=Predict.Season4))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season4 ~ LT90, data=Predict.Season4,
     main="Season4 LT90: 2013-2014",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season4 ~ LT90, data=Predict.Season4), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

# ## Season5
# # Find the predicted model values from each season for LT10, LT50, LT90
# Model10.m_Predict.Season5 <- as.data.frame(predict(Model10.m, newdata= Predict.Season5, se= TRUE))
# Model10.m_Predict.Season5 <- Model10.m_Predict.Season5 %>% dplyr::rename("Model10.m_Predict.Season5"="fit")
# Model10.m_Predict.Season5 <- Model10.m_Predict.Season5 %>% dplyr::rename("se.fit.10"="se.fit")
# 
# 
# Model50.m_Predict.Season5 <- as.data.frame(predict(Model50.m, newdata= Predict.Season5, se= TRUE))
# Model50.m_Predict.Season5 <- Model50.m_Predict.Season5 %>% dplyr::rename("Model50.m_Predict.Season5"="fit")
# Model50.m_Predict.Season5 <- Model50.m_Predict.Season5 %>% dplyr::rename("se.fit.50"="se.fit")
# 
# Model90.m_Predict.Season5 <- as.data.frame(predict(Model90.m, newdata= Predict.Season5, se= TRUE))
# Model90.m_Predict.Season5 <- Model90.m_Predict.Season5 %>% dplyr::rename("Model90.m_Predict.Season5"="fit")
# Model90.m_Predict.Season5 <- Model90.m_Predict.Season5 %>% dplyr::rename("se.fit.90"="se.fit")
# 
# 
# # Add to data frame
# Predict.Season5 <- cbind(Predict.Season5, 
#                          Model10.m_Predict.Season5, 
#                          Model50.m_Predict.Season5, 
#                          Model90.m_Predict.Season5)
# 
# # plot these three functions with 1:1 line against each other with R2 value
# par(pty="s")
# Model10.m.1 <- lm(Model10.m_Predict.Season5~ LT10, data=Predict.Season5)
# Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season5~ LT10, data=Predict.Season5))
# r2 <- Model10.m.1.sum$r.squared
# RMSE <- sqrt(mean(Model10.m.1$residuals^2))
# rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
# RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
# plot(Model10.m_Predict.Season5 ~ LT10, data=Predict.Season5,
#      main="Season5 LT10: 2014-2015",
#      pch=20,
#      xlab="Temperature (˚C)", 
#      ylab="Temperature (˚C)",
#      xlim= c(-30, 0),
#      ylim= c(-30, 0))
# abline(lm(Model10.m_Predict.Season5 ~ LT10, data=Predict.Season5), lty=2)
# abline(0, 1)
# text(-25,-1, rlabel, cex=0.75)
# text(-25,-3, RMSElabel, cex=0.75)
# 
# par(pty="s")
# Model50.m.1 <- lm(Model50.m_Predict.Season5~ LT50, data=Predict.Season5)
# Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season5~ LT50, data=Predict.Season5))
# r2 <- Model50.m.1.sum$r.squared
# RMSE <- sqrt(mean(Model50.m.1$residuals^2))
# rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
# RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
# plot(Model50.m_Predict.Season5 ~ LT50, data=Predict.Season5,
#      main="Season5 LT50: 2014-2015",
#      pch=20,
#      xlab="Temperature (˚C)", 
#      ylab="Temperature (˚C)",
#      xlim= c(-30, 0),
#      ylim= c(-30, 0))
# abline(lm(Model50.m_Predict.Season5 ~ LT50, data=Predict.Season5), lty=2)
# abline(0, 1)
# text(-25,-1, rlabel, cex=0.75)
# text(-25,-3, RMSElabel, cex=0.75)
# 
# par(pty="s")
# Model90.m.1 <- lm(Model90.m_Predict.Season5~ LT90, data=Predict.Season5)
# Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season5~ LT90, data=Predict.Season5))
# r2 <- Model90.m.1.sum$r.squared
# RMSE <- sqrt(mean(Model90.m.1$residuals^2))
# rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
# RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
# plot(Model90.m_Predict.Season5 ~ LT90, data=Predict.Season5,
#      main="Season5 LT90: 2014-2015",
#      pch=20,
#      xlab="Temperature (˚C)", 
#      ylab="Temperature (˚C)",
#      xlim= c(-30, 0),
#      ylim= c(-30, 0))
# abline(lm(Model90.m_Predict.Season5 ~ LT90, data=Predict.Season5), lty=2)
# abline(0, 1)
# text(-25,-1, rlabel, cex=0.75)
# text(-25,-3, RMSElabel, cex=0.75)

## Season6
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season6 <- as.data.frame(predict(Model10.m, newdata= Predict.Season6, se= TRUE))
Model10.m_Predict.Season6 <- Model10.m_Predict.Season6 %>% dplyr::rename("Model10.m_Predict.Season6"="fit")
Model10.m_Predict.Season6 <- Model10.m_Predict.Season6 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season6 <- as.data.frame(predict(Model50.m, newdata= Predict.Season6, se= TRUE))
Model50.m_Predict.Season6 <- Model50.m_Predict.Season6 %>% dplyr::rename("Model50.m_Predict.Season6"="fit")
Model50.m_Predict.Season6 <- Model50.m_Predict.Season6 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season6 <- as.data.frame(predict(Model90.m, newdata= Predict.Season6, se= TRUE))
Model90.m_Predict.Season6 <- Model90.m_Predict.Season6 %>% dplyr::rename("Model90.m_Predict.Season6"="fit")
Model90.m_Predict.Season6 <- Model90.m_Predict.Season6 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season6 <- cbind(Predict.Season6, 
                         Model10.m_Predict.Season6, 
                         Model50.m_Predict.Season6, 
                         Model90.m_Predict.Season6)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season6~ LT10, data=Predict.Season6)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season6~ LT10, data=Predict.Season6))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season6 ~ LT10, data=Predict.Season6,
     main="Season6 LT10: 2015-2016",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season6 ~ LT10, data=Predict.Season6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season6~ LT50, data=Predict.Season6)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season6~ LT50, data=Predict.Season6))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season6 ~ LT50, data=Predict.Season6,
     main="Season6 LT50: 2015-2016",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season6 ~ LT50, data=Predict.Season6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season6~ LT90, data=Predict.Season6)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season6~ LT90, data=Predict.Season6))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season6 ~ LT90, data=Predict.Season6,
     main="Season6 LT90: 2015-2016",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season6 ~ LT90, data=Predict.Season6), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

## Season7
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m_Predict.Season7 <- as.data.frame(predict(Model10.m, newdata= Predict.Season7, se= TRUE))
Model10.m_Predict.Season7 <- Model10.m_Predict.Season7 %>% dplyr::rename("Model10.m_Predict.Season7"="fit")
Model10.m_Predict.Season7 <- Model10.m_Predict.Season7 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m_Predict.Season7 <- as.data.frame(predict(Model50.m, newdata= Predict.Season7, se= TRUE))
Model50.m_Predict.Season7 <- Model50.m_Predict.Season7 %>% dplyr::rename("Model50.m_Predict.Season7"="fit")
Model50.m_Predict.Season7 <- Model50.m_Predict.Season7 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m_Predict.Season7 <- as.data.frame(predict(Model90.m, newdata= Predict.Season7, se= TRUE))
Model90.m_Predict.Season7 <- Model90.m_Predict.Season7 %>% dplyr::rename("Model90.m_Predict.Season7"="fit")
Model90.m_Predict.Season7 <- Model90.m_Predict.Season7 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season7 <- cbind(Predict.Season7, 
                         Model10.m_Predict.Season7, 
                         Model50.m_Predict.Season7, 
                         Model90.m_Predict.Season7)

# plot these three functions with 1:1 line against each other with R2 value
par(pty="s")
Model10.m.1 <- lm(Model10.m_Predict.Season7~ LT10, data=Predict.Season7)
Model10.m.1.sum <- summary(lm(Model10.m_Predict.Season7~ LT10, data=Predict.Season7))
r2 <- Model10.m.1.sum$r.squared
RMSE <- sqrt(mean(Model10.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10.m_Predict.Season7 ~ LT10, data=Predict.Season7,
     main="Season7 LT10: 2016-2017",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model10.m_Predict.Season7 ~ LT10, data=Predict.Season7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.m.1 <- lm(Model50.m_Predict.Season7~ LT50, data=Predict.Season7)
Model50.m.1.sum <- summary(lm(Model50.m_Predict.Season7~ LT50, data=Predict.Season7))
r2 <- Model50.m.1.sum$r.squared
RMSE <- sqrt(mean(Model50.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50.m_Predict.Season7 ~ LT50, data=Predict.Season7,
     main="Season7 LT50: 2016-2017",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model50.m_Predict.Season7 ~ LT50, data=Predict.Season7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.m.1 <- lm(Model90.m_Predict.Season7~ LT90, data=Predict.Season7)
Model90.m.1.sum <- summary(lm(Model90.m_Predict.Season7~ LT90, data=Predict.Season7))
r2 <- Model90.m.1.sum$r.squared
RMSE <- sqrt(mean(Model90.m.1$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90.m_Predict.Season7 ~ LT90, data=Predict.Season7,
     main="Season7 LT90: 2016-2017",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0))
abline(lm(Model90.m_Predict.Season7 ~ LT90, data=Predict.Season7), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)


# dplyr::rename columns so that you can merge your data
Predict.Season4.m <- Predict.Season4 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season4")
Predict.Season4.m <- Predict.Season4.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season4")
Predict.Season4.m <- Predict.Season4.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season4")

# Predict.Season5.m <- Predict.Season5 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season5")
# Predict.Season5.m <- Predict.Season5.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season5")
# Predict.Season5.m <- Predict.Season5.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season5")

Predict.Season6.m <- Predict.Season6 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season6")
Predict.Season6.m <- Predict.Season6.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season6")
Predict.Season6.m <- Predict.Season6.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season6")

Predict.Season7.m <- Predict.Season7 %>% dplyr::rename("Model10" = "Model10.m_Predict.Season7")
Predict.Season7.m <- Predict.Season7.m %>% dplyr::rename("Model50" = "Model50.m_Predict.Season7")
Predict.Season7.m <- Predict.Season7.m %>% dplyr::rename("Model90" = "Model90.m_Predict.Season7")


AllSeasons_m <- rbind(Predict.Season4.m,
                            # Predict.Season5.m,
                            Predict.Season6.m,
                            Predict.Season7.m)


# plot these three functions with 1:1 line against each other with R2 value (for all seasons)
par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=AllSeasons_m)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=AllSeasons_m))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=AllSeasons_m,
     main="All Seasons LT10 Lapins cherry forcingBB",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model10 ~ LT10, data=AllSeasons_m), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=AllSeasons_m)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=AllSeasons_m))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=AllSeasons_m,
     main="All Seasons LT50 Lapins cherry forcingBB",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model50 ~ LT50, data=AllSeasons_m), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=AllSeasons_m)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=AllSeasons_m))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=AllSeasons_m,
     main="All Seasons LT90 Lapins cherry forcingBB",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model90 ~ LT90, data=AllSeasons_m), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```

```{R echo = FALSE}
# Calculate RMSE of the three models
T1_LT10 <- sqrt(mean(Model10.m$residuals^2))
T1_LT50 <- sqrt(mean(Model50.m$residuals^2))
T1_LT90 <- sqrt(mean(Model90.m$residuals^2))

Model1RMSE <- as.data.frame(rbind(T1_LT10, T1_LT50, T1_LT90))
Model1RMSE <- Model1RMSE %>% 
  rename(RMSE = V1)
Model1RMSE <- Model1RMSE %>% mutate_if(is.numeric, ~round(., 3))

# calculate Index of agreement (hydroGOF package fn d())
AllSeasonsNA <- na.omit(AllSeasons_m)
Model10.gls_predicted <- AllSeasonsNA$Model10
Model10.gls_observed <- AllSeasonsNA$LT10
d_gls10 <- d(Model10.gls_predicted, Model10.gls_observed)

Model50.gls_predicted <- AllSeasonsNA$Model50
Model50.gls_observed <- AllSeasonsNA$LT50
d_gls50 <- d(Model50.gls_predicted, Model50.gls_observed)

Model90.gls_predicted <- AllSeasonsNA$Model90
Model90.gls_observed <- AllSeasonsNA$LT90
d_gls90 <- d(Model90.gls_predicted, Model90.gls_observed)

Model1.d <- as.data.frame(rbind(d_gls10, d_gls50, d_gls90))
Model1.d <- Model1.d %>% 
  rename(d = V1)
Model1.d <- Model1.d %>% mutate_if(is.numeric, ~round(., 3))


Model1_RMSE_d <- cbind(Model1RMSE, Model1.d)

Model1_RMSE_d
Model1_RMSE_d$Model <- c('T1_LT10', 'T1_LT50', 'T1_LT90')
Model1_RMSE_d  <- Model1_RMSE_d %>% mutate_if(is.numeric, ~round(., 2))

write.csv(Model1_RMSE_d, file = "./outputs/Lapins.T1_RMSE_d.csv", row.names = FALSE)
```

* * *
# Model Visualization: Lapins cherry forcingBB < 25

```{R echo = FALSE, out.width="30%"}

Predict.Season4.m$Date <- as.Date(Predict.Season4.m$Date)
# Predict.Season5.m$Date <- as.Date(Predict.Season5.m$Date)
Predict.Season6.m$Date <- as.Date(Predict.Season6.m$Date)
Predict.Season7.m$Date <- as.Date(Predict.Season7.m$Date)


# Assume approximately 2 standard errors produces the confidence intervals


# Season4
LT10.CIUpper <- (Predict.Season4.m$Model10 + Predict.Season4.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season4.m$Model10 - Predict.Season4.m$se.fit.10*1.96)
Season4.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season4.LT10.CI <- as.data.frame(Season4.LT10.CI)

LT50.CIUpper <- (Predict.Season4.m$Model50 + Predict.Season4.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season4.m$Model50 - Predict.Season4.m$se.fit.50*1.96)
Season4.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season4.LT50.CI <- as.data.frame(Season4.LT50.CI)

LT90.CIUpper <- (Predict.Season4.m$Model90 + Predict.Season4.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season4.m$Model90 - Predict.Season4.m$se.fit.90*1.96)
Season4.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season4.LT90.CI <- as.data.frame(Season4.LT90.CI)

Predict.Season4.m <- cbind(Predict.Season4.m, Season4.LT10.CI, Season4.LT50.CI, Season4.LT90.CI)


# Plot

plot(LT10 ~ Date, data=Predict.Season4.m,
     main= "LT10 Season4",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT10.CIUpper, lty = 2)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season4.m,
     main= "LT50 Season4",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT50.CIUpper, lty = 2)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season4.m,
     main= "LT90 Season4",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.m$Date, Predict.Season4.m$Model90, lty = 1)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT90.CIUpper, lty = 2)
lines(Predict.Season4.m$Date, Predict.Season4.m$LT90.CILower, lty = 2)

# # Season5
# LT10.CIUpper <- (Predict.Season5.m$Model10 + Predict.Season5.m$se.fit.10*1.96)
# LT10.CILower <- (Predict.Season5.m$Model10 - Predict.Season5.m$se.fit.10*1.96)
# Season5.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
# Season5.LT10.CI <- as.data.frame(Season5.LT10.CI)
# 
# LT50.CIUpper <- (Predict.Season5.m$Model50 + Predict.Season5.m$se.fit.50*1.96)
# LT50.CILower <- (Predict.Season5.m$Model50 - Predict.Season5.m$se.fit.50*1.96)
# Season5.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
# Season5.LT50.CI <- as.data.frame(Season5.LT50.CI)
# 
# LT90.CIUpper <- (Predict.Season5.m$Model90 + Predict.Season5.m$se.fit.90*1.96)
# LT90.CILower <- (Predict.Season5.m$Model90 - Predict.Season5.m$se.fit.90*1.96)
# Season5.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
# Season5.LT90.CI <- as.data.frame(Season5.LT90.CI)
# 
# Predict.Season5.m <- cbind(Predict.Season5.m, Season5.LT10.CI, Season5.LT50.CI, Season5.LT90.CI)
# 
# 
# # Plot
# plot(LT10 ~ Date, data=Predict.Season5.m,
#      main= "LT10 Season5",
#      pch= 20,
#      xlab="Cumulative Julian Day", 
#      ylab="LT10 (˚C)",
#      cex.main=1.25, 
#      cex.lab=1, ylim=c(-30, 0))
# lines(Predict.Season5.m$Date, Predict.Season5.m$Model10, lty = 1)
# lines(Predict.Season5.m$Date, Predict.Season5.m$LT10.CIUpper, lty = 2)
# lines(Predict.Season5.m$Date, Predict.Season5.m$LT10.CILower, lty = 2)
# 
# plot(LT50 ~ Date, data=Predict.Season5.m,
#      main= "LT50 Season5",
#      pch= 20,
#      xlab="Cumulative Julian Day", 
#      ylab="LT50 (˚C)",
#      cex.main=1.25, 
#      cex.lab=1, ylim=c(-30, 0))
# lines(Predict.Season5.m$Date, Predict.Season5.m$Model50, lty = 1)
# lines(Predict.Season5.m$Date, Predict.Season5.m$LT50.CIUpper, lty = 2)
# lines(Predict.Season5.m$Date, Predict.Season5.m$LT50.CILower, lty = 2)
# 
# plot(LT90 ~ Date, data=Predict.Season5.m,
#      main= "LT90 Season5",
#      pch= 20,
#      xlab="Cumulative Julian Day", 
#      ylab="LT90 (˚C)",
#      cex.main=1.25, 
#      cex.lab=1, ylim=c(-30, 0))
# lines(Predict.Season5.m$Date, Predict.Season5.m$Model90, lty = 1)
# lines(Predict.Season5.m$Date, Predict.Season5.m$LT90.CIUpper, lty = 2)
# lines(Predict.Season5.m$Date, Predict.Season5.m$LT90.CILower, lty = 2)

# Season6
LT10.CIUpper <- (Predict.Season6.m$Model10 + Predict.Season6.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season6.m$Model10 - Predict.Season6.m$se.fit.10*1.96)
Season6.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season6.LT10.CI <- as.data.frame(Season6.LT10.CI)

LT50.CIUpper <- (Predict.Season6.m$Model50 + Predict.Season6.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season6.m$Model50 - Predict.Season6.m$se.fit.50*1.96)
Season6.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season6.LT50.CI <- as.data.frame(Season6.LT50.CI)

LT90.CIUpper <- (Predict.Season6.m$Model90 + Predict.Season6.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season6.m$Model90 - Predict.Season6.m$se.fit.90*1.96)
Season6.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season6.LT90.CI <- as.data.frame(Season6.LT90.CI)

Predict.Season6.m <- cbind(Predict.Season6.m, Season6.LT10.CI, Season6.LT50.CI, Season6.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season6.m,
     main= "LT10 Season6",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.m$Date, Predict.Season6.m$Model10, lty = 1)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT10.CIUpper, lty = 2)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season6.m,
     main= "LT50 Season6",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT50.CIUpper, lty = 2)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season6.m,
     main= "LT90 Season6",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.m$Date, Predict.Season6.m$Model90, lty = 1)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT90.CIUpper, lty = 2)
lines(Predict.Season6.m$Date, Predict.Season6.m$LT90.CILower, lty = 2)

# Season7
LT10.CIUpper <- (Predict.Season7.m$Model10 + Predict.Season7.m$se.fit.10*1.96)
LT10.CILower <- (Predict.Season7.m$Model10 - Predict.Season7.m$se.fit.10*1.96)
Season7.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season7.LT10.CI <- as.data.frame(Season7.LT10.CI)

LT50.CIUpper <- (Predict.Season7.m$Model50 + Predict.Season7.m$se.fit.50*1.96)
LT50.CILower <- (Predict.Season7.m$Model50 - Predict.Season7.m$se.fit.50*1.96)
Season7.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season7.LT50.CI <- as.data.frame(Season7.LT50.CI)

LT90.CIUpper <- (Predict.Season7.m$Model90 + Predict.Season7.m$se.fit.90*1.96)
LT90.CILower <- (Predict.Season7.m$Model90 - Predict.Season7.m$se.fit.90*1.96)
Season7.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season7.LT90.CI <- as.data.frame(Season7.LT90.CI)

Predict.Season7.m <- cbind(Predict.Season7.m, Season7.LT10.CI, Season7.LT50.CI, Season7.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season7.m,
     main= "LT10 Season7",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.m$Date, Predict.Season7.m$Model10, lty = 1)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT10.CIUpper, lty = 2)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season7.m,
     main= "LT50 Season7",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.m$Date, Predict.Season7.m$Model50, lty = 1)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT50.CIUpper, lty = 2)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season7.m,
     main= "LT90 Season7",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.m$Date, Predict.Season7.m$Model90, lty = 1)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT90.CIUpper, lty = 2)
lines(Predict.Season7.m$Date, Predict.Season7.m$LT90.CILower, lty = 2)


```
# Looking at solar position and Photoperiod
```{R, echo=FALSE}
library('solarPos')

Solar <- as.data.frame(solarPosition(LapinsNA2$Jday, -119.7, 49.6, delta_t = 32.184, elev = 500, temp = LapinsNA2$Temp_mean, pres = 1013.25))
LapinsNA2$solar <- Solar$azimuth

plot(LapinsNA2$Photoperiod,
     LapinsNA2$LT10,
     xlab="Photoperiod",
     ylab="LT10",
     main= "",
     pch=20)

plot(LapinsNA2$solar,
     LapinsNA2$LT10,
     xlab="solar",
     ylab="LT10",
     main= "",
     pch=20)

plot(LapinsNA2$Photoperiod,
     LapinsNA2$LT50,
     xlab="Photoperiod",
     ylab="LT50",
     main= "",
     pch=20)

plot(LapinsNA2$solar,
     LapinsNA2$LT50,
     xlab="solar",
     ylab="LT50",
     main= "",
     pch=20)

plot(LapinsNA2$Photoperiod,
     LapinsNA2$LT90,
     xlab="Photoperiod",
     ylab="LT90",
     main= "",
     pch=20)

plot(LapinsNA2$solar,
     LapinsNA2$LT90,
     xlab="solar",
     ylab="LT90",
     main= "",
     pch=20)

```                       
* * *
# Initial Modelling: Lapins cherry forcingBB >= 25

```{r}
Model10.corCAR1 <- gls(LT10 ~ stages +
                                    Sweetheart_cherry_forcingBB_final,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="ML")

Model50.corCAR1 <- gls(LT50 ~ stages +
                                    Sweetheart_cherry_forcingBB_final,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="ML")

Model90.corCAR1 <- gls(LT90 ~ stages +
                                    Sweetheart_cherry_forcingBB_final,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="ML")

# Check which variables should be included
dredge(Model10.corCAR1)
dredge(Model50.corCAR1)
dredge(Model90.corCAR1)
```

```{r}
# intercept only model is the top model
# drop variables and refit with REML
S_Model10_cherry_forcingBB <- gls(LT10 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="REML")

S_Model50_cherry_forcingBB <- gls(LT50 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="REML")

S_Model90_cherry_forcingBB <- gls(LT90 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="REML")


# Check to see if these variables are significant
sum1 <- summary(S_Model10_cherry_forcingBB)
sum2 <- summary(S_Model50_cherry_forcingBB)
sum3 <- summary(S_Model90_cherry_forcingBB)


# Check coefficients and their confidence intervals 
coef(S_Model10_cherry_forcingBB)
coef(S_Model50_cherry_forcingBB)
coef(S_Model90_cherry_forcingBB)
confint(S_Model10_cherry_forcingBB)
confint(S_Model50_cherry_forcingBB)
confint(S_Model90_cherry_forcingBB)

# Plot final model parameter estimates and their confidence intervals
plot(coef(S_Model10_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT10 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model10_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model10_cherry_forcingBB)[,1], y1 = confint(S_Model10_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model50_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT50 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model50_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model50_cherry_forcingBB)[,1], y1 = confint(S_Model50_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

plot(coef(S_Model90_cherry_forcingBB),
     axes = F,
     pch = 16,
     ylim = c(-30, 10),
     main = "LT90 Parameter Estimates",
     xlab = "",
     ylab = expression(beta),
     cex = 0.7)
text(x =  1:6, y = par("usr")[3]-0.05, srt = 40, adj = 1,
     labels = names(coef(S_Model90_cherry_forcingBB)), xpd = TRUE, cex = 0.7)
segments(x0 = 1:6, x1 = 1:6, y0 = confint(S_Model90_cherry_forcingBB)[,1], y1 = confint(S_Model90_cherry_forcingBB)[,2])
axis(2)
abline(h = 0, col = "grey", lty = 2)
box()

# Check residuals:
S_Model10_cherry_forcingBB_residuals <- residuals(S_Model10_cherry_forcingBB, type="normalized")
S_Model10_cherry_forcingBB_fitted <- fitted(S_Model10_cherry_forcingBB)

plot(S_Model10_cherry_forcingBB_residuals ~ S_Model10_cherry_forcingBB_fitted,
     main="LT10: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model50_cherry_forcingBB_residuals <- residuals(S_Model50_cherry_forcingBB, type="normalized")
S_Model50_cherry_forcingBB_fitted <- fitted(S_Model50_cherry_forcingBB)

plot(S_Model50_cherry_forcingBB_residuals ~ S_Model50_cherry_forcingBB_fitted,
     main="LT50: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

S_Model90_cherry_forcingBB_residuals <- residuals(S_Model90_cherry_forcingBB, type="normalized")
S_Model90_cherry_forcingBB_fitted <- fitted(S_Model90_cherry_forcingBB)

plot(S_Model90_cherry_forcingBB_residuals ~ S_Model90_cherry_forcingBB_fitted,
     main="LT90: Residuals vs Fitted Values",
     pch=1,
     xlab="Fitted Values", 
     ylab="Residual")

acf(S_Model10_cherry_forcingBB_residuals)
acf(S_Model50_cherry_forcingBB_residuals)
acf(S_Model90_cherry_forcingBB_residuals)
```
```{r}
# Check coefficients and their confidence intervals 
Model10_coef <- as.data.frame(coef(S_Model10_cherry_forcingBB))
colnames(Model10_coef)[1] = "coef"
Model10_coef  <- Model10_coef %>% mutate_if(is.numeric, ~round(., 3))
Model50_coef <- as.data.frame(coef(S_Model50_cherry_forcingBB))
colnames(Model50_coef)[1] = "coef"
Model50_coef  <- Model50_coef %>% mutate_if(is.numeric, ~round(., 3))
Model90_coef <- as.data.frame(coef(S_Model90_cherry_forcingBB))
colnames(Model90_coef)[1] = "coef"
Model90_coef  <- Model90_coef %>% mutate_if(is.numeric, ~round(., 3))

Model10_confint <- as.data.frame(confint(S_Model10_cherry_forcingBB))
Model10_confint  <- Model10_confint %>% mutate_if(is.numeric, ~round(., 3))
Model50_confint <- as.data.frame(confint(S_Model50_cherry_forcingBB))
Model50_confint  <- Model50_confint %>% mutate_if(is.numeric, ~round(., 3))
Model90_confint <- as.data.frame(confint(S_Model90_cherry_forcingBB))
Model90_confint  <- Model90_confint %>% mutate_if(is.numeric, ~round(., 3))

Model10_summary <- cbind(Model10_p, Model10_coef, Model10_confint)

Model50_summary <- cbind(Model50_p, Model50_coef, Model50_confint)

Model90_summary <- cbind(Model90_p, Model90_coef, Model90_confint)


Model10_summary$CI <- paste(Model10_summary$'2.5 %', Model10_summary$'97.5 %', sep = ", ")
Model10_summary$coef_CI <- paste(Model10_summary$coef, Model10_summary$CI, sep = " [")
Model10_summary$coef_CI <- paste(Model10_summary$coef_CI,"]", sep = "") # sep for no space
Model10_summary$parameter <- c('Intercept')

Model50_summary$CI <- paste(Model50_summary$'2.5 %', Model50_summary$'97.5 %', sep = ", ")
Model50_summary$coef_CI <- paste(Model50_summary$coef, Model50_summary$CI, sep = " [")
Model50_summary$coef_CI <- paste(Model50_summary$coef_CI,"]", sep = "") # sep for no space
Model50_summary$parameter <- c('Intercept')

Model90_summary$CI <- paste(Model90_summary$'2.5 %', Model90_summary$'97.5 %', sep = ", ")
Model90_summary$coef_CI <- paste(Model90_summary$coef, Model90_summary$CI, sep = " [")
Model90_summary$coef_CI <- paste(Model90_summary$coef_CI,"]", sep = "") # sep for no space
Model90_summary$parameter <- c('Intercept')

write.csv(Model10_summary, file = "./outputs/Model10.Lapins.T2_summary.csv", row.names = FALSE)
write.csv(Model50_summary, file = "./outputs/Model50.Lapins.T2_summary.csv", row.names = FALSE)
write.csv(Model90_summary, file = "./outputs/Model90.Lapins.T2_summary.csv", row.names = FALSE)
```

***
# Model Evaluation: Lapins cherry forcingBB >= 25

```{R echo=FALSE, out.width="30%"}

# Separate temperatures by season so that you can make predictions from fit model
Predict.Season4.2 <- subset(Lapins2, Date >= "2013-09-15" & Date <= "2014-04-29")
# Predict.Season5.2 <- subset(Lapins2, Date >= "2014-09-15" & Date <= "2015-04-29")
Predict.Season6.2 <- subset(Lapins2, Date >= "2015-09-15" & Date <= "2016-04-29")
Predict.Season7.2 <- subset(Lapins2, Date >= "2016-09-15" & Date <= "2017-04-29")

# Rename new models so you dont have to alter the code throughout

Model10.m2<- gls(LT10 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="REML")

Model50.m2 <- gls(LT50 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="REML")

Model90.m2 <- gls(LT90 ~ 1,
                          # correlation = corCAR1(form = ~ Date),
                          data=LapinsNA2,
                       method="REML")


# Save models as RData files to be used to make predictions later on or in other .R or .Rmd files more easily
# save(Model10.m2, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model10_Lapins2.RData")
# save(Model50.m2, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model50_Lapins2.RData")
# save(Model90.m2, file= "/Users/Elizabeth/Desktop/Model_final2023/Sweetheart_final/Model90_Lapins2.RData")

# Check to see if these variables are significant
Model10_p <- as.data.frame(summary(Model10.m2)$tTable[,4])
colnames(Model10_p)[1] = "p"

Model50_p <- as.data.frame(summary(Model50.m2)$tTable[,4])
colnames(Model50_p)[1] = "p"

Model90_p <- as.data.frame(summary(Model90.m2)$tTable[,4])
colnames(Model90_p)[1] = "p"

# all variables are significant
Model10_p
Model50_p
Model90_p

## Season4
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season4.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season4.2, se= TRUE))
Model10.m2_Predict.Season4.2 <- Model10.m2_Predict.Season4.2 %>% dplyr::rename("Model10.m2_Predict.Season4.2"="fit")
Model10.m2_Predict.Season4.2 <- Model10.m2_Predict.Season4.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season4.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season4.2, se= TRUE))
Model50.m2_Predict.Season4.2 <- Model50.m2_Predict.Season4.2 %>% dplyr::rename("Model50.m2_Predict.Season4.2"="fit")
Model50.m2_Predict.Season4.2 <- Model50.m2_Predict.Season4.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season4.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season4.2, se= TRUE))
Model90.m2_Predict.Season4.2 <- Model90.m2_Predict.Season4.2 %>% dplyr::rename("Model90.m2_Predict.Season4.2"="fit")
Model90.m2_Predict.Season4.2 <- Model90.m2_Predict.Season4.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season4.2 <- cbind(Predict.Season4.2, 
                         Model10.m2_Predict.Season4.2, 
                         Model50.m2_Predict.Season4.2, 
                         Model90.m2_Predict.Season4.2)


# ## Season5
# # Find the predicted model values from each season for LT10, LT50, LT90
# Model10.m2_Predict.Season5.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season5.2, se= TRUE))
# Model10.m2_Predict.Season5.2 <- Model10.m2_Predict.Season5.2 %>% dplyr::rename("Model10.m2_Predict.Season5.2"="fit")
# Model10.m2_Predict.Season5.2 <- Model10.m2_Predict.Season5.2 %>% dplyr::rename("se.fit.10"="se.fit")
# 
# 
# Model50.m2_Predict.Season5.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season5.2, se= TRUE))
# Model50.m2_Predict.Season5.2 <- Model50.m2_Predict.Season5.2 %>% dplyr::rename("Model50.m2_Predict.Season5.2"="fit")
# Model50.m2_Predict.Season5.2 <- Model50.m2_Predict.Season5.2 %>% dplyr::rename("se.fit.50"="se.fit")
# 
# Model90.m2_Predict.Season5.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season5.2, se= TRUE))
# Model90.m2_Predict.Season5.2 <- Model90.m2_Predict.Season5.2 %>% dplyr::rename("Model90.m2_Predict.Season5.2"="fit")
# Model90.m2_Predict.Season5.2 <- Model90.m2_Predict.Season5.2 %>% dplyr::rename("se.fit.90"="se.fit")
# 
# 
# # Add to data frame
# Predict.Season5.2 <- cbind(Predict.Season5.2, 
#                          Model10.m2_Predict.Season5.2, 
#                          Model50.m2_Predict.Season5.2, 
#                          Model90.m2_Predict.Season5.2)


## Season6
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season6.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season6.2, se= TRUE))
Model10.m2_Predict.Season6.2 <- Model10.m2_Predict.Season6.2 %>% dplyr::rename("Model10.m2_Predict.Season6.2"="fit")
Model10.m2_Predict.Season6.2 <- Model10.m2_Predict.Season6.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season6.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season6.2, se= TRUE))
Model50.m2_Predict.Season6.2 <- Model50.m2_Predict.Season6.2 %>% dplyr::rename("Model50.m2_Predict.Season6.2"="fit")
Model50.m2_Predict.Season6.2 <- Model50.m2_Predict.Season6.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season6.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season6.2, se= TRUE))
Model90.m2_Predict.Season6.2 <- Model90.m2_Predict.Season6.2 %>% dplyr::rename("Model90.m2_Predict.Season6.2"="fit")
Model90.m2_Predict.Season6.2 <- Model90.m2_Predict.Season6.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season6.2 <- cbind(Predict.Season6.2, 
                         Model10.m2_Predict.Season6.2, 
                         Model50.m2_Predict.Season6.2, 
                         Model90.m2_Predict.Season6.2)


## Season7
# Find the predicted model values from each season for LT10, LT50, LT90
Model10.m2_Predict.Season7.2 <- as.data.frame(predict(Model10.m2, newdata= Predict.Season7.2, se= TRUE))
Model10.m2_Predict.Season7.2 <- Model10.m2_Predict.Season7.2 %>% dplyr::rename("Model10.m2_Predict.Season7.2"="fit")
Model10.m2_Predict.Season7.2 <- Model10.m2_Predict.Season7.2 %>% dplyr::rename("se.fit.10"="se.fit")


Model50.m2_Predict.Season7.2 <- as.data.frame(predict(Model50.m2, newdata= Predict.Season7.2, se= TRUE))
Model50.m2_Predict.Season7.2 <- Model50.m2_Predict.Season7.2 %>% dplyr::rename("Model50.m2_Predict.Season7.2"="fit")
Model50.m2_Predict.Season7.2 <- Model50.m2_Predict.Season7.2 %>% dplyr::rename("se.fit.50"="se.fit")

Model90.m2_Predict.Season7.2 <- as.data.frame(predict(Model90.m2, newdata= Predict.Season7.2, se= TRUE))
Model90.m2_Predict.Season7.2 <- Model90.m2_Predict.Season7.2 %>% dplyr::rename("Model90.m2_Predict.Season7.2"="fit")
Model90.m2_Predict.Season7.2 <- Model90.m2_Predict.Season7.2 %>% dplyr::rename("se.fit.90"="se.fit")


# Add to data frame
Predict.Season7.2 <- cbind(Predict.Season7.2, 
                         Model10.m2_Predict.Season7.2, 
                         Model50.m2_Predict.Season7.2, 
                         Model90.m2_Predict.Season7.2)


# dplyr::rename columns so that you can merge your data
Predict.Season4.2.m2 <- Predict.Season4.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season4.2")
Predict.Season4.2.m2 <- Predict.Season4.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season4.2")
Predict.Season4.2.m2 <- Predict.Season4.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season4.2")

# Predict.Season5.2.m2 <- Predict.Season5.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season5.2")
# Predict.Season5.2.m2 <- Predict.Season5.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season5.2")
# Predict.Season5.2.m2 <- Predict.Season5.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season5.2")

Predict.Season6.2.m2 <- Predict.Season6.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season6.2")
Predict.Season6.2.m2 <- Predict.Season6.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season6.2")
Predict.Season6.2.m2 <- Predict.Season6.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season6.2")

Predict.Season7.2.m2 <- Predict.Season7.2 %>% dplyr::rename("Model10" = "Model10.m2_Predict.Season7.2")
Predict.Season7.2.m2 <- Predict.Season7.2.m2 %>% dplyr::rename("Model50" = "Model50.m2_Predict.Season7.2")
Predict.Season7.2.m2 <- Predict.Season7.2.m2 %>% dplyr::rename("Model90" = "Model90.m2_Predict.Season7.2")



AllSeasons_m2 <- rbind(Predict.Season4.2.m2,
                            # Predict.Season5.2.m2,
                            Predict.Season6.2.m2,
                            Predict.Season7.2.m2)


# plot these three functions with 1:1 line against each other with R2 value (for all seasons)
par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=AllSeasons_m2)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=AllSeasons_m2))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=AllSeasons_m2,
     main="All Seasons LT10 Sweetheart cherry forcingBB",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model10 ~ LT10, data=AllSeasons_m2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=AllSeasons_m2)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=AllSeasons_m2))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=AllSeasons_m2,
     main="All Seasons LT50 Sweetheart cherry forcingBB",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model50 ~ LT50, data=AllSeasons_m2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=AllSeasons_m2)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=AllSeasons_m2))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=AllSeasons_m2,
     main="All Seasons LT90 Sweetheart cherry forcingBB",
     pch=20,
     xlab="Temperature (˚C)", 
     ylab="Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5)
abline(lm(Model90 ~ LT90, data=AllSeasons_m2), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
```
```{R echo = FALSE}
# # Calculate RMSE of the three models
# T2_LT10 <- sqrt(mean(Model10.m2$residuals^2))
# T2_LT50 <- sqrt(mean(Model50.m2$residuals^2))
# T2_LT90 <- sqrt(mean(Model90.m2$residuals^2))
# 
# Model2RMSE <- as.data.frame(rbind(T2_LT10, T2_LT50, T2_LT90))
# Model2RMSE <- Model2RMSE %>% 
#   rename(RMSE = V1)
# Model2RMSE <- Model2RMSE %>% mutate_if(is.numeric, ~round(., 3))
# 
# # calculate Index of agreement (hydroGOF package fn d())
# AllSeasons_m2NA <- na.omit(AllSeasons_m2)
# Model10.gls_predicted <- AllSeasons_m2NA$Model10
# Model10.gls_observed <- AllSeasons_m2NA$LT10
# d_gls10 <- hydroGOF::d(Model10.gls_predicted, Model10.gls_observed)
# 
# Model50.gls_predicted <- AllSeasons_m2NA$Model50
# Model50.gls_observed <- AllSeasons_m2NA$LT50
# d_gls50 <- hydroGOF::d(Model50.gls_predicted, Model50.gls_observed)
# 
# Model90.gls_predicted <- AllSeasons_m2NA$Model90
# Model90.gls_observed <- AllSeasons_m2NA$LT90
# d_gls90 <- hydroGOF::d(Model90.gls_predicted, Model90.gls_observed)
# 
# Model2.d <- as.data.frame(rbind(d_gls10, d_gls50, d_gls90))
# Model2.d <- Model2.d %>% 
#   rename(d = V1)
# Model2.d <- Model2.d %>% mutate_if(is.numeric, ~round(., 3))
# 
# Model2_RMSE_d <- cbind(Model2RMSE, Model2.d)
# 
# Model2_RMSE_d

# Don't evaluate using RMSE and d but instead take the average

```


* * *
# Average Difference (Observed-Estimated)
```{r}

# T2 average difference between Observed and Estimated values
# Don't evaluate using RMSE but instead take the average
AllSeasons_m2NA_averaged <- na.omit(AllSeasons_m2)
AllSeasons_m2NA_averaged <- AllSeasons_m2NA_averaged %>% mutate_if(is.numeric, ~round(., 2))
AllSeasons_m2NA_averaged$Obs_pred_LT10 <- (AllSeasons_m2NA_averaged$Model10) - (AllSeasons_m2NA_averaged$LT10)



Avg_obs_pred_LT10 <- mean(AllSeasons_m2NA_averaged$Obs_pred_LT10)

Avg_obs_pred_LT10



AllSeasons_m2NA_averaged$Obs_pred_LT50 <- (AllSeasons_m2NA_averaged$Model50) - (AllSeasons_m2NA_averaged$LT50)
Avg_obs_pred_LT50 <- mean(AllSeasons_m2NA_averaged$Obs_pred_LT50)

Avg_obs_pred_LT50


AllSeasons_m2NA_averaged$Obs_pred_LT90 <- (AllSeasons_m2NA_averaged$Model90) - (AllSeasons_m2NA_averaged$LT90)
Avg_obs_pred_LT90 <- mean(AllSeasons_m2NA_averaged$Obs_pred_LT90)

Avg_obs_pred_LT90

# str(AllSeasons_m2NA_averaged)
```


* * *
# Model Visualization Cherry ForcingBB >= 25

```{R echo = FALSE, out.width="30%"}
# Assume approximately 2 standard errors produces the confidence intervals
# Assume approximately 2 standard errors produces the confidence intervals
# Need to assign them values to get this to work:

# Season4
LT10.CIUpper <- (Predict.Season4.2.m2$Model10 + Predict.Season4.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season4.2.m2$Model10 - Predict.Season4.2.m2$se.fit.10*1.96)
Season4.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season4.LT10.CI <- as.data.frame(Season4.LT10.CI)

LT50.CIUpper <- (Predict.Season4.2.m2$Model50 + Predict.Season4.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season4.2.m2$Model50 - Predict.Season4.2.m2$se.fit.50*1.96)
Season4.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season4.LT50.CI <- as.data.frame(Season4.LT50.CI)

LT90.CIUpper <- (Predict.Season4.2.m2$Model90 + Predict.Season4.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season4.2.m2$Model90 - Predict.Season4.2.m2$se.fit.90*1.96)
Season4.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season4.LT90.CI <- as.data.frame(Season4.LT90.CI)

Predict.Season4.2.m2 <- cbind(Predict.Season4.2.m2, Season4.LT10.CI, Season4.LT50.CI, Season4.LT90.CI)

Predict.Season4.2.m2$Date <- as.Date(Predict.Season4.2.m2$Date)
Predict.Season6.2.m2$Date <- as.Date(Predict.Season6.2.m2$Date)
Predict.Season7.2.m2$Date <- as.Date(Predict.Season7.2.m2$Date)

# Plot
plot(LT10 ~ Date, data=Predict.Season4.2.m2,
     main= "LT10 Season4",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model10, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season4.2.m2,
     main= "LT50 Season4",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season4.2.m2,
     main= "LT90 Season4",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model90, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$LT90.CILower, lty = 2)

# # Season5
# LT10.CIUpper <- (Predict.Season5.2.m2$Model10 + Predict.Season5.2.m2$se.fit.10*1.96)
# LT10.CILower <- (Predict.Season5.2.m2$Model10 - Predict.Season5.2.m2$se.fit.10*1.96)
# Season5.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
# Season5.LT10.CI <- as.data.frame(Season5.LT10.CI)
# 
# LT50.CIUpper <- (Predict.Season5.2.m2$Model50 + Predict.Season5.2.m2$se.fit.50*1.96)
# LT50.CILower <- (Predict.Season5.2.m2$Model50 - Predict.Season5.2.m2$se.fit.50*1.96)
# Season5.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
# Season5.LT50.CI <- as.data.frame(Season5.LT50.CI)
# 
# LT90.CIUpper <- (Predict.Season5.2.m2$Model90 + Predict.Season5.2.m2$se.fit.90*1.96)
# LT90.CILower <- (Predict.Season5.2.m2$Model90 - Predict.Season5.2.m2$se.fit.90*1.96)
# Season5.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
# Season5.LT90.CI <- as.data.frame(Season5.LT90.CI)
# 
# Predict.Season5.2.m2 <- cbind(Predict.Season5.2.m2, Season5.LT10.CI, Season5.LT50.CI, Season5.LT90.CI)
# 
# 
# # Plot
# plot(LT10 ~ Date, data=Predict.Season5.2.m2,
#      main= "LT10 Season5",
#      pch= 20,
#      xlab="Cumulative Julian Day", 
#      ylab="LT10 (˚C)",
#      cex.main=1.25, 
#      cex.lab=1, ylim=c(-30, 0))
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model10, lty = 1)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT10.CIUpper, lty = 2)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT10.CILower, lty = 2)
# 
# plot(LT50 ~ Date, data=Predict.Season5.2.m2,
#      main= "LT50 Season5",
#      pch= 20,
#      xlab="Cumulative Julian Day", 
#      ylab="LT50 (˚C)",
#      cex.main=1.25, 
#      cex.lab=1, ylim=c(-30, 0))
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model50, lty = 1)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT50.CIUpper, lty = 2)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT50.CILower, lty = 2)
# 
# plot(LT90 ~ Date, data=Predict.Season5.2.m2,
#      main= "LT90 Season5",
#      pch= 20,
#      xlab="Cumulative Julian Day", 
#      ylab="LT90 (˚C)",
#      cex.main=1.25, 
#      cex.lab=1, ylim=c(-30, 0))
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model90, lty = 1)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT90.CIUpper, lty = 2)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$LT90.CILower, lty = 2)

# Season6
LT10.CIUpper <- (Predict.Season6.2.m2$Model10 + Predict.Season6.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season6.2.m2$Model10 - Predict.Season6.2.m2$se.fit.10*1.96)
Season6.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season6.LT10.CI <- as.data.frame(Season6.LT10.CI)

LT50.CIUpper <- (Predict.Season6.2.m2$Model50 + Predict.Season6.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season6.2.m2$Model50 - Predict.Season6.2.m2$se.fit.50*1.96)
Season6.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season6.LT50.CI <- as.data.frame(Season6.LT50.CI)

LT90.CIUpper <- (Predict.Season6.2.m2$Model90 + Predict.Season6.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season6.2.m2$Model90 - Predict.Season6.2.m2$se.fit.90*1.96)
Season6.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season6.LT90.CI <- as.data.frame(Season6.LT90.CI)

Predict.Season6.2.m2 <- cbind(Predict.Season6.2.m2, Season6.LT10.CI, Season6.LT50.CI, Season6.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season6.2.m2,
     main= "LT10 Season6",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model10, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season6.2.m2,
     main= "LT50 Season6",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season6.2.m2,
     main= "LT90 Season6",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model90, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$LT90.CILower, lty = 2)

# Season7
LT10.CIUpper <- (Predict.Season7.2.m2$Model10 + Predict.Season7.2.m2$se.fit.10*1.96)
LT10.CILower <- (Predict.Season7.2.m2$Model10 - Predict.Season7.2.m2$se.fit.10*1.96)
Season7.LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
Season7.LT10.CI <- as.data.frame(Season7.LT10.CI)

LT50.CIUpper <- (Predict.Season7.2.m2$Model50 + Predict.Season7.2.m2$se.fit.50*1.96)
LT50.CILower <- (Predict.Season7.2.m2$Model50 - Predict.Season7.2.m2$se.fit.50*1.96)
Season7.LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
Season7.LT50.CI <- as.data.frame(Season7.LT50.CI)

LT90.CIUpper <- (Predict.Season7.2.m2$Model90 + Predict.Season7.2.m2$se.fit.90*1.96)
LT90.CILower <- (Predict.Season7.2.m2$Model90 - Predict.Season7.2.m2$se.fit.90*1.96)
Season7.LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
Season7.LT90.CI <- as.data.frame(Season7.LT90.CI)

Predict.Season7.2.m2 <- cbind(Predict.Season7.2.m2, Season7.LT10.CI, Season7.LT50.CI, Season7.LT90.CI)


# Plot
plot(LT10 ~ Date, data=Predict.Season7.2.m2,
     main= "LT10 Season7",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT10 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model10, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT10.CIUpper, lty = 2)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT10.CILower, lty = 2)

plot(LT50 ~ Date, data=Predict.Season7.2.m2,
     main= "LT50 Season7",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT50 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model50, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT50.CIUpper, lty = 2)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT50.CILower, lty = 2)

plot(LT90 ~ Date, data=Predict.Season7.2.m2,
     main= "LT90 Season7",
     pch= 20,
     xlab="Cumulative Julian Day", 
     ylab="LT90 (˚C)",
     cex.main=1.25,
     cex.lab=1, ylim=c(-30, 0))
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model90, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT90.CIUpper, lty = 2)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$LT90.CILower, lty = 2)
```

* * *
# Full Model Visualization Cherry ForcingBB

```{R echo = FALSE, out.width="25%"}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
# points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)

# Plot Season4
plot(LT10 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "LT10 Season4",
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT10.CILower, rev(Predict.Season4.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT10.CILower, rev(Predict.Season4.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model10, lty = 1, col= c("mediumblue"))

plot(LT50 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "LT50 Season4",
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT50.CILower, rev(Predict.Season4.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT50.CILower, rev(Predict.Season4.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1, col= c("mediumblue"))


plot(LT90 ~ Date, data=points4,
     main= "LT90 Season4",
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT90.CILower, rev(Predict.Season4.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT90.CILower, rev(Predict.Season4.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model90, lty = 1)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model90, lty = 1, col= c("mediumblue"))



# Plot Season5
# plot(LT10 ~ Date, data=points5,
#      main= "LT10 Season5",
#      xlim = as.Date(c("2014-09-01", "2015-04-25")),
#      pch= 20,
#      xlab="", 
#      ylab="LT10 (˚C)",
#      cex.main=1.25, 
#      cex=0.75,
#      cex.lab=1, ylim=c(-30, 0))
# polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT10.CILower, rev(Predict.Season5.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
# polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT10.CILower, rev(Predict.Season5.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
# lines(Predict.Season5.m$Date, Predict.Season5.m$Model10, lty = 1)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model10, lty = 1, col= c("mediumblue"))
# 
# plot(LT50 ~ Date, data=points5,
#      main= "LT50 Season5",
#      xlim = as.Date(c("2014-09-01", "2015-04-25")),
#      pch= 20,
#      xlab="", 
#      ylab="LT50 (˚C)",
#      cex.main=1.25, 
#      cex=0.75,
#      cex.lab=1, ylim=c(-30, 0))
# polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT50.CILower, rev(Predict.Season5.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
# polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT50.CILower, rev(Predict.Season5.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
# lines(Predict.Season5.m$Date, Predict.Season5.m$Model50, lty = 1)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model50, lty = 1, col= c("mediumblue"))
# 
# 
# plot(LT90 ~ Date, data=points5,
#      main= "LT90 Season5",
#      xlim = as.Date(c("2014-09-01", "2015-04-25")),
#      pch= 20,
#      xlab="", 
#      ylab="LT90 (˚C)",
#      cex.main=1.25, 
#      cex=0.75,
#      cex.lab=1, ylim=c(-30, 0))
# polygon(c(Predict.Season5.m$Date, rev(Predict.Season5.m$Date)), c(Predict.Season5.m$LT90.CILower, rev(Predict.Season5.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
# polygon(c(Predict.Season5.2.m2$Date, rev(Predict.Season5.2.m2$Date)), c(Predict.Season5.2.m2$LT90.CILower, rev(Predict.Season5.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
# lines(Predict.Season5.m$Date, Predict.Season5.m$Model90, lty = 1)
# lines(Predict.Season5.2.m2$Date, Predict.Season5.2.m2$Model90, lty = 1, col= c("mediumblue"))


# Plot Season6
plot(LT10 ~ Date, data=points6,
     main= "LT10 Season6",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT10.CILower, rev(Predict.Season6.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT10.CILower, rev(Predict.Season6.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model10, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model10, lty = 1, col= c("mediumblue"))

plot(LT50 ~ Date, data=points6,
     main= "LT50 Season6",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT50.CILower, rev(Predict.Season6.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT50.CILower, rev(Predict.Season6.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1, col= c("mediumblue"))


plot(LT90 ~ Date, data=points6,
     main= "LT90 Season6",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT90.CILower, rev(Predict.Season6.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT90.CILower, rev(Predict.Season6.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model90, lty = 1)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model90, lty = 1, col= c("mediumblue"))




# Plot Season7
plot(LT10 ~ Date, data=points7,
     main= "LT10 Season7",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT10 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT10.CILower, rev(Predict.Season7.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT10.CILower, rev(Predict.Season7.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model10, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model10, lty = 1, col= c("mediumblue"))

plot(LT50 ~ Date, data=points7,
     main= "LT50 Season7",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT50 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, ylim=c(-30, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT50.CILower, rev(Predict.Season7.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT50.CILower, rev(Predict.Season7.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model50, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model50, lty = 1, col= c("mediumblue"))


plot(LT90 ~ Date, data=points7,
     main= "LT90 Season7",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="LT90 (˚C)",
     cex.main=1.25, 
     cex=0.75,
     cex.lab=1, 
     ylim=c(-30, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT90.CILower, rev(Predict.Season7.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines, rgb specifications lets us have alpha changes (transparency)
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT90.CILower, rev(Predict.Season7.2.m2$LT90.CIUpper)), 
        col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model90, lty = 1)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model90, lty = 1, col= c("mediumblue"))
# legend('topleft', legend=c("Measured Values"),
#        col=c("black"), pch = 20, cex=1,
#        box.lty=0)


```
***
# 11.1 Full Model Visualization: Publication Figures LT50
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
# points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)

# par is set to 1:1 if you run this script out of order

par(mfrow=c(1,3))
par(pty="m") # resets par to old conditions
# Plot Season4

plot(LT50 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT50 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT50.CILower, rev(Predict.Season4.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT50.CILower, rev(Predict.Season4.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1,  lwd=1.15)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2014-03-25'), -24, "2013-2014", cex = 1.65)
# legend(x = as.Date("2013-08-29"), y = -20,         # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("     Observed LT"),  # Legend texts
#        pch = c(20),           # dot
#        col  = c("black"))
# legend(x = as.Date("2013-08-20"), y = -22,          # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("T1 Predicted LT"),  # Legend texts
#        lty = 1,
#        lwd=1.15,
#        col  = c("black"),
#        seg.len = 1.75) #line length
# legend(x = as.Date("2013-08-20"), y = -24,          # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("T2 Predicted LT"),  # Legend texts
#        lty = 1,
#        lwd=1.15,
#        col  = c("blue"),
#        seg.len = 1.75) #line length
par(mar = c(3, 5, 1, 1.5)) 

# Plot Season6

plot(LT50 ~ Date, data=points6,
     main= "",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT50.CILower, rev(Predict.Season6.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT50.CILower, rev(Predict.Season6.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model50, lty = 1,  lwd=1.15)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2016-03-25'), -24, "2015-2016", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 


# Plot Season7

plot(LT50 ~ Date, data=points7,
     main= "",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
    cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT50.CILower, rev(Predict.Season7.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT50.CILower, rev(Predict.Season7.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model50, lty = 1,  lwd=1.15)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2017-03-25'), -24, "2016-2017", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

# save width as 6 x 15 inches (this was for 2 rows one column) so you will need to save this figure as 3 x 15 inches
```

***
# 11.1 Full Model Visualization: Publication Figures LT10
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
# points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)

# par is set to 1:1 if you run this script out of order

par(mfrow=c(1,3))
par(pty="m") # resets par to old conditions
# Plot Season4

plot(LT10 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT10 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT10.CILower, rev(Predict.Season4.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT10.CILower, rev(Predict.Season4.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model10, lty = 1,  lwd=1.15)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2014-03-25'), -21, "2013-2014", cex = 1.65)
# legend(x = as.Date("2013-08-29"), y = -20,         # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("     Observed LT"),  # Legend texts
#        pch = c(20),           # dot
#        col  = c("black"))
# legend(x = as.Date("2013-08-20"), y = -22,          # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("T1 Predicted LT"),  # Legend texts
#        lty = 1,
#        lwd=1.15,
#        col  = c("black"),
#        seg.len = 1.75) #line length
# legend(x = as.Date("2013-08-20"), y = -24,          # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("T2 Predicted LT"),  # Legend texts
#        lty = 1,
#        lwd=1.15,
#        col  = c("blue"),
#        seg.len = 1.75) #line length
par(mar = c(3, 5, 1, 1.5)) 

# Plot Season6

plot(LT10 ~ Date, data=points6,
     main= "",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT10.CILower, rev(Predict.Season6.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT10.CILower, rev(Predict.Season6.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model10, lty = 1,  lwd=1.15)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2016-03-25'), -21, "2015-2016", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 


# Plot Season7

plot(LT10 ~ Date, data=points7,
     main= "",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
    cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-22, 0))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT10.CILower, rev(Predict.Season7.m$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT10.CILower, rev(Predict.Season7.2.m2$LT10.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model10, lty = 1,  lwd=1.15)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model10, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2017-03-25'), -21, "2016-2017", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

# save width as 6 x 15 inches (this was for 2 rows one column) so you will need to save this figure as 3 x 15 inches
```

***
# 11.1 Full Model Visualization: Publication Figures LT90
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
# points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)

# par is set to 1:1 if you run this script out of order

par(mfrow=c(1,3))
par(pty="m") # resets par to old conditions
# Plot Season4

plot(LT90 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT90 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT90.CILower, rev(Predict.Season4.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT90.CILower, rev(Predict.Season4.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season4.m$Date, Predict.Season4.m$Model90, lty = 1,  lwd=1.15)
lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2014-03-25'), -26.5, "2013-2014", cex = 1.65)
# legend(x = as.Date("2013-08-29"), y = -20,         # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("     Observed LT"),  # Legend texts
#        pch = c(20),           # dot
#        col  = c("black"))
# legend(x = as.Date("2013-08-20"), y = -22,          # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("T1 Predicted LT"),  # Legend texts
#        lty = 1,
#        lwd=1.15,
#        col  = c("black"),
#        seg.len = 1.75) #line length
# legend(x = as.Date("2013-08-20"), y = -24,          # Position
#        inset = 0.05, # Distance from the margin as a fraction of the plot region
#               bty = "n", # Removes the legend box
#               cex = 1.15, # Change legend size
#        legend = c("T2 Predicted LT"),  # Legend texts
#        lty = 1,
#        lwd=1.15,
#        col  = c("blue"),
#        seg.len = 1.75) #line length
par(mar = c(3, 5, 1, 1.5)) 

# Plot Season6

plot(LT90 ~ Date, data=points6,
     main= "",
     xlim = as.Date(c("2015-09-01", "2016-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season6.m$Date, rev(Predict.Season6.m$Date)), c(Predict.Season6.m$LT90.CILower, rev(Predict.Season6.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season6.2.m2$Date, rev(Predict.Season6.2.m2$Date)), c(Predict.Season6.2.m2$LT90.CILower, rev(Predict.Season6.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season6.m$Date, Predict.Season6.m$Model90, lty = 1,  lwd=1.15)
lines(Predict.Season6.2.m2$Date, Predict.Season6.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2016-03-25'), -26.5, "2015-2016", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 


# Plot Season7

plot(LT90 ~ Date, data=points7,
     main= "",
     xlim = as.Date(c("2016-09-01", "2017-04-25")),
     pch= 20,
     xlab="", 
     ylab="",
    cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-27.5, -4.5))
polygon(c(Predict.Season7.m$Date, rev(Predict.Season7.m$Date)), c(Predict.Season7.m$LT90.CILower, rev(Predict.Season7.m$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
polygon(c(Predict.Season7.2.m2$Date, rev(Predict.Season7.2.m2$Date)), c(Predict.Season7.2.m2$LT90.CILower, rev(Predict.Season7.2.m2$LT90.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
lines(Predict.Season7.m$Date, Predict.Season7.m$Model90, lty = 1,  lwd=1.15)
lines(Predict.Season7.2.m2$Date, Predict.Season7.2.m2$Model90, lty = 1, lwd=1.15, col= c("mediumblue"))
text(as.Date('2017-03-25'), -26.5, "2016-2017", cex = 1.65)
par(mar = c(3, 5, 1, 1.5)) 

# save width as 6 x 15 inches (this was for 2 rows one column) so you will need to save this figure as 3 x 15 inches
```
***
# 11.1 Full Model Visualization: Publication Figures, LEGEND
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# rbdind Predict.Season1.m and Predict.Season1.2.m2 to get all actual points

points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
# points5 <- rbind(Predict.Season5.m, Predict.Season5.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)

# par is set to 1:1 if you run this script out of order

par(mfrow=c(1,1))
par(pty="m") # resets par to old conditions
# Plot Season4

plot(LT50 ~ Date, data=points4,
     xlim = as.Date(c("2013-09-01", "2014-04-25")),
     main= "",
     pch= 20,
     xlab="", 
     ylab= expression("LT50 (" * degree * C *")"),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3),
     col = 'white')
# polygon(c(Predict.Season4.m$Date, rev(Predict.Season4.m$Date)), c(Predict.Season4.m$LT50.CILower, rev(Predict.Season4.m$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
# polygon(c(Predict.Season4.2.m2$Date, rev(Predict.Season4.2.m2$Date)), c(Predict.Season4.2.m2$LT50.CILower, rev(Predict.Season4.2.m2$LT50.CIUpper)), col=rgb(0, 0, 1,0.15), border=FALSE) # add CI as band of colour not lines
# lines(Predict.Season4.m$Date, Predict.Season4.m$Model50, lty = 1,  lwd=1.15)
# lines(Predict.Season4.2.m2$Date, Predict.Season4.2.m2$Model50, lty = 1, lwd=1.15, col= c("mediumblue"))
# text(as.Date('2014-03-25'), -24, "2013-2014", cex = 1.65)
legend(x = as.Date("2013-10-05"), y = -20,         # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("  Observed LT"),  # Legend texts
       pch = c(20),           # dot
       col  = c("black"))
legend(x = as.Date("2013-08-20"), y = -22,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t1 Predicted LT"),  # Legend texts
       lty = 1,
       lwd=1.25,
       col  = c("black"),
       seg.len = 1.5) #line length
legend(x = as.Date("2013-08-20"), y = -24,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t2 Predicted LT"),  # Legend texts
       lty = 1,
       lwd=1.25,
       col  = c("blue"),
       seg.len = 1.5) #line length
legend(x = as.Date("2013-10-20"), y = -22,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t1 95% Confidence Limit"),  # Legend texts
       lty = 1,
       lwd=8,
       col=rgb(0, 0, 0,0.20),
       seg.len = 1.5) #line length
legend(x = as.Date("2013-10-20"), y = -24,          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.15, # Change legend size
       legend = c("t2 95% Confidence Limit"),  # Legend texts
       lty = 1,
       lwd=8,
       col=rgb(0, 0, 1,0.15),
       seg.len = 1.5) #line length
par(mar = c(3, 5, 1, 1.5)) 

# save as 6x10
```
* * *
# Full Model Evaluation Cherry ForcingBB
```{R, echo = FALSE, out.width="25%"}

AllSeasons_m$colour <- "black"
AllSeasons_m2$colour <- "blue"

Predict.Season4.m$colour <- "black"
Predict.Season4.2.m2$colour <- "blue"

Predict.Season6.m$colour <- "black"
Predict.Season6.2.m2$colour <- "blue"

Predict.Season7.m$colour <- "black"
Predict.Season7.2.m2$colour <- "blue"


points4 <- rbind(Predict.Season4.m, Predict.Season4.2.m2)
points6 <- rbind(Predict.Season6.m, Predict.Season6.2.m2)
points7 <- rbind(Predict.Season7.m, Predict.Season7.2.m2)


Lapins_all <- rbind(AllSeasons_m, AllSeasons_m2)

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)
par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=Lapins_all)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=Lapins_all))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=Lapins_all,
     main="All Seasons LT10 Sweetheart cherry forcingBB (LAPINS MODELS)",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=Lapins_all$colour)
abline(lm(Model10 ~ LT10, data=Lapins_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=Lapins_all)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=Lapins_all))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=Lapins_all,
     main="All Seasons LT50 Sweetheart cherry forcingBB (LAPINS MODELS)",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=Lapins_all$colour)
abline(lm(Model50 ~ LT50, data=Lapins_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=Lapins_all)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=Lapins_all))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=Lapins_all,
     main="All Seasons LT90 Sweetheart cherry forcingBB (LAPINS MODELS)",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=Lapins_all$colour)
abline(lm(Model90 ~ LT90, data=Lapins_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
legend(-5, -25, legend=c("t1", "t2"),
       col=c("black", "blue"), pch=20, cex=0.75, box.lty=0)

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=Lapins_all)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=Lapins_all))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 3)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=Lapins_all,
     main="Sweetheart   Lapins",
     pch=20,
     xlab="Observed Temperature (˚C)", 
     ylab="Predicted Temperature (˚C)",
     xlim= c(-30, 0),
     ylim= c(-30, 0),
     cex=0.5,
     col=Lapins_all$colour)
abline(lm(Model90 ~ LT90, data=Lapins_all), lty=2)
abline(0, 1)
text(-25,-1, rlabel, cex=0.75)
text(-25,-3, RMSElabel, cex=0.75)
legend(-5, -25, legend=c("t1", "t2"),
       col=c("black", "blue"), pch=20, cex=0.75, box.lty=0)
```

***
# 12.1 Full Model Evaluation (1:1): Publication Figures
Combine models for forcing units <30 and >=30

```{R, echo = FALSE}
# all seasons

# plot these three functions with 1:1 line against each other with R2 value (for all seasons)

par(mfrow=c(1,3)) 


# par(pty="s")
Model10.split.AllSeasons <- lm(Model10 ~ LT10, data=Lapins_all)
Model10.split.AllSeasons.sum <- summary(lm(Model10 ~ LT10, data=Lapins_all))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model10 ~ LT10, data=Lapins_all,
     main="LT10",
     pch=20,
     font.main = 1, #removes bold title
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= expression("Predicted Temperature (" * degree * C *")"),
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Lapins_all$colour)
abline(lm(Model10 ~ LT10, data=Lapins_all), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model50.split.AllSeasons <- lm(Model50 ~ LT50, data=Lapins_all)
Model50.split.AllSeasons.sum <- summary(lm(Model50 ~ LT50, data=Lapins_all))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model50 ~ LT50, data=Lapins_all,
     main="LT50",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Lapins_all$colour)
abline(lm(Model50 ~ LT50, data=Lapins_all), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model90.split.AllSeasons <- lm(Model90 ~ LT90, data=Lapins_all)
Model90.split.AllSeasons.sum <- summary(lm(Model90 ~ LT90, data=Lapins_all))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(Model90 ~ LT90, data=Lapins_all,
     main="LT90",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Lapins_all$colour)
abline(lm(Model90 ~ LT90, data=Lapins_all), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
legend(x = "bottomright",          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.5, # Change legend size
       # legend = c("T1", "T2"),  # Legend texts
       pch = 20,           # Line types
       col  = c("black", "blue"))
# par(mar = c(5, 5, 5, 1.5))
# par(mar = c(5, 5, 5, 1.5))

# save width as 4.5 x 11.5 inches

```

```{R echo = FALSE}
# Calculate RMSE of the three models
Model10.m_T1_residuals <- as.data.frame(Model10.m$residuals)
colnames(Model10.m_T1_residuals)[1] = "residuals"

Model10.m_T2_residuals <- as.data.frame(Model10.m2$residuals)
colnames(Model10.m_T2_residuals)[1] = "residuals"

Model10_T1_T2_residuals <- rbind(Model10.m_T1_residuals, Model10.m_T2_residuals)


Model50.m_T1_residuals <- as.data.frame(Model50.m$residuals)
colnames(Model50.m_T1_residuals)[1] = "residuals"

Model50.m_T2_residuals <- as.data.frame(Model50.m2$residuals)
colnames(Model50.m_T2_residuals)[1] = "residuals"

Model50_T1_T2_residuals <- rbind(Model50.m_T1_residuals, Model50.m_T2_residuals)

Model90.m_T1_residuals <- as.data.frame(Model90.m$residuals)
colnames(Model90.m_T1_residuals)[1] = "residuals"

Model90.m_T2_residuals <- as.data.frame(Model90.m2$residuals)
colnames(Model90.m_T2_residuals)[1] = "residuals"

Model90_T1_T2_residuals <- rbind(Model90.m_T1_residuals, Model90.m_T2_residuals)

T1_T2_LT10 <- sqrt(mean(Model10_T1_T2_residuals$residuals^2))
T1_T2_LT50 <- sqrt(mean(Model50_T1_T2_residuals$residuals^2))
T1_T2_LT90 <- sqrt(mean(Model90_T1_T2_residuals$residuals^2))

Model_T1_T2_RMSE <- as.data.frame(rbind(T1_T2_LT10, T1_T2_LT50, T1_T2_LT90))
Model_T1_T2_RMSE <- Model_T1_T2_RMSE %>% 
  rename(RMSE = V1)
Model_T1_T2_RMSE <- Model_T1_T2_RMSE %>% mutate_if(is.numeric, ~round(., 2))

# calculate Index of agreement (hydroGOF package fn d())
AllSeasonsNA <- na.omit(AllSeasons_m)
Model10.gls_predicted <- as.data.frame(AllSeasonsNA$Model10)
colnames(Model10.gls_predicted)[1] = "predicted"
Model10.gls_observed <- as.data.frame(AllSeasonsNA$LT10)
colnames(Model10.gls_observed)[1] = "observed"

AllSeasons_m2NA <- na.omit(AllSeasons_m2)
Model10.gls_predicted2 <- as.data.frame(AllSeasons_m2NA$Model10)
colnames(Model10.gls_predicted2)[1] = "predicted"
Model10.gls_observed2 <- as.data.frame(AllSeasons_m2NA$LT10)
colnames(Model10.gls_observed2)[1] = "observed"

Model10.gls_predicted_T1_T2 <- rbind(Model10.gls_predicted, Model10.gls_predicted2)
Model10.gls_observed_T1_T2 <- rbind(Model10.gls_observed, Model10.gls_observed2)

d_T1_T2_gls10 <- hydroGOF::d(Model10.gls_predicted_T1_T2, Model10.gls_observed_T1_T2)



Model50.gls_predicted <- as.data.frame(AllSeasonsNA$Model50)
colnames(Model50.gls_predicted)[1] = "predicted"
Model50.gls_observed <- as.data.frame(AllSeasonsNA$LT50)
colnames(Model50.gls_observed)[1] = "observed"

Model50.gls_predicted2 <- as.data.frame(AllSeasons_m2NA$Model50)
colnames(Model50.gls_predicted2)[1] = "predicted"
Model50.gls_observed2 <- as.data.frame(AllSeasons_m2NA$LT50)
colnames(Model50.gls_observed2)[1] = "observed"

Model50.gls_predicted_T1_T2 <- rbind(Model50.gls_predicted, Model50.gls_predicted2)
Model50.gls_observed_T1_T2 <- rbind(Model50.gls_observed, Model50.gls_observed2)

d_T1_T2_gls50 <- hydroGOF::d(Model50.gls_predicted_T1_T2, Model50.gls_observed_T1_T2)


Model90.gls_predicted <- as.data.frame(AllSeasonsNA$Model90)
colnames(Model90.gls_predicted)[1] = "predicted"
Model90.gls_observed <- as.data.frame(AllSeasonsNA$LT90)
colnames(Model90.gls_observed)[1] = "observed"

Model90.gls_predicted2 <- as.data.frame(AllSeasons_m2NA$Model90)
colnames(Model90.gls_predicted2)[1] = "predicted"
Model90.gls_observed2 <- as.data.frame(AllSeasons_m2NA$LT90)
colnames(Model90.gls_observed2)[1] = "observed"

Model90.gls_predicted_T1_T2 <- rbind(Model90.gls_predicted, Model90.gls_predicted2)
Model90.gls_observed_T1_T2 <- rbind(Model90.gls_observed, Model90.gls_observed2)

d_T1_T2_gls90 <- hydroGOF::d(Model90.gls_predicted_T1_T2, Model90.gls_observed_T1_T2)




Model_T1_T2.d <- as.data.frame(rbind(d_T1_T2_gls10, d_T1_T2_gls50, d_T1_T2_gls90))
Model_T1_T2.d <- Model_T1_T2.d %>% 
  rename(d = observed)
Model_T1_T2.d <- Model_T1_T2.d %>% mutate_if(is.numeric, ~round(., 2))


Model_T1_T2_RMSE_d <- cbind(Model_T1_T2_RMSE, Model_T1_T2.d)

Model_T1_T2_RMSE_d
Model_T1_T2_RMSE_d$Model <- c('T1_T2_LT10', 'T1_T2_LT50', 'T1_T2_LT90')
Model_T1_T2_RMSE_d  <- Model_T1_T2_RMSE_d %>% mutate_if(is.numeric, ~round(., 2))

write.csv(Model_T1_T2_RMSE_d, file = "./outputs/Lapins.T1.T2_RMSE_d.csv", row.names = FALSE)
```

***
# 13.0 Percentage of observed values within 95% CI

```{R include=FALSE}

# Calculate 95% CI
LT10.CIUpper <- (Lapins_all$Model10 + Lapins_all$se.fit.10*1.96)
LT10.CILower <- (Lapins_all$Model10 - Lapins_all$se.fit.10*1.96)
LT10.CI <- cbind(LT10.CIUpper, LT10.CILower)
LT10.CI <- as.data.frame(LT10.CI)

LT50.CIUpper <- (Lapins_all$Model50 + Lapins_all$se.fit.50*1.96)
LT50.CILower <- (Lapins_all$Model50 - Lapins_all$se.fit.50*1.96)
LT50.CI <- cbind(LT50.CIUpper, LT50.CILower)
LT50.CI <- as.data.frame(LT50.CI)

LT90.CIUpper <- (Lapins_all$Model90 + Lapins_all$se.fit.90*1.96)
LT90.CILower <- (Lapins_all$Model90 - Lapins_all$se.fit.90*1.96)
LT90.CI <- cbind(LT90.CIUpper, LT90.CILower)
LT90.CI <- as.data.frame(LT90.CI)

Lapins_all <- cbind(Lapins_all, LT10.CI, LT50.CI, LT90.CI)

Lapins_allNA <- na.omit(Lapins_all)

# LT10
Predict.Lapins_allNA_outside <- subset(Lapins_allNA, LT10 > LT10.CIUpper | LT10 < LT10.CILower)
Predict.Lapins_allNA_outside$CI <- "outside"
Predict.Lapins_allNA_inside <- subset(Lapins_allNA, LT10 < LT10.CIUpper & LT10 > LT10.CILower)
Predict.Lapins_allNA_inside$CI <- "inside"
Predict.Lapins_allNA <- rbind(Predict.Lapins_allNA_outside, Predict.Lapins_allNA_inside)
table(Predict.Lapins_allNA$CI)

# LT50
Predict.Lapins_allNA_outside <- subset(Lapins_allNA, LT50 > LT50.CIUpper | LT50 < LT50.CILower)
Predict.Lapins_allNA_outside$CI <- "outside"
Predict.Lapins_allNA_inside <- subset(Lapins_allNA, LT50 < LT50.CIUpper & LT50 > LT50.CILower)
Predict.Lapins_allNA_inside$CI <- "inside"
Predict.Lapins_allNA <- rbind(Predict.Lapins_allNA_outside, Predict.Lapins_allNA_inside)
table(Predict.Lapins_allNA$CI)

# LT90
Predict.Lapins_allNA_outside <- subset(Lapins_allNA, LT90 > LT90.CIUpper | LT90 < LT90.CILower)
Predict.Lapins_allNA_outside$CI <- "outside"
Predict.Lapins_allNA_inside <- subset(Lapins_allNA, LT90 < LT90.CIUpper & LT90 > LT90.CILower)
Predict.Lapins_allNA_inside$CI <- "inside"
Predict.Lapins_allNA <- rbind(Predict.Lapins_allNA_outside, Predict.Lapins_allNA_inside)
table(Predict.Lapins_allNA$CI)
```


* * *
# Average Difference (Observed-Estimated): Full Model
```{r}

# T2 average difference between Observed and Estimated values
# Don't evaluate using RMSE but instead take the average
Lapins_allNA_averaged <- na.omit(Lapins_all)
Lapins_allNA_averaged <- Lapins_allNA_averaged %>% mutate_if(is.numeric, ~round(., 2))
Lapins_allNA_averaged$Obs_pred_LT10 <- (Lapins_allNA_averaged$Model10) - (Lapins_allNA_averaged$LT10)



Avg_obs_pred_LT10 <- mean(Lapins_allNA_averaged$Obs_pred_LT10)

Avg_obs_pred_LT10



Lapins_allNA_averaged$Obs_pred_LT50 <- (Lapins_allNA_averaged$Model50) - (Lapins_allNA_averaged$LT50)
Avg_obs_pred_LT50 <- mean(Lapins_allNA_averaged$Obs_pred_LT50)

Avg_obs_pred_LT50


Lapins_allNA_averaged$Obs_pred_LT90 <- (Lapins_allNA_averaged$Model90) - (Lapins_allNA_averaged$LT90)
Avg_obs_pred_LT90 <- mean(Lapins_allNA_averaged$Obs_pred_LT90)

Avg_obs_pred_LT90

```

* * *
# Full Model Validation
```{R, echo=FALSE}
# Import data
LapinsNEW <- read.csv(file='Summerland_Lapins_final_CUFU_LT_2023.csv')
LapinsNEW$Date <- as.Date(LapinsNEW$Date)

# drop LT_n and LT_stdev so it doesn't cause na.omit issues later on
LapinsNEW = subset(LapinsNEW, select = -c(LT_n, LT_stdev))

LapinsNEW <- LapinsNEW %>% mutate_if(is.numeric, ~round(., 2))

# remove dates with 7, 8 stages because we dont have enough data for this (only a few points in full bloom or bloom and these data were very off so will remove) and the sample size was too small

# Dates:2015-04-13, 2015-04-23, 2016-04-07, 2016-04-11
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2015-04-13", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2015-04-13", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2015-04-13", NA, LapinsNEW$LT90))
#
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2015-04-23", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2015-04-23", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2015-04-23", NA, LapinsNEW$LT90))
#
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2016-04-07", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2016-04-07", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2016-04-07", NA, LapinsNEW$LT90))
#
LapinsNEW <- LapinsNEW %>% mutate(LT10 = ifelse(Date == "2016-04-11", NA, LapinsNEW$LT10))
LapinsNEW <- LapinsNEW %>% mutate(LT50 = ifelse(Date == "2016-04-11", NA, LapinsNEW$LT50))
LapinsNEW <- LapinsNEW %>% mutate(LT90 = ifelse(Date == "2016-04-11", NA, LapinsNEW$LT90))

# we will omit one season of data to be later used to validate the model (75/25% Split)
Lapins <- subset(LapinsNEW, Date < "2014-09-15" | Date > "2015-04-30")

Lapins_validation <- subset(LapinsNEW, Date >= "2014-09-15" & Date <= "2015-04-29")


M <- read.csv(file='Martens_final_CUFU_LT_2023.csv')
Other <- read.csv(file='OtherVarieties_final_CUFU_LT_2023.csv')

M$Date <- as.Date(M$Date)
Other$Date <- as.Date(Other$Date)

Staccato <- subset(Other, Variety == "Staccato")
Staccato$Sweetheart_cherry_forcingBB_final.05 <- 0
Staccato$Sweetheart_cherry_forcingBB_final <- ifelse(Staccato$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Staccato$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Staccato$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Staccato$Sweetheart_cherry_forcingBB_final_log <- log(Staccato$Sweetheart_cherry_forcingBB_final + 10)


Staccato.1 <- subset(Staccato, Sweetheart_cherry_forcingBB_final < 25)
Staccato.2 <- subset(Staccato, Sweetheart_cherry_forcingBB_final >= 25)


Sonata <- subset(Other, Variety == "Sonata")
Sonata$Sweetheart_cherry_forcingBB_final.05 <- 0
Sonata$Sweetheart_cherry_forcingBB_final <- ifelse(Sonata$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Sonata$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Sonata$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Sonata$Sweetheart_cherry_forcingBB_final_log <- log(Sonata$Sweetheart_cherry_forcingBB_final + 10)

Sonata.1 <- subset(Sonata, Sweetheart_cherry_forcingBB_final < 25)
Sonata.2 <- subset(Sonata, Sweetheart_cherry_forcingBB_final >= 25)

Skeena <- subset(Other, Variety == "Skeena")
Skeena$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena$Sweetheart_cherry_forcingBB_final_log <- log(Skeena$Sweetheart_cherry_forcingBB_final + 10)

Skeena.1 <- subset(Skeena, Sweetheart_cherry_forcingBB_final < 25)
Skeena.2 <- subset(Skeena, Sweetheart_cherry_forcingBB_final >= 25)

Skeena1.Gi3 <- subset(Other, Variety == "Skeena.Gi3")
Skeena1.Gi3$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena1.Gi3$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena1.Gi3$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena1.Gi3$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena1.Gi3$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena1.Gi3$Sweetheart_cherry_forcingBB_final_log <- log(Skeena1.Gi3$Sweetheart_cherry_forcingBB_final + 10)

Skeena.Gi3.1 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final < 25)
Skeena.Gi3.2 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final >= 25)

Skeena1.Gi5 <- subset(Other, Variety == "Skeena.Gi5")
Skeena1.Gi5$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena1.Gi5$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena1.Gi5$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena1.Gi5$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena1.Gi5$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena1.Gi5$Sweetheart_cherry_forcingBB_final_log <- log(Skeena1.Gi5$Sweetheart_cherry_forcingBB_final + 10)

Skeena.Gi5.1 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final < 25)
Skeena.Gi5.2 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final >= 25)

Skeena1.Gi6 <- subset(Other, Variety == "Skeena.Gi6")
Skeena1.Gi6$Sweetheart_cherry_forcingBB_final.05 <- 0
Skeena1.Gi6$Sweetheart_cherry_forcingBB_final <- ifelse(Skeena1.Gi6$cherry_model_accumulated <= 2000, # if cherry model is less than 2000
                                                          Skeena1.Gi6$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Skeena1.Gi6$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Skeena1.Gi6$Sweetheart_cherry_forcingBB_final_log <- log(Skeena1.Gi6$Sweetheart_cherry_forcingBB_final + 10)


Skeena.Gi6.1 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final < 25)
Skeena.Gi6.2 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final >= 25)


# M$Sweetheart_cherry_forcingBB_final.05 <- M$Sweetheart_cherry_forcingBB_final/4
M$Sweetheart_cherry_forcingBB_final.05 <- 0
M$Sweetheart_cherry_forcingBB_final <- ifelse(M$cherry_model_accumulated <= 2000, # if forcing units less than or equal to 5
                                                          M$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          M$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
M$Sweetheart_cherry_forcingBB_final_log <- log(M$Sweetheart_cherry_forcingBB_final + 10)

# Lapins_validation$Sweetheart_cherry_forcingBB_final.05 <- Lapins_validation$Sweetheart_cherry_forcingBB_final/4
Lapins_validation$Sweetheart_cherry_forcingBB_final.05 <- 0
Lapins_validation$Sweetheart_cherry_forcingBB_final <- ifelse(Lapins_validation$cherry_model_accumulated <= 2000, # if forcing units less than or equal to 5
                                                          Lapins_validation$Sweetheart_cherry_forcingBB_final.05, # assign Sweetheart_cherry_forcingBB_final to Sweetheart_cherry_forcingBB_final/2
                                                          Lapins_validation$Sweetheart_cherry_forcingBB_final) # otherwise give it its original values
Lapins_validation$Sweetheart_cherry_forcingBB_final_log <- log(Lapins_validation$Sweetheart_cherry_forcingBB_final + 10)

Lapins_validation1 <- subset(Lapins_validation, Sweetheart_cherry_forcingBB_final < 25)
Lapins_validation2 <- subset(Lapins_validation, Sweetheart_cherry_forcingBB_final >= 25)

# on 2015-03-02 we see a switch from DTA->manual. Likely can't trust 2015-03-02 measurements so will assign this to NA

Lapins_validation <- Lapins_validation %>% mutate(LT10 = ifelse(Date == "2015-03-02", NA, Lapins_validation$LT10))
Lapins_validation <- Lapins_validation %>% mutate(LT50 = ifelse(Date == "2015-03-02", NA, Lapins_validation$LT50))
Lapins_validation <- Lapins_validation %>% mutate(LT90 = ifelse(Date == "2015-03-02", NA, Lapins_validation$LT90))

Lapins_validation2 <- Lapins_validation2 %>% mutate(LT10 = ifelse(Date == "2015-03-02", NA, Lapins_validation2$LT10))
Lapins_validation2<- Lapins_validation2 %>% mutate(LT50 = ifelse(Date == "2015-03-02", NA, Lapins_validation2$LT50))
Lapins_validation2 <- Lapins_validation2 %>% mutate(LT90 = ifelse(Date == "2015-03-02", NA, Lapins_validation2$LT90))

M1 <- subset(M, Date >= "2019-09-15" & Date <= "2020-04-29")
M2 <- subset(M, Date >= "2020-09-15" & Date <= "2021-04-29")
M3 <- subset(M, Date >= "2021-09-15" & Date <= "2022-04-29")
M1.1 <- subset(M1, Sweetheart_cherry_forcingBB_final < 25)
M1.2 <- subset(M1, Sweetheart_cherry_forcingBB_final >= 25)
M2.1 <- subset(M2, Sweetheart_cherry_forcingBB_final < 25)
M2.2 <- subset(M2, Sweetheart_cherry_forcingBB_final >= 25)
M3.1 <- subset(M3, Sweetheart_cherry_forcingBB_final < 25)
M3.2 <- subset(M3, Sweetheart_cherry_forcingBB_final >= 25)







# pull in your lapins models as well:
load("Model10_Lapins1.RData")
load("Model10_Lapins2.RData")

load("Model50_Lapins1.RData")
load("Model50_Lapins2.RData")

load("Model90_Lapins1.RData")
load("Model90_Lapins2.RData")

```
* * *
## Make Predictions: Lapins

```{r, echo=FALSE}

## (2014-15)
# Lapins LT10 (2014-15) Model 1
PredictLT10_L1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Lapins_validation1, se= TRUE))
    PredictLT10_L1.1$LT10.CIUpper <- (PredictLT10_L1.1$fit + PredictLT10_L1.1$se.fit*1.96)
    PredictLT10_L1.1$LT10.CILower <- (PredictLT10_L1.1$fit - PredictLT10_L1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_L1.1$Date <- Lapins_validation1$Date
    # rename fit to LT50
    PredictLT10_L1.1 <- PredictLT10_L1.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_L1.1 <- PredictLT10_L1.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_L1.1$Colour = "black"
    
# Lapins LT10 (2014-15) Model 2
PredictLT10_L1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Lapins_validation2, se= TRUE))
    PredictLT10_L1.2$LT10.CIUpper <- (PredictLT10_L1.2$fit + PredictLT10_L1.2$se.fit*1.96)
    PredictLT10_L1.2$LT10.CILower <- (PredictLT10_L1.2$fit - PredictLT10_L1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_L1.2$Date <- Lapins_validation2$Date
    # rename fit to LT50
    PredictLT10_L1.2 <- PredictLT10_L1.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_L1.2 <- PredictLT10_L1.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_L1.2$Colour = "mediumblue"
    
    
PredictLT10_L1 <- rbind(PredictLT10_L1.1, PredictLT10_L1.2)


# Lapins LT50 (2014-15) Model 1
PredictLT50_L1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Lapins_validation1, se= TRUE))
    PredictLT50_L1.1$LT50.CIUpper <- (PredictLT50_L1.1$fit + PredictLT50_L1.1$se.fit*1.96)
    PredictLT50_L1.1$LT50.CILower <- (PredictLT50_L1.1$fit - PredictLT50_L1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_L1.1$Date <- Lapins_validation1$Date
    # rename fit to LT50
    PredictLT50_L1.1 <- PredictLT50_L1.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_L1.1 <- PredictLT50_L1.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_L1.1$Colour = "black"
    
# Lapins LT50 (2014-15) Model 2
PredictLT50_L1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Lapins_validation2, se= TRUE))
    PredictLT50_L1.2$LT50.CIUpper <- (PredictLT50_L1.2$fit + PredictLT50_L1.2$se.fit*1.96)
    PredictLT50_L1.2$LT50.CILower <- (PredictLT50_L1.2$fit - PredictLT50_L1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_L1.2$Date <- Lapins_validation2$Date
    # rename fit to LT50
    PredictLT50_L1.2 <- PredictLT50_L1.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_L1.2 <- PredictLT50_L1.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_L1.2$Colour = "mediumblue"
    
PredictLT50_L1 <- rbind(PredictLT50_L1.1, PredictLT50_L1.2)
    
    # Lapins LT90 (2014-15) Model 1
PredictLT90_L1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Lapins_validation1, se= TRUE))
    PredictLT90_L1.1$LT90.CIUpper <- (PredictLT90_L1.1$fit + PredictLT90_L1.1$se.fit*1.96)
    PredictLT90_L1.1$LT90.CILower <- (PredictLT90_L1.1$fit - PredictLT90_L1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_L1.1$Date <- Lapins_validation1$Date
    # rename fit to LT50
    PredictLT90_L1.1 <- PredictLT90_L1.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_L1.1 <- PredictLT90_L1.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_L1.1$Colour = "black"
    
# Lapins LT90 (2014-15) Model 2
PredictLT90_L1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Lapins_validation2, se= TRUE))
    PredictLT90_L1.2$LT90.CIUpper <- (PredictLT90_L1.2$fit + PredictLT90_L1.2$se.fit*1.96)
    PredictLT90_L1.2$LT90.CILower <- (PredictLT90_L1.2$fit - PredictLT90_L1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_L1.2$Date <- Lapins_validation2$Date
    # rename fit to LT50
    PredictLT90_L1.2 <- PredictLT90_L1.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_L1.2 <- PredictLT90_L1.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_L1.2$Colour = "mediumblue"
    
    
PredictLT90_L1 <- rbind(PredictLT90_L1.1, PredictLT90_L1.2)




# GRAPH

plot(Lapins_validation$Date, Lapins_validation$LT10,
         main= "LT10 Model Validation: Lapins 2014-2015",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2014-09-01", "2015-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_L1.1$Date, rev(PredictLT10_L1.1$Date)), c(PredictLT10_L1.1$LT10.CILower, rev(PredictLT10_L1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_L1.2$Date, rev(PredictLT10_L1.2$Date)), c(PredictLT10_L1.2$LT10.CILower, rev(PredictLT10_L1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_L1.1$Date, PredictLT10_L1.1$LT10, lty = 1, lwd=1, col = PredictLT10_L1.1$Colour)
    lines(PredictLT10_L1.2$Date, PredictLT10_L1.2$LT10, lty = 1, lwd=1, col = PredictLT10_L1.2$Colour)
    
    
plot(Lapins_validation$Date, Lapins_validation$LT50,
         main= "LT50 Model Validation: Lapins 2014-2015",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2014-09-01", "2015-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_L1.1$Date, rev(PredictLT50_L1.1$Date)), c(PredictLT50_L1.1$LT50.CILower, rev(PredictLT50_L1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_L1.2$Date, rev(PredictLT50_L1.2$Date)), c(PredictLT50_L1.2$LT50.CILower, rev(PredictLT50_L1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_L1.1$Date, PredictLT50_L1.1$LT50, lty = 1, lwd=1, col = PredictLT50_L1.1$Colour)
    lines(PredictLT50_L1.2$Date, PredictLT50_L1.2$LT50, lty = 1, lwd=1, col = PredictLT50_L1.2$Colour)
    
    
plot(Lapins_validation$Date, Lapins_validation$LT90,
         main= "LT90 Model Validation: Lapins 2014-2015",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2014-09-01", "2015-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_L1.1$Date, rev(PredictLT90_L1.1$Date)), c(PredictLT90_L1.1$LT90.CILower, rev(PredictLT90_L1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_L1.2$Date, rev(PredictLT90_L1.2$Date)), c(PredictLT90_L1.2$LT90.CILower, rev(PredictLT90_L1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_L1.1$Date, PredictLT90_L1.1$LT90, lty = 1, lwd=1, col = PredictLT90_L1.1$Colour)
    lines(PredictLT90_L1.2$Date, PredictLT90_L1.2$LT90, lty = 1, lwd=1, col = PredictLT90_L1.2$Colour)
    

```

***
# Full Model Validation- LAPINS: Publication Figures
Combine models for forcing units <30 and >=30

```{R echo = FALSE}



## (2014-15)
# Lapins LT10 (2014-15) Model 1
PredictLT10_L1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Lapins_validation1, se= TRUE))
    PredictLT10_L1.1$LT10.CIUpper <- (PredictLT10_L1.1$fit + PredictLT10_L1.1$se.fit*1.96)
    PredictLT10_L1.1$LT10.CILower <- (PredictLT10_L1.1$fit - PredictLT10_L1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_L1.1$Date <- Lapins_validation1$Date
    # rename fit to LT50
    PredictLT10_L1.1 <- PredictLT10_L1.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_L1.1 <- PredictLT10_L1.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_L1.1$Colour = "black"
    
# Lapins LT10 (2014-15) Model 2
PredictLT10_L1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Lapins_validation2, se= TRUE))
    PredictLT10_L1.2$LT10.CIUpper <- (PredictLT10_L1.2$fit + PredictLT10_L1.2$se.fit*1.96)
    PredictLT10_L1.2$LT10.CILower <- (PredictLT10_L1.2$fit - PredictLT10_L1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_L1.2$Date <- Lapins_validation2$Date
    # rename fit to LT50
    PredictLT10_L1.2 <- PredictLT10_L1.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_L1.2 <- PredictLT10_L1.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_L1.2$Colour = "mediumblue"
    
    
PredictLT10_L1 <- rbind(PredictLT10_L1.1, PredictLT10_L1.2)


# Lapins LT50 (2014-15) Model 1
PredictLT50_L1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Lapins_validation1, se= TRUE))
    PredictLT50_L1.1$LT50.CIUpper <- (PredictLT50_L1.1$fit + PredictLT50_L1.1$se.fit*1.96)
    PredictLT50_L1.1$LT50.CILower <- (PredictLT50_L1.1$fit - PredictLT50_L1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_L1.1$Date <- Lapins_validation1$Date
    # rename fit to LT50
    PredictLT50_L1.1 <- PredictLT50_L1.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_L1.1 <- PredictLT50_L1.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_L1.1$Colour = "black"
    
# Lapins LT50 (2014-15) Model 2
PredictLT50_L1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Lapins_validation2, se= TRUE))
    PredictLT50_L1.2$LT50.CIUpper <- (PredictLT50_L1.2$fit + PredictLT50_L1.2$se.fit*1.96)
    PredictLT50_L1.2$LT50.CILower <- (PredictLT50_L1.2$fit - PredictLT50_L1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_L1.2$Date <- Lapins_validation2$Date
    # rename fit to LT50
    PredictLT50_L1.2 <- PredictLT50_L1.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_L1.2 <- PredictLT50_L1.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_L1.2$Colour = "mediumblue"
    
PredictLT50_L1 <- rbind(PredictLT50_L1.1, PredictLT50_L1.2)
    
    # Lapins LT90 (2014-15) Model 1
PredictLT90_L1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Lapins_validation1, se= TRUE))
    PredictLT90_L1.1$LT90.CIUpper <- (PredictLT90_L1.1$fit + PredictLT90_L1.1$se.fit*1.96)
    PredictLT90_L1.1$LT90.CILower <- (PredictLT90_L1.1$fit - PredictLT90_L1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_L1.1$Date <- Lapins_validation1$Date
    # rename fit to LT50
    PredictLT90_L1.1 <- PredictLT90_L1.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_L1.1 <- PredictLT90_L1.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_L1.1$Colour = "black"
    
# Lapins LT90 (2014-15) Model 2
PredictLT90_L1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Lapins_validation2, se= TRUE))
    PredictLT90_L1.2$LT90.CIUpper <- (PredictLT90_L1.2$fit + PredictLT90_L1.2$se.fit*1.96)
    PredictLT90_L1.2$LT90.CILower <- (PredictLT90_L1.2$fit - PredictLT90_L1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_L1.2$Date <- Lapins_validation2$Date
    # rename fit to LT50
    PredictLT90_L1.2 <- PredictLT90_L1.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_L1.2 <- PredictLT90_L1.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_L1.2$Colour = "mediumblue"
    
    
PredictLT90_L1 <- rbind(PredictLT90_L1.1, PredictLT90_L1.2)




# GRAPH
par(mfrow=c(1,3))
par(pty="m") # resets par to old conditions

plot(Lapins_validation$Date, Lapins_validation$LT10,
         main= "",
         pch= 20,
         xlab="", 
              ylab= expression("LT10 (" * degree * C *")"),
         xlim = as.Date(c("2014-09-01", "2015-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT10_L1.1$Date, rev(PredictLT10_L1.1$Date)), c(PredictLT10_L1.1$LT10.CILower, rev(PredictLT10_L1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_L1.2$Date, rev(PredictLT10_L1.2$Date)), c(PredictLT10_L1.2$LT10.CILower, rev(PredictLT10_L1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_L1.1$Date, PredictLT10_L1.1$LT10, lty = 1, lwd=1.15, col = PredictLT10_L1.1$Colour)
    lines(PredictLT10_L1.2$Date, PredictLT10_L1.2$LT10, lty = 1, lwd=1.15, col = PredictLT10_L1.2$Colour)
    
    
plot(Lapins_validation$Date, Lapins_validation$LT50,
         main= "",
         pch= 20,
         xlab="", 
              ylab= expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2014-09-01", "2015-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_L1.1$Date, rev(PredictLT50_L1.1$Date)), c(PredictLT50_L1.1$LT50.CILower, rev(PredictLT50_L1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_L1.2$Date, rev(PredictLT50_L1.2$Date)), c(PredictLT50_L1.2$LT50.CILower, rev(PredictLT50_L1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_L1.1$Date, PredictLT50_L1.1$LT50, lty = 1, lwd=1.15, col = PredictLT50_L1.1$Colour)
    lines(PredictLT50_L1.2$Date, PredictLT50_L1.2$LT50, lty = 1, lwd=1.15, col = PredictLT50_L1.2$Colour)
    
    
plot(Lapins_validation$Date, Lapins_validation$LT90,
         main= "",
         pch= 20,
         xlab="", 
              ylab= expression("LT90 (" * degree * C *")"),
         xlim = as.Date(c("2014-09-01", "2015-04-25")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT90_L1.1$Date, rev(PredictLT90_L1.1$Date)), c(PredictLT90_L1.1$LT90.CILower, rev(PredictLT90_L1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_L1.2$Date, rev(PredictLT90_L1.2$Date)), c(PredictLT90_L1.2$LT90.CILower, rev(PredictLT90_L1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_L1.1$Date, PredictLT90_L1.1$LT90, lty = 1, lwd=1.15, col = PredictLT90_L1.1$Colour)
    lines(PredictLT90_L1.2$Date, PredictLT90_L1.2$LT90, lty = 1, lwd=1.15, col = PredictLT90_L1.2$Colour)
    text(as.Date('2015-03-25'), -24, "2014-2015", cex = 1.65)
    text(as.Date('2015-03-25'), -22, "Lapins", cex = 1.65)
    
# save as 4x15s
```

* * *
# RMSE and d

```{R echo = FALSE}
# Calculate RMSE of the three models with data not included in model development


PredictLT10_L1_figures <- PredictLT10_L1
PredictLT10_L1_figures <- PredictLT10_L1_figures %>% 
  rename(LT10_predicted = LT10)

PredictLT50_L1_figures <- PredictLT50_L1
PredictLT50_L1_figures <- PredictLT50_L1_figures %>% 
  rename(LT50_predicted = LT50)

PredictLT90_L1_figures <- PredictLT90_L1
PredictLT90_L1_figures <- PredictLT90_L1_figures %>% 
  rename(LT90_predicted = LT90)

Lapins_validation1$Time <- 't1'
Lapins_validation2$Time <- 't2'

Lapins_validation_figures <- rbind(Lapins_validation1, Lapins_validation2)
Lapins_validation_figures <- merge(Lapins_validation_figures, PredictLT10_L1_figures, by = c('Date') , all = TRUE)
Lapins_validation_figures <- merge(Lapins_validation_figures, PredictLT50_L1_figures, by = c('Date') , all = TRUE)
Lapins_validation_figures <- merge(Lapins_validation_figures, PredictLT90_L1_figures, by = c('Date') , all = TRUE)

Lapins_validation_figures <- select(Lapins_validation_figures, c(Date, LT10, LT50, LT90, LT10_predicted, LT50_predicted, LT90_predicted), Time)
Lapins_validation_figures <- Lapins_validation_figures %>% mutate_if(is.numeric, ~round(., 2))
Lapins_validation_figures <- na.omit(Lapins_validation_figures)


Lapins_validation_figures$residuals_LT10 <- Lapins_validation_figures$LT10 - Lapins_validation_figures$LT10_predicted
Lapins_validation_figures$residuals_LT50 <- Lapins_validation_figures$LT50 - Lapins_validation_figures$LT50_predicted
Lapins_validation_figures$residuals_LT90 <- Lapins_validation_figures$LT90 - Lapins_validation_figures$LT90_predicted


Validation_residuals <- Lapins_validation_figures
Validation_residuals_t1 <- subset(Lapins_validation_figures, Time == 't1')
Validation_residuals_t2 <- subset(Lapins_validation_figures, Time == 't2')


LT10_validation_t1 <- sqrt(mean(Validation_residuals_t1$residuals_LT10^2))
LT50_validation_t1 <- sqrt(mean(Validation_residuals_t1$residuals_LT50^2))
LT90_validation_t1 <- sqrt(mean(Validation_residuals_t1$residuals_LT90^2))

LT10_validation <- sqrt(mean(Validation_residuals$residuals_LT10^2))
LT50_validation <- sqrt(mean(Validation_residuals$residuals_LT50^2))
LT90_validation <- sqrt(mean(Validation_residuals$residuals_LT90^2))


Model1RMSE_validation <- as.data.frame(rbind(LT10_validation, LT50_validation, LT90_validation))
Model1RMSE_validation <- Model1RMSE_validation %>% 
  rename(RMSE = V1)
Model1RMSE_validation <- Model1RMSE_validation %>% mutate_if(is.numeric, ~round(., 2))

Model1RMSE_validation_t1 <- as.data.frame(rbind(LT10_validation_t1, LT50_validation_t1, LT90_validation_t1))
Model1RMSE_validation_t1 <- Model1RMSE_validation_t1 %>% 
  rename(RMSE = V1)
Model1RMSE_validation_t1 <- Model1RMSE_validation_t1 %>% mutate_if(is.numeric, ~round(., 2))

# calculate Index of agreement (hydroGOF package fn d())
library(hydroGOF)

Model10.gls_predicted_validation <- Validation_residuals$LT10_predicted
Model10.gls_observed_validation <- Validation_residuals$LT10
d_gls10_validation <- d(Model10.gls_predicted_validation, Model10.gls_observed_validation)

Model50.gls_predicted_validation <- Validation_residuals$LT50_predicted
Model50.gls_observed_validation <- Validation_residuals$LT50
d_gls50_validation <- d(Model50.gls_predicted_validation, Model50.gls_observed_validation)

Model90.gls_predicted_validation <- Validation_residuals$LT90_predicted
Model90.gls_observed_validation <- Validation_residuals$LT90
d_gls90_validation <- d(Model90.gls_predicted_validation, Model90.gls_observed_validation)


Model1.d_validation <- as.data.frame(rbind(d_gls10_validation, d_gls50_validation, d_gls90_validation))
Model1.d_validation <- Model1.d_validation %>% 
  rename(d = V1)
Model1.d_validation <- Model1.d_validation %>% mutate_if(is.numeric, ~round(., 2))


# calculate Index of agreement (hydroGOF package fn d()) just t1
Model10.gls_predicted_validation_t1 <- Validation_residuals_t1$LT10_predicted
Model10.gls_observed_validation_t1 <- Validation_residuals_t1$LT10
d_gls10_validation_t1 <- d(Model10.gls_predicted_validation_t1, Model10.gls_observed_validation_t1)

Model50.gls_predicted_validation_t1 <- Validation_residuals_t1$LT50_predicted
Model50.gls_observed_validation_t1 <- Validation_residuals_t1$LT50
d_gls50_validation_t1 <- d(Model50.gls_predicted_validation_t1, Model50.gls_observed_validation_t1)

Model90.gls_predicted_validation_t1 <- Validation_residuals_t1$LT90_predicted
Model90.gls_observed_validation_t1 <- Validation_residuals_t1$LT90
d_gls90_validation_t1 <- d(Model90.gls_predicted_validation_t1, Model90.gls_observed_validation_t1)


Model1.d_validation_t1 <- as.data.frame(rbind(d_gls10_validation_t1, d_gls50_validation_t1, d_gls90_validation_t1))
Model1.d_validation_t1 <- Model1.d_validation_t1 %>% 
  rename(d = V1)
Model1.d_validation_t1 <- Model1.d_validation_t1 %>% mutate_if(is.numeric, ~round(., 2))

```



* * *
# (1:1): Publication Figures
Combine models for forcing units <30 and >=30

```{R, echo = FALSE}
par(pty="s")


# all seasons
Validation_residuals_t1$colour <- 'black'
Validation_residuals_t2$colour <- 'blue'
Validation_residuals <- rbind(Validation_residuals_t1, Validation_residuals_t2) 
Validation_residuals <- Validation_residuals %>% mutate_if(is.numeric, ~round(., 2))

par(mfrow=c(1,3)) 
par(pty="s")
Model10.split.AllSeasons <- lm(LT10_predicted ~ LT10, data=Validation_residuals)
Model10.split.AllSeasons.sum <- summary(lm(LT10_predicted ~ LT10, data=Validation_residuals))
r2 <- Model10.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model10.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(LT10_predicted ~ LT10, data=Validation_residuals,
     # main="LT10",
     pch=20,
     font.main = 1, #removes bold title
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= expression("Predicted Temperature (" * degree * C *")"),
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Validation_residuals$colour)
abline(lm(LT10_predicted ~ LT10, data=Validation_residuals), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model50.split.AllSeasons <- lm(LT50_predicted ~ LT50, data=Validation_residuals)
Model50.split.AllSeasons.sum <- summary(lm(LT50_predicted ~ LT50, data=Validation_residuals))
r2 <- Model50.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model50.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(LT50_predicted ~ LT50, data=Validation_residuals,
     # main="LT50",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Validation_residuals$colour)
abline(lm(LT50_predicted ~ LT50, data=Validation_residuals), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
# par(mar = c(5, 5, 0, 1.5))

par(pty="s")
Model90.split.AllSeasons <- lm(LT90_predicted ~ LT90, data=Validation_residuals)
Model90.split.AllSeasons.sum <- summary(lm(LT90_predicted ~ LT90, data=Validation_residuals))
r2 <- Model90.split.AllSeasons.sum$r.squared
RMSE <- sqrt(mean(Model90.split.AllSeasons$residuals^2))
rlabel <- bquote(italic(R)^2 == .(format(r2, digits = 2)))
RMSElabel <- bquote(italic(RMSE) == .(format(RMSE, digits = 3)))
plot(LT90_predicted ~ LT90, data=Validation_residuals,
     # main="LT90",
     pch=20,
     font.main = 1,
     xlab= expression("Observed Temperature (" * degree * C *")"),
     ylab= "",
     cex.main=2.25,
     cex.axis=1.75,
     cex.lab=1.75, 
     ylim=c(-25, 0),
     xlim=c(-25, 0),
     col=Validation_residuals$colour)
abline(lm(LT90_predicted ~ LT90, data=Validation_residuals), lty=2)
abline(0, 1)
text(-20,-1, rlabel, cex=1.45)
text(-20,-3, RMSElabel, cex=1.45)
legend(x = "bottomright",          # Position
       inset = 0.05, # Distance from the margin as a fraction of the plot region
              bty = "n", # Removes the legend box
              cex = 1.5, # Change legend size
       legend = c("t1", "t2"),  # Legend texts
       pch = 20,           # Line types
       col  = c("black", "blue"))


# save width as 4.5 x 11.5 inches
```

* * *
## Make Predictions: Martens

```{r, echo=FALSE}
## Season 1
# Martens LT10 Season 1 Model 1
PredictLT10_M1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = M1.1, se= TRUE))
    PredictLT10_M1.1$LT10.CIUpper <- (PredictLT10_M1.1$fit + PredictLT10_M1.1$se.fit*1.96)
    PredictLT10_M1.1$LT10.CILower <- (PredictLT10_M1.1$fit - PredictLT10_M1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M1.1$Date <- M1.1$Date
    # rename fit to LT50
    PredictLT10_M1.1 <- PredictLT10_M1.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_M1.1 <- PredictLT10_M1.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M1.1$Colour = "black"
    
# Martens LT10 Season 1 Model 2
PredictLT10_M1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = M1.2, se= TRUE))
    PredictLT10_M1.2$LT10.CIUpper <- (PredictLT10_M1.2$fit + PredictLT10_M1.2$se.fit*1.96)
    PredictLT10_M1.2$LT10.CILower <- (PredictLT10_M1.2$fit - PredictLT10_M1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M1.2$Date <- M1.2$Date
    # rename fit to LT50
    PredictLT10_M1.2 <- PredictLT10_M1.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_M1.2 <- PredictLT10_M1.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M1.2$Colour = "mediumblue"
    
    
PredictLT10_M1 <- rbind(PredictLT10_M1.1, PredictLT10_M1.2)


# Martens LT50 Season 1 Model 1
PredictLT50_M1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = M1.1, se= TRUE))
    PredictLT50_M1.1$LT50.CIUpper <- (PredictLT50_M1.1$fit + PredictLT50_M1.1$se.fit*1.96)
    PredictLT50_M1.1$LT50.CILower <- (PredictLT50_M1.1$fit - PredictLT50_M1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M1.1$Date <- M1.1$Date
    # rename fit to LT50
    PredictLT50_M1.1 <- PredictLT50_M1.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_M1.1 <- PredictLT50_M1.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M1.1$Colour = "black"
    
# Martens LT50 Season 1 Model 2
PredictLT50_M1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = M1.2, se= TRUE))
    PredictLT50_M1.2$LT50.CIUpper <- (PredictLT50_M1.2$fit + PredictLT50_M1.2$se.fit*1.96)
    PredictLT50_M1.2$LT50.CILower <- (PredictLT50_M1.2$fit - PredictLT50_M1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M1.2$Date <- M1.2$Date
    # rename fit to LT50
    PredictLT50_M1.2 <- PredictLT50_M1.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_M1.2 <- PredictLT50_M1.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M1.2$Colour = "mediumblue"
    
PredictLT50_M1 <- rbind(PredictLT50_M1.1, PredictLT50_M1.2)
    
    # Martens LT90 Season 1 Model 1
PredictLT90_M1.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = M1.1, se= TRUE))
    PredictLT90_M1.1$LT90.CIUpper <- (PredictLT90_M1.1$fit + PredictLT90_M1.1$se.fit*1.96)
    PredictLT90_M1.1$LT90.CILower <- (PredictLT90_M1.1$fit - PredictLT90_M1.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M1.1$Date <- M1.1$Date
    # rename fit to LT50
    PredictLT90_M1.1 <- PredictLT90_M1.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_M1.1 <- PredictLT90_M1.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M1.1$Colour = "black"
    
# Martens LT90 Season 1 Model 2
PredictLT90_M1.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = M1.2, se= TRUE))
    PredictLT90_M1.2$LT90.CIUpper <- (PredictLT90_M1.2$fit + PredictLT90_M1.2$se.fit*1.96)
    PredictLT90_M1.2$LT90.CILower <- (PredictLT90_M1.2$fit - PredictLT90_M1.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M1.2$Date <- M1.2$Date
    # rename fit to LT50
    PredictLT90_M1.2 <- PredictLT90_M1.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_M1.2 <- PredictLT90_M1.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M1.2$Colour = "mediumblue"
    
    
PredictLT90_M1 <- rbind(PredictLT90_M1.1, PredictLT90_M1.2)


## Season 2
# Martens LT10 Season 2 Model 1
PredictLT10_M2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = M2.1, se= TRUE))
    PredictLT10_M2.1$LT10.CIUpper <- (PredictLT10_M2.1$fit + PredictLT10_M2.1$se.fit*1.96)
    PredictLT10_M2.1$LT10.CILower <- (PredictLT10_M2.1$fit - PredictLT10_M2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M2.1$Date <- M2.1$Date
    # rename fit to LT50
    PredictLT10_M2.1 <- PredictLT10_M2.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_M2.1 <- PredictLT10_M2.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M2.1$Colour = "black"
    
# Martens LT10 Season 2 Model 2
PredictLT10_M2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = M2.2, se= TRUE))
    PredictLT10_M2.2$LT10.CIUpper <- (PredictLT10_M2.2$fit + PredictLT10_M2.2$se.fit*1.96)
    PredictLT10_M2.2$LT10.CILower <- (PredictLT10_M2.2$fit - PredictLT10_M2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M2.2$Date <- M2.2$Date
    # rename fit to LT50
    PredictLT10_M2.2 <- PredictLT10_M2.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_M2.2 <- PredictLT10_M2.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M2.2$Colour = "mediumblue"
    
    
PredictLT10_M2 <- rbind(PredictLT10_M2.1, PredictLT10_M2.2)


# Martens LT50 Season 2 Model 1
PredictLT50_M2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = M2.1, se= TRUE))
    PredictLT50_M2.1$LT50.CIUpper <- (PredictLT50_M2.1$fit + PredictLT50_M2.1$se.fit*1.96)
    PredictLT50_M2.1$LT50.CILower <- (PredictLT50_M2.1$fit - PredictLT50_M2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M2.1$Date <- M2.1$Date
    # rename fit to LT50
    PredictLT50_M2.1 <- PredictLT50_M2.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_M2.1 <- PredictLT50_M2.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M2.1$Colour = "black"
    
# Martens LT50 Season 2 Model 2
PredictLT50_M2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = M2.2, se= TRUE))
    PredictLT50_M2.2$LT50.CIUpper <- (PredictLT50_M2.2$fit + PredictLT50_M2.2$se.fit*1.96)
    PredictLT50_M2.2$LT50.CILower <- (PredictLT50_M2.2$fit - PredictLT50_M2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M2.2$Date <- M2.2$Date
    # rename fit to LT50
    PredictLT50_M2.2 <- PredictLT50_M2.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_M2.2 <- PredictLT50_M2.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M2.2$Colour = "mediumblue"
    
PredictLT50_M2 <- rbind(PredictLT50_M2.1, PredictLT50_M2.2)
    
    # Martens LT90 Season 2 Model 1
PredictLT90_M2.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = M2.1, se= TRUE))
    PredictLT90_M2.1$LT90.CIUpper <- (PredictLT90_M2.1$fit + PredictLT90_M2.1$se.fit*1.96)
    PredictLT90_M2.1$LT90.CILower <- (PredictLT90_M2.1$fit - PredictLT90_M2.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M2.1$Date <- M2.1$Date
    # rename fit to LT50
    PredictLT90_M2.1 <- PredictLT90_M2.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_M2.1 <- PredictLT90_M2.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M2.1$Colour = "black"
    
# Martens LT90 Season 2 Model 2
PredictLT90_M2.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = M2.2, se= TRUE))
    PredictLT90_M2.2$LT90.CIUpper <- (PredictLT90_M2.2$fit + PredictLT90_M2.2$se.fit*1.96)
    PredictLT90_M2.2$LT90.CILower <- (PredictLT90_M2.2$fit - PredictLT90_M2.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M2.2$Date <- M2.2$Date
    # rename fit to LT50
    PredictLT90_M2.2 <- PredictLT90_M2.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_M2.2 <- PredictLT90_M2.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M2.2$Colour = "mediumblue"
    
    
PredictLT90_M2 <- rbind(PredictLT90_M2.1, PredictLT90_M2.2)

## Season 3
# Martens LT10 Season 3 Model 1
PredictLT10_M3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = M3.1, se= TRUE))
    PredictLT10_M3.1$LT10.CIUpper <- (PredictLT10_M3.1$fit + PredictLT10_M3.1$se.fit*1.96)
    PredictLT10_M3.1$LT10.CILower <- (PredictLT10_M3.1$fit - PredictLT10_M3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M3.1$Date <- M3.1$Date
    # rename fit to LT50
    PredictLT10_M3.1 <- PredictLT10_M3.1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_M3.1 <- PredictLT10_M3.1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M3.1$Colour = "black"
    
# Martens LT10 Season 3 Model 2
PredictLT10_M3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = M3.2, se= TRUE))
    PredictLT10_M3.2$LT10.CIUpper <- (PredictLT10_M3.2$fit + PredictLT10_M3.2$se.fit*1.96)
    PredictLT10_M3.2$LT10.CILower <- (PredictLT10_M3.2$fit - PredictLT10_M3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_M3.2$Date <- M3.2$Date
    # rename fit to LT50
    PredictLT10_M3.2 <- PredictLT10_M3.2 %>% 
      dplyr::rename(LT10 = "fit")
    # rename se.fit to LT10_standard_error
    PredictLT10_M3.2 <- PredictLT10_M3.2 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_M3.2$Colour = "mediumblue"
    
    
PredictLT10_M3 <- rbind(PredictLT10_M3.1, PredictLT10_M3.2)


# Martens LT50 Season 3 Model 1
PredictLT50_M3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = M3.1, se= TRUE))
    PredictLT50_M3.1$LT50.CIUpper <- (PredictLT50_M3.1$fit + PredictLT50_M3.1$se.fit*1.96)
    PredictLT50_M3.1$LT50.CILower <- (PredictLT50_M3.1$fit - PredictLT50_M3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M3.1$Date <- M3.1$Date
    # rename fit to LT50
    PredictLT50_M3.1 <- PredictLT50_M3.1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_M3.1 <- PredictLT50_M3.1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M3.1$Colour = "black"
    
# Martens LT50 Season 3 Model 2
PredictLT50_M3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = M3.2, se= TRUE))
    PredictLT50_M3.2$LT50.CIUpper <- (PredictLT50_M3.2$fit + PredictLT50_M3.2$se.fit*1.96)
    PredictLT50_M3.2$LT50.CILower <- (PredictLT50_M3.2$fit - PredictLT50_M3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_M3.2$Date <- M3.2$Date
    # rename fit to LT50
    PredictLT50_M3.2 <- PredictLT50_M3.2 %>% 
      dplyr::rename(LT50 = "fit")
    # rename se.fit to LT50_standard_error
    PredictLT50_M3.2 <- PredictLT50_M3.2 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_M3.2$Colour = "mediumblue"
    
PredictLT50_M3 <- rbind(PredictLT50_M3.1, PredictLT50_M3.2)
    
    # Martens LT90 Season 3 Model 1
PredictLT90_M3.1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = M3.1, se= TRUE))
    PredictLT90_M3.1$LT90.CIUpper <- (PredictLT90_M3.1$fit + PredictLT90_M3.1$se.fit*1.96)
    PredictLT90_M3.1$LT90.CILower <- (PredictLT90_M3.1$fit - PredictLT90_M3.1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M3.1$Date <- M3.1$Date
    # rename fit to LT50
    PredictLT90_M3.1 <- PredictLT90_M3.1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_M3.1 <- PredictLT90_M3.1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M3.1$Colour = "black"
    
# Martens LT90 Season 3 Model 2
PredictLT90_M3.2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = M3.2, se= TRUE))
    PredictLT90_M3.2$LT90.CIUpper <- (PredictLT90_M3.2$fit + PredictLT90_M3.2$se.fit*1.96)
    PredictLT90_M3.2$LT90.CILower <- (PredictLT90_M3.2$fit - PredictLT90_M3.2$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_M3.2$Date <- M3.2$Date
    # rename fit to LT50
    PredictLT90_M3.2 <- PredictLT90_M3.2 %>% 
      dplyr::rename(LT90 = "fit")
    # rename se.fit to LT90_standard_error
    PredictLT90_M3.2 <- PredictLT90_M3.2 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_M3.2$Colour = "mediumblue"
    
    
PredictLT90_M3 <- rbind(PredictLT90_M3.1, PredictLT90_M3.2)



# Season 1

plot(Lapins_validation$Date, Lapins_validation$LT10,
         main= "LT10 Model Validation: Martens 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_M1.1$Date, rev(PredictLT10_M1.1$Date)), c(PredictLT10_M1.1$LT10.CILower, rev(PredictLT10_M1.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_M1.2$Date, rev(PredictLT10_M1.2$Date)), c(PredictLT10_M1.2$LT10.CILower, rev(PredictLT10_M1.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_M1.1$Date, PredictLT10_M1.1$LT10, lty = 1, lwd=1, col = PredictLT10_M1.1$Colour)
    lines(PredictLT10_M1.2$Date, PredictLT10_M1.2$LT10, lty = 1, lwd=1, col = PredictLT10_M1.2$Colour)
    
    
plot(Lapins_validation$Date, Lapins_validation$LT50,
         main= "LT50 Model Validation: Martens 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_M1.1$Date, rev(PredictLT50_M1.1$Date)), c(PredictLT50_M1.1$LT50.CILower, rev(PredictLT50_M1.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M1.2$Date, rev(PredictLT50_M1.2$Date)), c(PredictLT50_M1.2$LT50.CILower, rev(PredictLT50_M1.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M1.1$Date, PredictLT50_M1.1$LT50, lty = 1, lwd=1, col = PredictLT50_M1.1$Colour)
    lines(PredictLT50_M1.2$Date, PredictLT50_M1.2$LT50, lty = 1, lwd=1, col = PredictLT50_M1.2$Colour)
    
    
plot(Lapins_validation$Date, Lapins_validation$LT90,
         main= "LT90 Model Validation: Martens 2019-2020",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2019-09-01", "2020-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_M1.1$Date, rev(PredictLT90_M1.1$Date)), c(PredictLT90_M1.1$LT90.CILower, rev(PredictLT90_M1.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_M1.2$Date, rev(PredictLT90_M1.2$Date)), c(PredictLT90_M1.2$LT90.CILower, rev(PredictLT90_M1.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_M1.1$Date, PredictLT90_M1.1$LT90, lty = 1, lwd=1, col = PredictLT90_M1.1$Colour)
    lines(PredictLT90_M1.2$Date, PredictLT90_M1.2$LT90, lty = 1, lwd=1, col = PredictLT90_M1.2$Colour)
    
    
# Season 2
    
plot(M2$Date, M2$LT10,
         main= "LT10 Model Validation: Martens 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_M2.1$Date, rev(PredictLT10_M2.1$Date)), c(PredictLT10_M2.1$LT10.CILower, rev(PredictLT10_M2.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_M2.2$Date, rev(PredictLT10_M2.2$Date)), c(PredictLT10_M2.2$LT10.CILower, rev(PredictLT10_M2.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_M2.1$Date, PredictLT10_M2.1$LT10, lty = 1, lwd=1, col = PredictLT10_M2.1$Colour)
    lines(PredictLT10_M2.2$Date, PredictLT10_M2.2$LT10, lty = 1, lwd=1, col = PredictLT10_M2.2$Colour)
    
    
plot(M2$Date, M2$LT50,
         main= "LT50 Model Validation: Martens 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_M2.1$Date, rev(PredictLT50_M2.1$Date)), c(PredictLT50_M2.1$LT50.CILower, rev(PredictLT50_M2.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M2.2$Date, rev(PredictLT50_M2.2$Date)), c(PredictLT50_M2.2$LT50.CILower, rev(PredictLT50_M2.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M2.1$Date, PredictLT50_M2.1$LT50, lty = 1, lwd=1, col = PredictLT50_M2.1$Colour)
    lines(PredictLT50_M2.2$Date, PredictLT50_M2.2$LT50, lty = 1, lwd=1, col = PredictLT50_M2.2$Colour)
    
    
plot(M2$Date, M2$LT90,
         main= "LT90 Model Validation: Martens 2020-2021",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2020-09-01", "2021-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_M2.1$Date, rev(PredictLT90_M2.1$Date)), c(PredictLT90_M2.1$LT90.CILower, rev(PredictLT90_M2.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_M2.2$Date, rev(PredictLT90_M2.2$Date)), c(PredictLT90_M2.2$LT90.CILower, rev(PredictLT90_M2.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_M2.1$Date, PredictLT90_M2.1$LT90, lty = 1, lwd=1, col = PredictLT90_M2.1$Colour)
    lines(PredictLT90_M2.2$Date, PredictLT90_M2.2$LT90, lty = 1, lwd=1, col = PredictLT90_M2.2$Colour)
    
# Season 3
    
plot(M3$Date, M3$LT10,
         main= "LT10 Model Validation: Martens 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_M3.1$Date, rev(PredictLT10_M3.1$Date)), c(PredictLT10_M3.1$LT10.CILower, rev(PredictLT10_M3.1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT10_M3.2$Date, rev(PredictLT10_M3.2$Date)), c(PredictLT10_M3.2$LT10.CILower, rev(PredictLT10_M3.2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_M3.1$Date, PredictLT10_M3.1$LT10, lty = 1, lwd=1, col = PredictLT10_M3.1$Colour)
    lines(PredictLT10_M3.2$Date, PredictLT10_M3.2$LT10, lty = 1, lwd=1, col = PredictLT10_M3.2$Colour)
    
    
plot(M3$Date, M3$LT50,
         main= "LT50 Model Validation: Martens 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_M3.1$Date, rev(PredictLT50_M3.1$Date)), c(PredictLT50_M3.1$LT50.CILower, rev(PredictLT50_M3.1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT50_M3.2$Date, rev(PredictLT50_M3.2$Date)), c(PredictLT50_M3.2$LT50.CILower, rev(PredictLT50_M3.2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_M3.1$Date, PredictLT50_M3.1$LT50, lty = 1, lwd=1, col = PredictLT50_M3.1$Colour)
    lines(PredictLT50_M3.2$Date, PredictLT50_M3.2$LT50, lty = 1, lwd=1, col = PredictLT50_M3.2$Colour)
    
    
plot(M3$Date, M3$LT90,
         main= "LT90 Model Validation: Martens 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-04-25")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_M3.1$Date, rev(PredictLT90_M3.1$Date)), c(PredictLT90_M3.1$LT90.CILower, rev(PredictLT90_M3.1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    polygon(c(PredictLT90_M3.2$Date, rev(PredictLT90_M3.2$Date)), c(PredictLT90_M3.2$LT90.CILower, rev(PredictLT90_M3.2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_M3.1$Date, PredictLT90_M3.1$LT90, lty = 1, lwd=1, col = PredictLT90_M3.1$Colour)
    lines(PredictLT90_M3.2$Date, PredictLT90_M3.2$LT90, lty = 1, lwd=1, col = PredictLT90_M3.2$Colour)
```
* * *

## Make Predictions: Staccato
```{r}
Stac1 <- subset(Staccato, Sweetheart_cherry_forcingBB_final < 25)
Stac2 <- subset(Staccato, Sweetheart_cherry_forcingBB_final >= 25)

## Staccato
# Staccato LT10 Season 1 Model 1
PredictLT10_Stac1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Stac1, se= TRUE))
    PredictLT10_Stac1$LT10.CIUpper <- (PredictLT10_Stac1$fit + PredictLT10_Stac1$se.fit*1.96)
    PredictLT10_Stac1$LT10.CILower <- (PredictLT10_Stac1$fit - PredictLT10_Stac1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Stac1$Date <- Stac1$Date
    # rename fit to LT50
    PredictLT10_Stac1 <- PredictLT10_Stac1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Stac1 <- PredictLT10_Stac1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Stac1$Colour = "black"
    
# Staccato LT10 Season 1 Model 2
# PredictLT10_Stac2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Stac2, se= TRUE))
#     PredictLT10_Stac2$LT10.CIUpper <- (PredictLT10_Stac2$fit + PredictLT10_Stac2$se.fit*1.96)
#     PredictLT10_Stac2$LT10.CILower <- (PredictLT10_Stac2$fit - PredictLT10_Stac2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Stac2$Date <- Stac2$Date
#     # rename fit to LT50
#     PredictLT10_Stac2 <- PredictLT10_Stac2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Stac2 <- PredictLT10_Stac2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Stac2$Colour = "mediumblue"
    
    
PredictLT10_Stac1 <- PredictLT10_Stac1


# Staccato LT50 Season 1 Model 1
PredictLT50_Stac1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Stac1, se= TRUE))
    PredictLT50_Stac1$LT50.CIUpper <- (PredictLT50_Stac1$fit + PredictLT50_Stac1$se.fit*1.96)
    PredictLT50_Stac1$LT50.CILower <- (PredictLT50_Stac1$fit - PredictLT50_Stac1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Stac1$Date <- Stac1$Date
    # rename fit to LT50
    PredictLT50_Stac1 <- PredictLT50_Stac1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Stac1 <- PredictLT50_Stac1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Stac1$Colour = "black"
    
# Staccato LT50 Season 1 Model 2
# PredictLT50_Stac2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Stac2, se= TRUE))
#     PredictLT50_Stac2$LT50.CIUpper <- (PredictLT50_Stac2$fit + PredictLT50_Stac2$se.fit*1.96)
#     PredictLT50_Stac2$LT50.CILower <- (PredictLT50_Stac2$fit - PredictLT50_Stac2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Stac2$Date <- Stac2$Date
#     # rename fit to LT50
#     PredictLT50_Stac2 <- PredictLT50_Stac2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Stac2 <- PredictLT50_Stac2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Stac2$Colour = "mediumblue"
    
PredictLT50_Stac1 <- PredictLT50_Stac1
    
    # Staccato LT90 Season 1 Model 1
PredictLT90_Stac1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Stac1, se= TRUE))
    PredictLT90_Stac1$LT90.CIUpper <- (PredictLT90_Stac1$fit + PredictLT90_Stac1$se.fit*1.96)
    PredictLT90_Stac1$LT90.CILower <- (PredictLT90_Stac1$fit - PredictLT90_Stac1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Stac1$Date <- Stac1$Date
    # rename fit to LT50
    PredictLT90_Stac1 <- PredictLT90_Stac1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Stac1 <- PredictLT90_Stac1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Stac1$Colour = "black"
    
# Staccato LT90 Season 1 Model 2
# PredictLT90_Stac2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Stac2, se= TRUE))
#     PredictLT90_Stac2$LT90.CIUpper <- (PredictLT90_Stac2$fit + PredictLT90_Stac2$se.fit*1.96)
#     PredictLT90_Stac2$LT90.CILower <- (PredictLT90_Stac2$fit - PredictLT90_Stac2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Stac2$Date <- Stac2$Date
#     # rename fit to LT50
#     PredictLT90_Stac2 <- PredictLT90_Stac2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Stac2 <- PredictLT90_Stac2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Stac2$Colour = "mediumblue"
    
    
PredictLT90_Stac1 <- PredictLT90_Stac1



plot(Staccato$Date, Staccato$LT10,
         main= "LT10 Model Validation: Sweetheart Model - Staccato 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Stac1$Date, rev(PredictLT10_Stac1$Date)), c(PredictLT10_Stac1$LT10.CILower, rev(PredictLT10_Stac1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Stac2$Date, rev(PredictLT10_Stac2$Date)), c(PredictLT10_Stac2$LT10.CILower, rev(PredictLT10_Stac2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Stac1$Date, PredictLT10_Stac1$LT10, lty = 1, lwd=1, col = PredictLT10_Stac1$Colour)
    # lines(PredictLT10_Stac2$Date, PredictLT10_Stac2$LT10, lty = 1, lwd=1, col = PredictLT10_Stac2$Colour)
    
    
plot(Staccato$Date, Staccato$LT50,
         main= "LT50 Model Validation: Sweetheart Model - Staccato 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Stac1$Date, rev(PredictLT50_Stac1$Date)), c(PredictLT50_Stac1$LT50.CILower, rev(PredictLT50_Stac1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Stac2$Date, rev(PredictLT50_Stac2$Date)), c(PredictLT50_Stac2$LT50.CILower, rev(PredictLT50_Stac2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Stac1$Date, PredictLT50_Stac1$LT50, lty = 1, lwd=1, col = PredictLT50_Stac1$Colour)
    # lines(PredictLT50_Stac2$Date, PredictLT50_Stac2$LT50, lty = 1, lwd=1, col = PredictLT50_Stac2$Colour)
    
    
plot(Staccato$Date, Staccato$LT90,
         main= "LT90 Model Validation: Sweetheart Model -Staccato 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Stac1$Date, rev(PredictLT90_Stac1$Date)), c(PredictLT90_Stac1$LT90.CILower, rev(PredictLT90_Stac1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Stac2$Date, rev(PredictLT90_Stac2$Date)), c(PredictLT90_Stac2$LT90.CILower, rev(PredictLT90_Stac2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Stac1$Date, PredictLT90_Stac1$LT90, lty = 1, lwd=1, col = PredictLT90_Stac1$Colour)
    # lines(PredictLT90_Stac2$Date, PredictLT90_Stac2$LT90, lty = 1, lwd=1, col = PredictLT90_Stac2$Colour)
```

* * *

## Make Predictions: Sonata
```{r}
Son1 <- subset(Sonata, Sweetheart_cherry_forcingBB_final < 25)
Son2 <- subset(Sonata, Sweetheart_cherry_forcingBB_final >= 25)

## Sonata
# Sonata LT10 Season 1 Model 1
PredictLT10_Son1 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Son1, se= TRUE))
    PredictLT10_Son1$LT10.CIUpper <- (PredictLT10_Son1$fit + PredictLT10_Son1$se.fit*1.96)
    PredictLT10_Son1$LT10.CILower <- (PredictLT10_Son1$fit - PredictLT10_Son1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Son1$Date <- Son1$Date
    # rename fit to LT50
    PredictLT10_Son1 <- PredictLT10_Son1 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Son1 <- PredictLT10_Son1 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Son1$Colour = "black"
    
# Sonata LT10 Season 1 Model 2
# PredictLT10_Son2 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Son2, se= TRUE))
#     PredictLT10_Son2$LT10.CIUpper <- (PredictLT10_Son2$fit + PredictLT10_Son2$se.fit*1.96)
#     PredictLT10_Son2$LT10.CILower <- (PredictLT10_Son2$fit - PredictLT10_Son2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Son2$Date <- Son2$Date
#     # rename fit to LT50
#     PredictLT10_Son2 <- PredictLT10_Son2 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Son2 <- PredictLT10_Son2 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Son2$Colour = "mediumblue"
    
    
PredictLT10_Son1 <- PredictLT10_Son1


# Sonata LT50 Season 1 Model 1
PredictLT50_Son1 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Son1, se= TRUE))
    PredictLT50_Son1$LT50.CIUpper <- (PredictLT50_Son1$fit + PredictLT50_Son1$se.fit*1.96)
    PredictLT50_Son1$LT50.CILower <- (PredictLT50_Son1$fit - PredictLT50_Son1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Son1$Date <- Son1$Date
    # rename fit to LT50
    PredictLT50_Son1 <- PredictLT50_Son1 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Son1 <- PredictLT50_Son1 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Son1$Colour = "black"
    
# Sonata LT50 Season 1 Model 2
# PredictLT50_Son2 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Son2, se= TRUE))
#     PredictLT50_Son2$LT50.CIUpper <- (PredictLT50_Son2$fit + PredictLT50_Son2$se.fit*1.96)
#     PredictLT50_Son2$LT50.CILower <- (PredictLT50_Son2$fit - PredictLT50_Son2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Son2$Date <- Son2$Date
#     # rename fit to LT50
#     PredictLT50_Son2 <- PredictLT50_Son2 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Son2 <- PredictLT50_Son2 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Son2$Colour = "mediumblue"
    
PredictLT50_Son1 <- PredictLT50_Son1
    
    # Sonata LT90 Season 1 Model 1
PredictLT90_Son1 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Son1, se= TRUE))
    PredictLT90_Son1$LT90.CIUpper <- (PredictLT90_Son1$fit + PredictLT90_Son1$se.fit*1.96)
    PredictLT90_Son1$LT90.CILower <- (PredictLT90_Son1$fit - PredictLT90_Son1$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Son1$Date <- Son1$Date
    # rename fit to LT50
    PredictLT90_Son1 <- PredictLT90_Son1 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Son1 <- PredictLT90_Son1 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Son1$Colour = "black"
    
# Sonata LT90 Season 1 Model 2
# PredictLT90_Son2 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Son2, se= TRUE))
#     PredictLT90_Son2$LT90.CIUpper <- (PredictLT90_Son2$fit + PredictLT90_Son2$se.fit*1.96)
#     PredictLT90_Son2$LT90.CILower <- (PredictLT90_Son2$fit - PredictLT90_Son2$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Son2$Date <- Son2$Date
#     # rename fit to LT50
#     PredictLT90_Son2 <- PredictLT90_Son2 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Son2 <- PredictLT90_Son2 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Son2$Colour = "mediumblue"
    
    
PredictLT90_Son1 <- PredictLT90_Son1



plot(Sonata$Date, Sonata$LT10,
         main= "LT10 Model Validation: Sweetheart Model - Sonata 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Son1$Date, rev(PredictLT10_Son1$Date)), c(PredictLT10_Son1$LT10.CILower, rev(PredictLT10_Son1$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Son2$Date, rev(PredictLT10_Son2$Date)), c(PredictLT10_Son2$LT10.CILower, rev(PredictLT10_Son2$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Son1$Date, PredictLT10_Son1$LT10, lty = 1, lwd=1, col = PredictLT10_Son1$Colour)
    # lines(PredictLT10_Son2$Date, PredictLT10_Son2$LT10, lty = 1, lwd=1, col = PredictLT10_Son2$Colour)
    
    
plot(Sonata$Date, Sonata$LT50,
         main= "LT50 Model Validation: Sweetheart Model - Sonata 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Son1$Date, rev(PredictLT50_Son1$Date)), c(PredictLT50_Son1$LT50.CILower, rev(PredictLT50_Son1$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Son2$Date, rev(PredictLT50_Son2$Date)), c(PredictLT50_Son2$LT50.CILower, rev(PredictLT50_Son2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Son1$Date, PredictLT50_Son1$LT50, lty = 1, lwd=1, col = PredictLT50_Son1$Colour)
    # lines(PredictLT50_Son2$Date, PredictLT50_Son2$LT50, lty = 1, lwd=1, col = PredictLT50_Son2$Colour)
    
    
plot(Sonata$Date, Sonata$LT90,
         main= "LT90 Model Validation: Sweetheart Model - Sonata 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Son1$Date, rev(PredictLT90_Son1$Date)), c(PredictLT90_Son1$LT90.CILower, rev(PredictLT90_Son1$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Son2$Date, rev(PredictLT90_Son2$Date)), c(PredictLT90_Son2$LT90.CILower, rev(PredictLT90_Son2$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Son1$Date, PredictLT90_Son1$LT90, lty = 1, lwd=1, col = PredictLT90_Son1$Colour)
    # lines(PredictLT90_Son2$Date, PredictLT90_Son2$LT90, lty = 1, lwd=1, col = PredictLT90_Son2$Colour)

```


* * *

## Make Predictions: Skeena1Gi3
```{r}
Ske1Gi31 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final < 25)
Ske1Gi32 <- subset(Skeena1.Gi3, Sweetheart_cherry_forcingBB_final >= 25)

## Skeena1Gi3
# Skeena1Gi3 LT10 Season 1 Model 1
PredictLT10_Ske1Gi31 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske1Gi31, se= TRUE))
    PredictLT10_Ske1Gi31$LT10.CIUpper <- (PredictLT10_Ske1Gi31$fit + PredictLT10_Ske1Gi31$se.fit*1.96)
    PredictLT10_Ske1Gi31$LT10.CILower <- (PredictLT10_Ske1Gi31$fit - PredictLT10_Ske1Gi31$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske1Gi31$Date <- Ske1Gi31$Date
    # rename fit to LT50
    PredictLT10_Ske1Gi31 <- PredictLT10_Ske1Gi31 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske1Gi31 <- PredictLT10_Ske1Gi31 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske1Gi31$Colour = "black"
    
# Skeena1Gi3 LT10 Season 1 Model 2
# PredictLT10_Ske1Gi32 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske1Gi32, se= TRUE))
#     PredictLT10_Ske1Gi32$LT10.CIUpper <- (PredictLT10_Ske1Gi32$fit + PredictLT10_Ske1Gi32$se.fit*1.96)
#     PredictLT10_Ske1Gi32$LT10.CILower <- (PredictLT10_Ske1Gi32$fit - PredictLT10_Ske1Gi32$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske1Gi32$Date <- Ske1Gi32$Date
#     # rename fit to LT50
#     PredictLT10_Ske1Gi32 <- PredictLT10_Ske1Gi32 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske1Gi32 <- PredictLT10_Ske1Gi32 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske1Gi32$Colour = "mediumblue"
    
    
PredictLT10_Ske1Gi31 <- PredictLT10_Ske1Gi31


# Skeena1Gi3 LT50 Season 1 Model 1
PredictLT50_Ske1Gi31 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske1Gi31, se= TRUE))
    PredictLT50_Ske1Gi31$LT50.CIUpper <- (PredictLT50_Ske1Gi31$fit + PredictLT50_Ske1Gi31$se.fit*1.96)
    PredictLT50_Ske1Gi31$LT50.CILower <- (PredictLT50_Ske1Gi31$fit - PredictLT50_Ske1Gi31$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske1Gi31$Date <- Ske1Gi31$Date
    # rename fit to LT50
    PredictLT50_Ske1Gi31 <- PredictLT50_Ske1Gi31 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske1Gi31 <- PredictLT50_Ske1Gi31 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske1Gi31$Colour = "black"
    
# Skeena1Gi3 LT50 Season 1 Model 2
# PredictLT50_Ske1Gi32 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske1Gi32, se= TRUE))
#     PredictLT50_Ske1Gi32$LT50.CIUpper <- (PredictLT50_Ske1Gi32$fit + PredictLT50_Ske1Gi32$se.fit*1.96)
#     PredictLT50_Ske1Gi32$LT50.CILower <- (PredictLT50_Ske1Gi32$fit - PredictLT50_Ske1Gi32$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske1Gi32$Date <- Ske1Gi32$Date
#     # rename fit to LT50
#     PredictLT50_Ske1Gi32 <- PredictLT50_Ske1Gi32 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske1Gi32 <- PredictLT50_Ske1Gi32 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske1Gi32$Colour = "mediumblue"
    
PredictLT50_Ske1Gi31 <- PredictLT50_Ske1Gi31
    
    # Skeena1Gi3 LT90 Season 1 Model 1
PredictLT90_Ske1Gi31 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske1Gi31, se= TRUE))
    PredictLT90_Ske1Gi31$LT90.CIUpper <- (PredictLT90_Ske1Gi31$fit + PredictLT90_Ske1Gi31$se.fit*1.96)
    PredictLT90_Ske1Gi31$LT90.CILower <- (PredictLT90_Ske1Gi31$fit - PredictLT90_Ske1Gi31$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske1Gi31$Date <- Ske1Gi31$Date
    # rename fit to LT50
    PredictLT90_Ske1Gi31 <- PredictLT90_Ske1Gi31 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske1Gi31 <- PredictLT90_Ske1Gi31 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske1Gi31$Colour = "black"
    
# Skeena1Gi3 LT90 Season 1 Model 2
# PredictLT90_Ske1Gi32 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske1Gi32, se= TRUE))
#     PredictLT90_Ske1Gi32$LT90.CIUpper <- (PredictLT90_Ske1Gi32$fit + PredictLT90_Ske1Gi32$se.fit*1.96)
#     PredictLT90_Ske1Gi32$LT90.CILower <- (PredictLT90_Ske1Gi32$fit - PredictLT90_Ske1Gi32$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske1Gi32$Date <- Ske1Gi32$Date
#     # rename fit to LT50
#     PredictLT90_Ske1Gi32 <- PredictLT90_Ske1Gi32 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske1Gi32 <- PredictLT90_Ske1Gi32 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske1Gi32$Colour = "mediumblue"
    
    
PredictLT90_Ske1Gi31 <- PredictLT90_Ske1Gi31



plot(Skeena1.Gi3$Date, Skeena1.Gi3$LT10,
         main= "LT10 Model Validation: Sweetheart Model - Skeena1Gi3 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske1Gi31$Date, rev(PredictLT10_Ske1Gi31$Date)), c(PredictLT10_Ske1Gi31$LT10.CILower, rev(PredictLT10_Ske1Gi31$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske1Gi32$Date, rev(PredictLT10_Ske1Gi32$Date)), c(PredictLT10_Ske1Gi32$LT10.CILower, rev(PredictLT10_Ske1Gi32$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske1Gi31$Date, PredictLT10_Ske1Gi31$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi31$Colour)
    # lines(PredictLT10_Ske1Gi32$Date, PredictLT10_Ske1Gi32$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi32$Colour)
    
    
plot(Skeena1.Gi3$Date, Skeena1.Gi3$LT50,
         main= "LT50 Model Validation: Sweetheart Model - Skeena1Gi3 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske1Gi31$Date, rev(PredictLT50_Ske1Gi31$Date)), c(PredictLT50_Ske1Gi31$LT50.CILower, rev(PredictLT50_Ske1Gi31$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi32$Date, rev(PredictLT50_Ske1Gi32$Date)), c(PredictLT50_Ske1Gi32$LT50.CILower, rev(PredictLT50_Ske1Gi32$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi31$Date, PredictLT50_Ske1Gi31$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi31$Colour)
    # lines(PredictLT50_Ske1Gi32$Date, PredictLT50_Ske1Gi32$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi32$Colour)
    
    
plot(Skeena1.Gi3$Date, Skeena1.Gi3$LT90,
         main= "LT90 Model Validation: Sweetheart Model -Skeena1Gi3 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske1Gi31$Date, rev(PredictLT90_Ske1Gi31$Date)), c(PredictLT90_Ske1Gi31$LT90.CILower, rev(PredictLT90_Ske1Gi31$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske1Gi32$Date, rev(PredictLT90_Ske1Gi32$Date)), c(PredictLT90_Ske1Gi32$LT90.CILower, rev(PredictLT90_Ske1Gi32$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske1Gi31$Date, PredictLT90_Ske1Gi31$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi31$Colour)
    # lines(PredictLT90_Ske1Gi32$Date, PredictLT90_Ske1Gi32$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi32$Colour)
```

* * *

## Make Predictions: Skeena1Gi5
```{r}
Ske1Gi51 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final < 25)
Ske1Gi52 <- subset(Skeena1.Gi5, Sweetheart_cherry_forcingBB_final >= 25)

## Skeena1Gi5
# Skeena1Gi5 LT10 Season 1 Model 1
PredictLT10_Ske1Gi51 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske1Gi51, se= TRUE))
    PredictLT10_Ske1Gi51$LT10.CIUpper <- (PredictLT10_Ske1Gi51$fit + PredictLT10_Ske1Gi51$se.fit*1.96)
    PredictLT10_Ske1Gi51$LT10.CILower <- (PredictLT10_Ske1Gi51$fit - PredictLT10_Ske1Gi51$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske1Gi51$Date <- Ske1Gi51$Date
    # rename fit to LT50
    PredictLT10_Ske1Gi51 <- PredictLT10_Ske1Gi51 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske1Gi51 <- PredictLT10_Ske1Gi51 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske1Gi51$Colour = "black"
    
# Skeena1Gi5 LT10 Season 1 Model 2
# PredictLT10_Ske1Gi52 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske1Gi52, se= TRUE))
#     PredictLT10_Ske1Gi52$LT10.CIUpper <- (PredictLT10_Ske1Gi52$fit + PredictLT10_Ske1Gi52$se.fit*1.96)
#     PredictLT10_Ske1Gi52$LT10.CILower <- (PredictLT10_Ske1Gi52$fit - PredictLT10_Ske1Gi52$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske1Gi52$Date <- Ske1Gi52$Date
#     # rename fit to LT50
#     PredictLT10_Ske1Gi52 <- PredictLT10_Ske1Gi52 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske1Gi52 <- PredictLT10_Ske1Gi52 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske1Gi52$Colour = "mediumblue"
    
    
PredictLT10_Ske1Gi51 <- PredictLT10_Ske1Gi51


# Skeena1Gi5 LT50 Season 1 Model 1
PredictLT50_Ske1Gi51 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske1Gi51, se= TRUE))
    PredictLT50_Ske1Gi51$LT50.CIUpper <- (PredictLT50_Ske1Gi51$fit + PredictLT50_Ske1Gi51$se.fit*1.96)
    PredictLT50_Ske1Gi51$LT50.CILower <- (PredictLT50_Ske1Gi51$fit - PredictLT50_Ske1Gi51$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske1Gi51$Date <- Ske1Gi51$Date
    # rename fit to LT50
    PredictLT50_Ske1Gi51 <- PredictLT50_Ske1Gi51 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske1Gi51 <- PredictLT50_Ske1Gi51 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske1Gi51$Colour = "black"
    
# Skeena1Gi5 LT50 Season 1 Model 2
# PredictLT50_Ske1Gi52 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske1Gi52, se= TRUE))
#     PredictLT50_Ske1Gi52$LT50.CIUpper <- (PredictLT50_Ske1Gi52$fit + PredictLT50_Ske1Gi52$se.fit*1.96)
#     PredictLT50_Ske1Gi52$LT50.CILower <- (PredictLT50_Ske1Gi52$fit - PredictLT50_Ske1Gi52$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske1Gi52$Date <- Ske1Gi52$Date
#     # rename fit to LT50
#     PredictLT50_Ske1Gi52 <- PredictLT50_Ske1Gi52 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske1Gi52 <- PredictLT50_Ske1Gi52 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske1Gi52$Colour = "mediumblue"
    
PredictLT50_Ske1Gi51 <- PredictLT50_Ske1Gi51
    
    # Skeena1Gi5 LT90 Season 1 Model 1
PredictLT90_Ske1Gi51 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske1Gi51, se= TRUE))
    PredictLT90_Ske1Gi51$LT90.CIUpper <- (PredictLT90_Ske1Gi51$fit + PredictLT90_Ske1Gi51$se.fit*1.96)
    PredictLT90_Ske1Gi51$LT90.CILower <- (PredictLT90_Ske1Gi51$fit - PredictLT90_Ske1Gi51$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske1Gi51$Date <- Ske1Gi51$Date
    # rename fit to LT50
    PredictLT90_Ske1Gi51 <- PredictLT90_Ske1Gi51 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske1Gi51 <- PredictLT90_Ske1Gi51 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske1Gi51$Colour = "black"
    
# Skeena1Gi5 LT90 Season 1 Model 2
# PredictLT90_Ske1Gi52 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske1Gi52, se= TRUE))
#     PredictLT90_Ske1Gi52$LT90.CIUpper <- (PredictLT90_Ske1Gi52$fit + PredictLT90_Ske1Gi52$se.fit*1.96)
#     PredictLT90_Ske1Gi52$LT90.CILower <- (PredictLT90_Ske1Gi52$fit - PredictLT90_Ske1Gi52$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske1Gi52$Date <- Ske1Gi52$Date
#     # rename fit to LT50
#     PredictLT90_Ske1Gi52 <- PredictLT90_Ske1Gi52 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske1Gi52 <- PredictLT90_Ske1Gi52 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske1Gi52$Colour = "mediumblue"
    
    
PredictLT90_Ske1Gi51 <- PredictLT90_Ske1Gi51



plot(Skeena1.Gi5$Date, Skeena1.Gi5$LT10,
         main= "LT10 Model Validation: Sweetheart Model - Skeena1Gi5 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske1Gi51$Date, rev(PredictLT10_Ske1Gi51$Date)), c(PredictLT10_Ske1Gi51$LT10.CILower, rev(PredictLT10_Ske1Gi51$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske1Gi52$Date, rev(PredictLT10_Ske1Gi52$Date)), c(PredictLT10_Ske1Gi52$LT10.CILower, rev(PredictLT10_Ske1Gi52$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske1Gi51$Date, PredictLT10_Ske1Gi51$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi51$Colour)
    # lines(PredictLT10_Ske1Gi52$Date, PredictLT10_Ske1Gi52$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi52$Colour)
    
    
plot(Skeena1.Gi5$Date, Skeena1.Gi5$LT50,
         main= "LT50 Model Validation: Sweetheart Model - Skeena1Gi5 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske1Gi51$Date, rev(PredictLT50_Ske1Gi51$Date)), c(PredictLT50_Ske1Gi51$LT50.CILower, rev(PredictLT50_Ske1Gi51$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi52$Date, rev(PredictLT50_Ske1Gi52$Date)), c(PredictLT50_Ske1Gi52$LT50.CILower, rev(PredictLT50_Ske1Gi52$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi51$Date, PredictLT50_Ske1Gi51$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi51$Colour)
    # lines(PredictLT50_Ske1Gi52$Date, PredictLT50_Ske1Gi52$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi52$Colour)
    
    
plot(Skeena1.Gi5$Date, Skeena1.Gi5$LT90,
         main= "LT90 Model Validation: Sweetheart Model -Skeena1Gi5 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske1Gi51$Date, rev(PredictLT90_Ske1Gi51$Date)), c(PredictLT90_Ske1Gi51$LT90.CILower, rev(PredictLT90_Ske1Gi51$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske1Gi52$Date, rev(PredictLT90_Ske1Gi52$Date)), c(PredictLT90_Ske1Gi52$LT90.CILower, rev(PredictLT90_Ske1Gi52$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske1Gi51$Date, PredictLT90_Ske1Gi51$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi51$Colour)
    # lines(PredictLT90_Ske1Gi52$Date, PredictLT90_Ske1Gi52$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi52$Colour)
```

* * *

## Make Predictions: Skeena1Gi6
```{r}
Ske1Gi61 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final < 25)
Ske1Gi62 <- subset(Skeena1.Gi6, Sweetheart_cherry_forcingBB_final >= 25)

## Skeena1Gi6
# Skeena1Gi6 LT10 Season 1 Model 1
PredictLT10_Ske1Gi61 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske1Gi61, se= TRUE))
    PredictLT10_Ske1Gi61$LT10.CIUpper <- (PredictLT10_Ske1Gi61$fit + PredictLT10_Ske1Gi61$se.fit*1.96)
    PredictLT10_Ske1Gi61$LT10.CILower <- (PredictLT10_Ske1Gi61$fit - PredictLT10_Ske1Gi61$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske1Gi61$Date <- Ske1Gi61$Date
    # rename fit to LT50
    PredictLT10_Ske1Gi61 <- PredictLT10_Ske1Gi61 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske1Gi61 <- PredictLT10_Ske1Gi61 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske1Gi61$Colour = "black"
    
# Skeena1Gi6 LT10 Season 1 Model 2
# PredictLT10_Ske1Gi62 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske1Gi62, se= TRUE))
#     PredictLT10_Ske1Gi62$LT10.CIUpper <- (PredictLT10_Ske1Gi62$fit + PredictLT10_Ske1Gi62$se.fit*1.96)
#     PredictLT10_Ske1Gi62$LT10.CILower <- (PredictLT10_Ske1Gi62$fit - PredictLT10_Ske1Gi62$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske1Gi62$Date <- Ske1Gi62$Date
#     # rename fit to LT50
#     PredictLT10_Ske1Gi62 <- PredictLT10_Ske1Gi62 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske1Gi62 <- PredictLT10_Ske1Gi62 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske1Gi62$Colour = "mediumblue"
    
    
PredictLT10_Ske1Gi61 <- PredictLT10_Ske1Gi61


# Skeena1Gi6 LT50 Season 1 Model 1
PredictLT50_Ske1Gi61 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske1Gi61, se= TRUE))
    PredictLT50_Ske1Gi61$LT50.CIUpper <- (PredictLT50_Ske1Gi61$fit + PredictLT50_Ske1Gi61$se.fit*1.96)
    PredictLT50_Ske1Gi61$LT50.CILower <- (PredictLT50_Ske1Gi61$fit - PredictLT50_Ske1Gi61$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske1Gi61$Date <- Ske1Gi61$Date
    # rename fit to LT50
    PredictLT50_Ske1Gi61 <- PredictLT50_Ske1Gi61 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske1Gi61 <- PredictLT50_Ske1Gi61 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske1Gi61$Colour = "black"
    
# Skeena1Gi6 LT50 Season 1 Model 2
# PredictLT50_Ske1Gi62 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske1Gi62, se= TRUE))
#     PredictLT50_Ske1Gi62$LT50.CIUpper <- (PredictLT50_Ske1Gi62$fit + PredictLT50_Ske1Gi62$se.fit*1.96)
#     PredictLT50_Ske1Gi62$LT50.CILower <- (PredictLT50_Ske1Gi62$fit - PredictLT50_Ske1Gi62$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske1Gi62$Date <- Ske1Gi62$Date
#     # rename fit to LT50
#     PredictLT50_Ske1Gi62 <- PredictLT50_Ske1Gi62 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske1Gi62 <- PredictLT50_Ske1Gi62 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske1Gi62$Colour = "mediumblue"
    
PredictLT50_Ske1Gi61 <- PredictLT50_Ske1Gi61
    
    # Skeena1Gi6 LT90 Season 1 Model 1
PredictLT90_Ske1Gi61 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske1Gi61, se= TRUE))
    PredictLT90_Ske1Gi61$LT90.CIUpper <- (PredictLT90_Ske1Gi61$fit + PredictLT90_Ske1Gi61$se.fit*1.96)
    PredictLT90_Ske1Gi61$LT90.CILower <- (PredictLT90_Ske1Gi61$fit - PredictLT90_Ske1Gi61$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske1Gi61$Date <- Ske1Gi61$Date
    # rename fit to LT50
    PredictLT90_Ske1Gi61 <- PredictLT90_Ske1Gi61 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske1Gi61 <- PredictLT90_Ske1Gi61 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske1Gi61$Colour = "black"
    
# Skeena1Gi6 LT90 Season 1 Model 2
# PredictLT90_Ske1Gi62 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske1Gi62, se= TRUE))
#     PredictLT90_Ske1Gi62$LT90.CIUpper <- (PredictLT90_Ske1Gi62$fit + PredictLT90_Ske1Gi62$se.fit*1.96)
#     PredictLT90_Ske1Gi62$LT90.CILower <- (PredictLT90_Ske1Gi62$fit - PredictLT90_Ske1Gi62$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske1Gi62$Date <- Ske1Gi62$Date
#     # rename fit to LT50
#     PredictLT90_Ske1Gi62 <- PredictLT90_Ske1Gi62 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske1Gi62 <- PredictLT90_Ske1Gi62 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske1Gi62$Colour = "mediumblue"
    
    
PredictLT90_Ske1Gi61 <- PredictLT90_Ske1Gi61



plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT10,
         main= "LT10 Model Validation: Sweetheart Model - Skeena1Gi6 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske1Gi61$Date, rev(PredictLT10_Ske1Gi61$Date)), c(PredictLT10_Ske1Gi61$LT10.CILower, rev(PredictLT10_Ske1Gi61$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske1Gi62$Date, rev(PredictLT10_Ske1Gi62$Date)), c(PredictLT10_Ske1Gi62$LT10.CILower, rev(PredictLT10_Ske1Gi62$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske1Gi61$Date, PredictLT10_Ske1Gi61$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi61$Colour)
    # lines(PredictLT10_Ske1Gi62$Date, PredictLT10_Ske1Gi62$LT10, lty = 1, lwd=1, col = PredictLT10_Ske1Gi62$Colour)
    
    
plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT50,
         main= "LT50 Model Validation: Sweetheart Model - Skeena1Gi6 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske1Gi61$Date, rev(PredictLT50_Ske1Gi61$Date)), c(PredictLT50_Ske1Gi61$LT50.CILower, rev(PredictLT50_Ske1Gi61$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi62$Date, rev(PredictLT50_Ske1Gi62$Date)), c(PredictLT50_Ske1Gi62$LT50.CILower, rev(PredictLT50_Ske1Gi62$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi61$Date, PredictLT50_Ske1Gi61$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi61$Colour)
    # lines(PredictLT50_Ske1Gi62$Date, PredictLT50_Ske1Gi62$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi62$Colour)
    
    
plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT90,
         main= "LT90 Model Validation: Sweetheart Model -Skeena1Gi6 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske1Gi61$Date, rev(PredictLT90_Ske1Gi61$Date)), c(PredictLT90_Ske1Gi61$LT90.CILower, rev(PredictLT90_Ske1Gi61$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske1Gi62$Date, rev(PredictLT90_Ske1Gi62$Date)), c(PredictLT90_Ske1Gi62$LT90.CILower, rev(PredictLT90_Ske1Gi62$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske1Gi61$Date, PredictLT90_Ske1Gi61$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi61$Colour)
    # lines(PredictLT90_Ske1Gi62$Date, PredictLT90_Ske1Gi62$LT90, lty = 1, lwd=1, col = PredictLT90_Ske1Gi62$Colour)
```

* * *

## Make Predictions: Skeena2
```{r}
Ske21 <- subset(Skeena, Sweetheart_cherry_forcingBB_final < 25)
Ske22 <- subset(Skeena, Sweetheart_cherry_forcingBB_final >= 25)

## Skeena
# Skeena LT10 Season 1 Model 1
PredictLT10_Ske21 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m, newdata = Ske21, se= TRUE))
    PredictLT10_Ske21$LT10.CIUpper <- (PredictLT10_Ske21$fit + PredictLT10_Ske21$se.fit*1.96)
    PredictLT10_Ske21$LT10.CILower <- (PredictLT10_Ske21$fit - PredictLT10_Ske21$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT10_Ske21$Date <- Ske21$Date
    # rename fit to LT50
    PredictLT10_Ske21 <- PredictLT10_Ske21 %>% 
      dplyr::rename(LT10 = "fit")
# rename se.fit to LT10_standard_error
    PredictLT10_Ske21 <- PredictLT10_Ske21 %>% 
      dplyr::rename(LT10_standard_error = "se.fit")
    PredictLT10_Ske21$Colour = "black"
    
# Skeena LT10 Season 1 Model 2
# PredictLT10_Ske22 <- as.data.frame(AICcmodavg::predictSE.gls(Model10.m2, newdata = Ske22, se= TRUE))
#     PredictLT10_Ske22$LT10.CIUpper <- (PredictLT10_Ske22$fit + PredictLT10_Ske22$se.fit*1.96)
#     PredictLT10_Ske22$LT10.CILower <- (PredictLT10_Ske22$fit - PredictLT10_Ske22$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT10_Ske22$Date <- Ske22$Date
#     # rename fit to LT50
#     PredictLT10_Ske22 <- PredictLT10_Ske22 %>% 
#       dplyr::rename(LT10 = "fit")
#     # rename se.fit to LT10_standard_error
#     PredictLT10_Ske22 <- PredictLT10_Ske22 %>% 
#       dplyr::rename(LT10_standard_error = "se.fit")
#     PredictLT10_Ske22$Colour = "mediumblue"
    
    
PredictLT10_Ske21 <- PredictLT10_Ske21


# Skeena LT50 Season 1 Model 1
PredictLT50_Ske21 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m, newdata = Ske21, se= TRUE))
    PredictLT50_Ske21$LT50.CIUpper <- (PredictLT50_Ske21$fit + PredictLT50_Ske21$se.fit*1.96)
    PredictLT50_Ske21$LT50.CILower <- (PredictLT50_Ske21$fit - PredictLT50_Ske21$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT50_Ske21$Date <- Ske21$Date
    # rename fit to LT50
    PredictLT50_Ske21 <- PredictLT50_Ske21 %>% 
      dplyr::rename(LT50 = "fit")
# rename se.fit to LT50_standard_error
    PredictLT50_Ske21 <- PredictLT50_Ske21 %>% 
      dplyr::rename(LT50_standard_error = "se.fit")
    PredictLT50_Ske21$Colour = "black"
    
# Skeena LT50 Season 1 Model 2
# PredictLT50_Ske22 <- as.data.frame(AICcmodavg::predictSE.gls(Model50.m2, newdata = Ske22, se= TRUE))
#     PredictLT50_Ske22$LT50.CIUpper <- (PredictLT50_Ske22$fit + PredictLT50_Ske22$se.fit*1.96)
#     PredictLT50_Ske22$LT50.CILower <- (PredictLT50_Ske22$fit - PredictLT50_Ske22$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT50_Ske22$Date <- Ske22$Date
#     # rename fit to LT50
#     PredictLT50_Ske22 <- PredictLT50_Ske22 %>% 
#       dplyr::rename(LT50 = "fit")
#     # rename se.fit to LT50_standard_error
#     PredictLT50_Ske22 <- PredictLT50_Ske22 %>% 
#       dplyr::rename(LT50_standard_error = "se.fit")
#     PredictLT50_Ske22$Colour = "mediumblue"
    
PredictLT50_Ske21 <- PredictLT50_Ske21
    
    # Skeena LT90 Season 1 Model 1
PredictLT90_Ske21 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m, newdata = Ske21, se= TRUE))
    PredictLT90_Ske21$LT90.CIUpper <- (PredictLT90_Ske21$fit + PredictLT90_Ske21$se.fit*1.96)
    PredictLT90_Ske21$LT90.CILower <- (PredictLT90_Ske21$fit - PredictLT90_Ske21$se.fit*1.96)
    # add the YYYYMMDD column from Calculated_CU_FU50
    PredictLT90_Ske21$Date <- Ske21$Date
    # rename fit to LT50
    PredictLT90_Ske21 <- PredictLT90_Ske21 %>% 
      dplyr::rename(LT90 = "fit")
# rename se.fit to LT90_standard_error
    PredictLT90_Ske21 <- PredictLT90_Ske21 %>% 
      dplyr::rename(LT90_standard_error = "se.fit")
    PredictLT90_Ske21$Colour = "black"
    
# Skeena LT90 Season 1 Model 2
# PredictLT90_Ske22 <- as.data.frame(AICcmodavg::predictSE.gls(Model90.m2, newdata = Ske22, se= TRUE))
#     PredictLT90_Ske22$LT90.CIUpper <- (PredictLT90_Ske22$fit + PredictLT90_Ske22$se.fit*1.96)
#     PredictLT90_Ske22$LT90.CILower <- (PredictLT90_Ske22$fit - PredictLT90_Ske22$se.fit*1.96)
#     # add the YYYYMMDD column from Calculated_CU_FU50
#     PredictLT90_Ske22$Date <- Ske22$Date
#     # rename fit to LT50
#     PredictLT90_Ske22 <- PredictLT90_Ske22 %>% 
#       dplyr::rename(LT90 = "fit")
#     # rename se.fit to LT90_standard_error
#     PredictLT90_Ske22 <- PredictLT90_Ske22 %>% 
#       dplyr::rename(LT90_standard_error = "se.fit")
#     PredictLT90_Ske22$Colour = "mediumblue"
    
    
PredictLT90_Ske21 <- PredictLT90_Ske21



plot(Skeena$Date, Skeena$LT10,
         main= "LT10 Model Validation: Sweetheart Model - Skeena 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT10 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT10_Ske21$Date, rev(PredictLT10_Ske21$Date)), c(PredictLT10_Ske21$LT10.CILower, rev(PredictLT10_Ske21$LT10.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT10_Ske22$Date, rev(PredictLT10_Ske22$Date)), c(PredictLT10_Ske22$LT10.CILower, rev(PredictLT10_Ske22$LT10.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT10_Ske21$Date, PredictLT10_Ske21$LT10, lty = 1, lwd=1, col = PredictLT10_Ske21$Colour)
    # lines(PredictLT10_Ske22$Date, PredictLT10_Ske22$LT10, lty = 1, lwd=1, col = PredictLT10_Ske22$Colour)
    
    
plot(Skeena$Date, Skeena$LT50,
         main= "LT50 Model Validation: Sweetheart Model - Skeena 2021-2022",
         pch= 20,
         xlab="", 
         ylab="LT50 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT50_Ske21$Date, rev(PredictLT50_Ske21$Date)), c(PredictLT50_Ske21$LT50.CILower, rev(PredictLT50_Ske21$LT50.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske22$Date, rev(PredictLT50_Ske22$Date)), c(PredictLT50_Ske22$LT50.CILower, rev(PredictLT50_Ske22$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske21$Date, PredictLT50_Ske21$LT50, lty = 1, lwd=1, col = PredictLT50_Ske21$Colour)
    # lines(PredictLT50_Ske22$Date, PredictLT50_Ske22$LT50, lty = 1, lwd=1, col = PredictLT50_Ske22$Colour)
    
    
plot(Skeena$Date, Skeena$LT90,
         main= "LT90 Model Validation: Sweetheart Model -Skeena 2015-2016",
         pch= 20,
         xlab="", 
         ylab="LT90 (˚C)",
         xlim = as.Date(c("2021-09-01", "2022-03-15")),
         ylim = c(-25, 0),
         cex.axis=1,
         cex = 0.75,
         cex.lab=1,
         cex.main=1.75)
    polygon(c(PredictLT90_Ske21$Date, rev(PredictLT90_Ske21$Date)), c(PredictLT90_Ske21$LT90.CILower, rev(PredictLT90_Ske21$LT90.CIUpper)), col=rgb(0, 0, 0,0.15), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT90_Ske22$Date, rev(PredictLT90_Ske22$Date)), c(PredictLT90_Ske22$LT90.CILower, rev(PredictLT90_Ske22$LT90.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT90_Ske21$Date, PredictLT90_Ske21$LT90, lty = 1, lwd=1, col = PredictLT90_Ske21$Colour)
    # lines(PredictLT90_Ske22$Date, PredictLT90_Ske22$LT90, lty = 1, lwd=1, col = PredictLT90_Ske22$Colour)
```

***
# Full Model Validation- OTHER VARIETIES: Publication Figures
Combine models for forcing units <30 and >=30

```{R echo = FALSE}
# need to run above sections for prediction dataframes
par(mfrow=c(1,3))
par(pty="m") # resets par to old conditions
#Staccato
plot(Staccato$Date, Staccato$LT50,
         main= "",
         pch= 20,
         xlab="", 
              ylab= expression("LT50 (" * degree * C *")"),
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_Stac1$Date, rev(PredictLT50_Stac1$Date)), c(PredictLT50_Stac1$LT50.CILower, rev(PredictLT50_Stac1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Stac2$Date, rev(PredictLT50_Stac2$Date)), c(PredictLT50_Stac2$LT50.CILower, rev(PredictLT50_Stac2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Stac1$Date, PredictLT50_Stac1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Stac1$Colour)
    # lines(PredictLT50_Stac2$Date, PredictLT50_Stac2$LT50, lty = 1, lwd=1, col = PredictLT50_Stac2$Colour)
    text(as.Date('2016-02-15'), -24, "2015-2016", cex = 1.65)
    
    
# Sonata
plot(Sonata$Date, Sonata$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab="",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_Son1$Date, rev(PredictLT50_Son1$Date)), c(PredictLT50_Son1$LT50.CILower, rev(PredictLT50_Son1$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Son2$Date, rev(PredictLT50_Son2$Date)), c(PredictLT50_Son2$LT50.CILower, rev(PredictLT50_Son2$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Son1$Date, PredictLT50_Son1$LT50, lty = 1, lwd=1.15, col = PredictLT50_Son1$Colour)
    # lines(PredictLT50_Son2$Date, PredictLT50_Son2$LT50, lty = 1, lwd=1, col = PredictLT50_Son2$Colour)
    text(as.Date('2016-02-15'), -24, "2015-2016", cex = 1.65)

# Skeena Gi6
plot(Skeena1.Gi6$Date, Skeena1.Gi6$LT50,
         main= "",
         pch= 20,
         xlab="", 
         ylab="",
         xlim = as.Date(c("2015-09-01", "2016-03-15")),
     cex.main=1.65,
     cex.axis=1.75,
     cex.lab=1.75, ylim=c(-25, -3))
    polygon(c(PredictLT50_Ske1Gi61$Date, rev(PredictLT50_Ske1Gi61$Date)), c(PredictLT50_Ske1Gi61$LT50.CILower, rev(PredictLT50_Ske1Gi61$LT50.CIUpper)), col=rgb(0, 0, 0,0.20), border= FALSE) # add CI as band of colour not lines
    # polygon(c(PredictLT50_Ske1Gi62$Date, rev(PredictLT50_Ske1Gi62$Date)), c(PredictLT50_Ske1Gi62$LT50.CILower, rev(PredictLT50_Ske1Gi62$LT50.CIUpper)), col=rgb(0, 0, 1, 0.25), border=FALSE) # add CI as band of colour not lines
    lines(PredictLT50_Ske1Gi61$Date, PredictLT50_Ske1Gi61$LT50, lty = 1, lwd=1.15, col = PredictLT50_Ske1Gi61$Colour)
    # lines(PredictLT50_Ske1Gi62$Date, PredictLT50_Ske1Gi62$LT50, lty = 1, lwd=1, col = PredictLT50_Ske1Gi62$Colour)
    text(as.Date('2016-02-15'), -24, "2015-2016", cex = 1.65)

   
# save as 4x15s
```